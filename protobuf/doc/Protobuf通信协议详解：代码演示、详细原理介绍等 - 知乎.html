<!DOCTYPE html>
<!-- saved from url=(0038)https://zhuanlan.zhihu.com/p/141415216 -->
<html lang="zh" data-hairline="true" class="itcauecng" data-theme="light" data-rh="data-theme"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>Protobuf通信协议详解：代码演示、详细原理介绍等 - 知乎</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="renderer" content="webkit"><meta name="force-rendering" content="webkit"><meta http-equiv="X-UA-Compatible" content="IE=10,chrome=1"><meta name="google-site-verification" content="FTeR0c8arOPKh8c5DYh_9uu98_zJbaWw53J-Sch9MTg"><meta data-rh="true" name="keywords" content="通信协议,protobuf,通信"><meta data-rh="true" name="description" content="1、概述1.1前言 在移动互联网时代，手机流量、电量是最为有限的资源，而移动端的即时通讯应用无疑必须得直面这两点。 解决流量过大的基本方法就是使用高度压缩的通信协议，而数据压缩后流量减小带来的自然结果也就…"><meta data-rh="true" property="og:title" content="Protobuf通信协议详解：代码演示、详细原理介绍等"><meta data-rh="true" property="og:url" content="https://zhuanlan.zhihu.com/p/141415216"><meta data-rh="true" property="og:description" content="1、概述1.1前言 在移动互联网时代，手机流量、电量是最为有限的资源，而移动端的即时通讯应用无疑必须得直面这两点。 解决流量过大的基本方法就是使用高度压缩的通信协议，而数据压缩后流量减小带来的自然结果也就…"><meta data-rh="true" property="og:image" content=""><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="og:site_name" content="知乎专栏"><link data-rh="true" rel="apple-touch-icon" href="https://static.zhihu.com/heifetz/assets/apple-touch-icon-152.81060cab.png"><link data-rh="true" rel="apple-touch-icon" href="https://static.zhihu.com/heifetz/assets/apple-touch-icon-152.81060cab.png" sizes="152x152"><link data-rh="true" rel="apple-touch-icon" href="https://static.zhihu.com/heifetz/assets/apple-touch-icon-120.d5793cac.png" sizes="120x120"><link data-rh="true" rel="apple-touch-icon" href="https://static.zhihu.com/heifetz/assets/apple-touch-icon-76.7abf3393.png" sizes="76x76"><link data-rh="true" rel="apple-touch-icon" href="https://static.zhihu.com/heifetz/assets/apple-touch-icon-60.362a8eac.png" sizes="60x60"><link crossorigin="" rel="shortcut icon" type="image/x-icon" href="https://static.zhihu.com/heifetz/favicon.ico"><link crossorigin="" rel="search" type="application/opensearchdescription+xml" href="https://static.zhihu.com/heifetz/search.xml" title="知乎"><link rel="dns-prefetch" href="https://static.zhimg.com/"><link rel="dns-prefetch" href="https://pica.zhimg.com/"><link rel="dns-prefetch" href="https://pic1.zhimg.com/"><link rel="dns-prefetch" href="https://pic2.zhimg.com/"><link rel="dns-prefetch" href="https://pic3.zhimg.com/"><link rel="dns-prefetch" href="https://pic4.zhimg.com/"><link rel="dns-prefetch" href="https://static.zhihu.com/"><script nonce="" data-web-reporter-config="{&quot;platform&quot;:&quot;web&quot;,&quot;project&quot;:&quot;heifetz&quot;}">!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).webReporter={})}(this,function(e){"use strict";var t={},n=!1,o=function(){var e,o,r,a,i;return n||(e=document.querySelector("script[data-web-reporter-config]"),o=e&&e.dataset.webReporterConfig||"{}",r=JSON.parse(o),a=r.platform,i=r.project,t={platform:a,project:i},n=!0),t};function r(e){return a(function(){return localStorage.getItem(e)})()}function a(e){return function(){try{return e.apply(void 0,arguments)}catch(e){}}}var i=a(function(e,t){var n={platform:"web",project:o().project,clientTimestamp:+new Date};!function(e,t,n){"1"===r("weber:logenabled")&&console.log("[web-reporter]%o",{type:e,base:t,data:n})}(e,n,t),function(e,t){var n=btoa(JSON.stringify(t));if("undefined"!=typeof Blob&&window.navigator&&window.navigator.sendBeacon){var o=new Blob([n],{type:"text/plain"});navigator.sendBeacon(e,o)}else{var r=new XMLHttpRequest;r.open("POST",e),r.withCredentials=!1,r.setRequestHeader("Content-Type","text/plain;charset=UTF-8"),r.send(n)}}(r("weber:api")||"https://apm.zhihu.com/collector/web_json",{type:e,base:n,data:t})});e.report=i,Object.defineProperty(e,"__esModule",{value:!0})});
</script><link href="./Protobuf通信协议详解：代码演示、详细原理介绍等 - 知乎_files/5459.216a26f4.ae3f916f2bf048ca377d.css" crossorigin="" rel="stylesheet"><link href="./Protobuf通信协议详解：代码演示、详细原理介绍等 - 知乎_files/column.216a26f4.f32f3564fcccdb253e7d.css" crossorigin="" rel="stylesheet"><link rel="stylesheet" type="text/css" href="./Protobuf通信协议详解：代码演示、详细原理介绍等 - 知乎_files/user-hover-card.216a26f4.7f1de7c441470974ce17.css" crossorigin="anonymous"><link rel="stylesheet" type="text/css" href="./Protobuf通信协议详解：代码演示、详细原理介绍等 - 知乎_files/Labels.216a26f4.81c9ce8725560c5bcc6a.css" crossorigin="anonymous"><link rel="stylesheet" type="text/css" href="./Protobuf通信协议详解：代码演示、详细原理介绍等 - 知乎_files/GoodsRecommendGoodsCardList.216a26f4.d95ce79191cdf8d7ac28.css" crossorigin="anonymous"><link rel="stylesheet" type="text/css" href="./Protobuf通信协议详解：代码演示、详细原理介绍等 - 知乎_files/3757.216a26f4.bf8d6607cd19b4dd1bab.css" crossorigin="anonymous"><link rel="stylesheet" type="text/css" href="./Protobuf通信协议详解：代码演示、详细原理介绍等 - 知乎_files/ECommerceAd.216a26f4.9fa9535cc2efe2b3edb4.css" crossorigin="anonymous"><link rel="stylesheet" type="text/css" href="./Protobuf通信协议详解：代码演示、详细原理介绍等 - 知乎_files/5242.216a26f4.d85c1258a9cf7ea8720a.css" crossorigin="anonymous"><link rel="stylesheet" type="text/css" href="./Protobuf通信协议详解：代码演示、详细原理介绍等 - 知乎_files/EditableV2.216a26f4.86147906b330fd7351a9.css" crossorigin="anonymous"><script nonce="">!function(){"use strict";!function(e,n){var r=[];function t(e){return function(){r.push([e,arguments])}}n.Raven={captureException:t("captureException"),captureMessage:t("captureMessage"),captureBreadcrumb:t("captureBreadcrumb")};var a,o,c,i,s,u="undefined"!=typeof DOMError;function d(e){var n=e instanceof Error||e instanceof ErrorEvent||u&&e instanceof DOMError||e instanceof DOMException;Raven.captureException(n?e:new Error(e.message||e.reason))}n.addEventListener("unhandledrejection",d),n.addEventListener("error",d,!0),a=e.src,o=e,c=function(){r.forEach(function(e){var n;(n=Raven)[e[0]].apply(n,e[1])}),n.removeEventListener("unhandledrejection",d),n.removeEventListener("error",d,!0)},i=document.head||document.getElementsByTagName("head")[0],(s=document.createElement("script")).crossOrigin=o.crossOrigin,s.dataset.sentryConfig=o["data-sentry-config"],s.onload=c,s.src=a,i.appendChild(s)}({"defer":true,"crossOrigin":"anonymous","src":"https://unpkg.zhimg.com/@cfe/sentry-script@1.3.1/dist/init.js","data-sentry-config":"{\"dsn\":\"https://2d8d764432cc4f6fb3bc78ab9528299d@crash2.zhihu.com/1224\",\"sampleRate\":0.1,\"release\":\"721-49f562a5\",\"ignoreErrorNames\":[\"NetworkError\",\"SecurityError\"],\"ignoreErrorsPreset\":\"ReactApp\",\"tags\":{\"app_name\":\"heifetz\"}}"},window)}();
</script><script crossorigin="anonymous" data-sentry-config="{&quot;dsn&quot;:&quot;https://2d8d764432cc4f6fb3bc78ab9528299d@crash2.zhihu.com/1224&quot;,&quot;sampleRate&quot;:0.1,&quot;release&quot;:&quot;721-49f562a5&quot;,&quot;ignoreErrorNames&quot;:[&quot;NetworkError&quot;,&quot;SecurityError&quot;],&quot;ignoreErrorsPreset&quot;:&quot;ReactApp&quot;,&quot;tags&quot;:{&quot;app_name&quot;:&quot;heifetz&quot;}}" src="./Protobuf通信协议详解：代码演示、详细原理介绍等 - 知乎_files/init.js"></script><style data-emotion-css="uzm3ri">.css-uzm3ri{position:fixed;top:0;right:0;left:0;z-index:101;display:none;height:2px;pointer-events:none;background:#056DE8;-webkit-transform:translateX(-100%);-ms-transform:translateX(-100%);transform:translateX(-100%);}</style><style data-emotion-css="1l12z7y">.css-1l12z7y{box-shadow:0px 16px 32px rgba(0,0,0,0.04);}</style><style data-emotion-css="1hlrcxk">.css-1hlrcxk{-webkit-transition-property:fill;transition-property:fill;-webkit-transition-duration:0.25s;transition-duration:0.25s;-webkit-transition-timing-function:ease-in;transition-timing-function:ease-in;}</style><style data-emotion-css="icip60">.css-icip60{border-radius:2px;}</style><style data-emotion-css="1tzrnvf">.css-1tzrnvf{box-sizing:border-box;margin:0;min-width:0;max-width:100%;height:auto;background-color:#FFFFFF;width:30px;height:30px;border-radius:2px;}</style><style data-emotion-css="uodor8">.css-uodor8{border-radius:50%;}</style><style data-emotion-css="1y9jkzv">.css-1y9jkzv{box-sizing:border-box;margin:0;min-width:0;max-width:100%;height:auto;background-color:#FFFFFF;width:38px;height:38px;border-radius:50%;}</style><style data-emotion-css="1cd9gw4">.css-1cd9gw4{margin-left:.3em;}</style><style data-emotion-css="2dtzk2">.css-2dtzk2{cursor:pointer;display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin-left:.3em;}</style><style data-emotion-css="1m3x3v9">.css-1m3x3v9{width:1em;height:1em;}</style><style data-emotion-css="1yuhvjn">.css-1yuhvjn{margin-top:16px;}</style><style data-emotion-css="376mun">.css-376mun{position:relative;display:inline;}</style><style data-emotion-css="1hhle02">.css-1hhle02 .FileLinkCard{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:rgba(246,246,246,0.88);border-radius:12px;box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin:1em auto;max-width:100%;overflow:hidden;padding:12px;position:relative;width:390px;}.css-1hhle02 .FileLinkCard-icon{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;height:30px;width:30px;}.css-1hhle02 .FileLinkCard-info{margin-left:12px;}.css-1hhle02 .FileLinkCard-name{color:#121212;font-size:15px;font-weight:500;line-height:21px;display:-webkit-box;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:2;}.css-1hhle02 .FileLinkCard-meta{color:#999999;font-size:12px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;line-height:14px;margin-top:5px;}.css-1hhle02 .FileLinkCard-source{white-space:pre;}.css-1hhle02 img[data-uncomfortable]{content:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20344.88888888888886%20194%22%3E%3CforeignObject%20width%3D%22344.88888888888886%22%20height%3D%22194%22%3E%0A%20%20%20%20%20%20%3Cdiv%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxhtml%22%20style%3D%22font-size%3A%2013px%3B%20font-family%3A%20-apple-system%2C%20BlinkMacSystemFont%2C%20Microsoft%20YaHei%2C%20sans-serif%3B%20color%3A%20%23fff%3B%20width%3A100%25%3B%20height%3A194px%3B%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20style%3D%22display%3A%20flex%3B%20flex-direction%3A%20column%3B%20align-items%3A%20center%3B%20justify-content%3A%20center%3B%20height%3A%20100%25%3B%22%3E%0A%20%20%20%20%20%20%20%20%20%20%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2218%22%20height%3D%2218%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22currentColor%22%3E%3Cpath%20d%3D%22M8%203.65a7%207%200%2000-1.353.128.65.65%200%2011-.25-1.275A8.3%208.3%200%20018%202.35c2.387%200%204.172.954%205.357%202.125C14.511%205.615%2015.15%207.022%2015.15%208c0%20.621-.257%201.391-.699%202.134a7.076%207.076%200%2001-1.403%201.68l.495.46a.65.65%200%2011-.886.951l-.998-.929a.645.645%200%2001-.104-.097L9.73%2010.501a.647.647%200%2001-.29.301%203.15%203.15%200%2001-4.313-4.094.647.647%200%2001.234-.275L3.908%205.08a5.774%205.774%200%2000-1.283%201.522C2.282%207.198%202.15%207.707%202.15%208c0%20.522.41%201.616%201.407%202.6.965.954%202.43%201.75%204.443%201.75.468%200%20.905-.043%201.311-.12a.65.65%200%2001.243%201.277A8.322%208.322%200%20018%2013.65c-2.387%200-4.172-.954-5.357-2.125C1.49%2010.385.85%208.978.85%208c0-.598.238-1.333.648-2.046A7.054%207.054%200%20012.95%204.188l-.547-.509a.65.65%200%2011.886-.951l8.8%208.194a5.793%205.793%200%20001.244-1.453c.372-.624.516-1.163.516-1.469%200-.522-.41-1.616-1.407-2.6-.965-.954-2.43-1.75-4.443-1.75zM6.29%207.296a1.85%201.85%200%20002.534%202.36l-2.535-2.36zM8%204.85a.65.65%200%20100%201.3%201.85%201.85%200%20011.843%201.694.65.65%200%20101.296-.11A3.15%203.15%200%20008%204.85z%22%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%3E%3C%2Fpath%3E%3C%2Fsvg%3E%0A%20%20%20%20%20%20%20%20%20%20%3Cdiv%20style%3D%22margin%3A%20.6em%200%201.2em%22%3E%E8%AF%A5%E5%9B%BE%E7%89%87%E6%9C%89%E5%8F%AF%E8%83%BD%E4%BC%9A%E5%BC%95%E8%B5%B7%E4%B8%8D%E9%80%82%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%20%20%3Cbutton%20style%3D%22padding%3A%204px%201em%3B%20font-size%3A%201.1em%3B%20color%3A%20inherit%3B%20background%3A%20none%3B%20border%3A%201px%20solid%20rgba%28255%2C255%2C255%2C.5%29%3B%20border-radius%3A%209999px%3B%22%3E%E7%BB%A7%E7%BB%AD%E6%9F%A5%E7%9C%8B%3C%2Fbutton%3E%0A%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%3C%2FforeignObject%3E%3C%2Fsvg%3E);width:100%;height:194px;background:url(https://pic1.zhimg.com/v2-cf70d0759d787c70091857151c1cad4a.jpeg) no-repeat rgba(191,191,191,0.7);background-size:cover;cursor:pointer!important;}</style><style data-emotion-css="1wr1m8">.css-1wr1m8 .LinkCard.new{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:390px;min-height:84px;border-radius:8px;max-width:100%;overflow:hidden;margin:16px auto;padding:12px 12px 9px 12px;background-color:#F6F6F6;}.css-1wr1m8 .LinkCard.new,.css-1wr1m8 .LinkCard.new:hover{-webkit-text-decoration:none;text-decoration:none;border:none !important;color:inherit !important;}.css-1wr1m8 .LinkCard.new .LinkCard-contents{display:block;-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;position:relative;}.css-1wr1m8 .LinkCard.new .LinkCard-contents .loading{height:14px;background:#EBEBEB;border-radius:7px;}.css-1wr1m8 .LinkCard.new .LinkCard-contents.withTitle{margin-bottom:3px;}.css-1wr1m8 .LinkCard.new .LinkCard-title{display:-webkit-box;font-size:15px;font-weight:500;line-height:1.4;margin-bottom:2px;color:#121212;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-1wr1m8 .LinkCard.new .LinkCard-title.two-line{line-height:20px;display:-webkit-box;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:2;}.css-1wr1m8 .LinkCard.new .LinkCard-title.loading{margin-bottom:8px;width:80%;}.css-1wr1m8 .LinkCard.new .LinkCard-title.loading.withTitle{margin-bottom:6px;}.css-1wr1m8 .LinkCard.new .LinkCard-title.loadingTitle{margin-bottom:5px;}.css-1wr1m8 .LinkCard.new .LinkCard-excerpt{display:-webkit-box;text-overflow:ellipsis;font-size:13px;line-height:18px;color:#999999;margin-bottom:4px;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-1wr1m8 .LinkCard.new .LinkCard-excerpt .LinkCard-author{color:#444444;}.css-1wr1m8 .LinkCard.new .LinkCard-desc{display:-webkit-box;font-size:13px;height:18px;line-height:18px;color:#999999;word-break:break-all;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-1wr1m8 .LinkCard.new .LinkCard-desc .LinkCard-tag,.css-1wr1m8 .LinkCard.new .LinkCard-desc .tag{display:inline-block;font-size:11px;margin-left:8px;padding:0 4px;border-radius:3px;background:rgba(211,211,211,0.3);}.css-1wr1m8 .LinkCard.new .LinkCard-desc.loading{width:40%;}.css-1wr1m8 .LinkCard.new .LinkCard-desc svg{margin-right:2px;}.css-1wr1m8 .LinkCard.new .LinkCard-image{-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;background-color:#EBEBEB;background-size:cover;background-position:center;position:relative;display:block;width:60px;height:60px;margin-left:20px;object-fit:cover;border-radius:inherit;overflow:hidden;}.css-1wr1m8 .LinkCard.new .LinkCard-image.LinkCard-image--default{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;background-color:#EBEBEB;color:#D3D3D3;}.css-1wr1m8 .LinkCard.new .LinkCard-image.LinkCard-image--default svg{color:#999999;}.css-1wr1m8 .LinkCard.new .LinkCard-image img{width:100%;height:100%;object-fit:cover;}.css-1wr1m8 .LinkCard.new .LinkCard-image .LinkCard-image--video{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;position:absolute;top:50%;left:50%;-webkit-transform:translateX(-50%) translateY(-50%);-ms-transform:translateX(-50%) translateY(-50%);transform:translateX(-50%) translateY(-50%);width:24px;height:24px;border-radius:12px;background:rgba(255,255,255,0.9);pointer-events:none;}.css-1wr1m8 .LinkCard.new .LinkCard-image .LinkCard-image--video svg{color:#444444;}.css-1wr1m8 .LinkCard.new .LinkCard-richText .text{color:#444444;}.css-1wr1m8 .LinkCard.new .LinkCard-richText .bold{font-weight:600;}.css-1wr1m8 .LinkCard.new .LinkCard-richText .tag{margin-left:4px;}.css-1wr1m8 .LinkCard.old{position:relative;display:block;margin:1em auto;width:390px;box-sizing:border-box;border-radius:12px;max-width:100%;overflow:hidden;}.css-1wr1m8 .LinkCard.old,.css-1wr1m8 .LinkCard.old:hover{-webkit-text-decoration:none;text-decoration:none;border:none !important;color:inherit !important;}.css-1wr1m8 .LinkCard-ecommerceLoadingCard{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;padding:12px;border-radius:inherit;height:80px;box-sizing:border-box;background:rgba(246,246,246,0.88);color:#D3D3D3;}.css-1wr1m8 .LinkCard-ecommerceLoadingCardAvatarWrapper{width:60px;height:60px;background:#EBEBEB;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;border-radius:6px;margin-right:10px;}.css-1wr1m8 .LinkCard-ecommerceLoadingCardNetwork{width:20px;height:20px;}.css-1wr1m8 .LinkCard-ecommerceLoadingCardLoadingbar{height:60px;-webkit-flex:1;-ms-flex:1;flex:1;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}.css-1wr1m8 .LinkCard-ecommerceLoadingCardLoadingbar span{height:16px;display:inline-block;background:#EBEBEB;}.css-1wr1m8 .LinkCard-ecommerceLoadingCardLoadingbar span:nth-of-type(1){width:60px;margin-bottom:4px;}.css-1wr1m8 .LinkCard-ecommerceLoadingCardLoadingbar span:nth-of-type(2){width:127px;}</style><style data-emotion-css="1dnyyvy">.css-1dnyyvy .LinkCard.old{position:relative;display:block;margin:1em auto;width:390px;box-sizing:border-box;border-radius:12px;max-width:100%;overflow:hidden;}.css-1dnyyvy .LinkCard.old,.css-1dnyyvy .LinkCard.old:hover{-webkit-text-decoration:none;text-decoration:none;border:none !important;color:inherit !important;}.css-1dnyyvy .LinkCard-ecommerceLoadingCard{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;padding:12px;border-radius:inherit;height:80px;box-sizing:border-box;background:rgba(246,246,246,0.88);color:#D3D3D3;}.css-1dnyyvy .LinkCard-ecommerceLoadingCardAvatarWrapper{width:60px;height:60px;background:#EBEBEB;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;border-radius:6px;margin-right:10px;}.css-1dnyyvy .LinkCard-ecommerceLoadingCardNetwork{width:20px;height:20px;}.css-1dnyyvy .LinkCard-ecommerceLoadingCardLoadingbar{height:60px;-webkit-flex:1;-ms-flex:1;flex:1;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}.css-1dnyyvy .LinkCard-ecommerceLoadingCardLoadingbar span{height:16px;display:inline-block;background:#EBEBEB;}.css-1dnyyvy .LinkCard-ecommerceLoadingCardLoadingbar span:nth-of-type(1){width:60px;margin-bottom:4px;}.css-1dnyyvy .LinkCard-ecommerceLoadingCardLoadingbar span:nth-of-type(2){width:127px;}.css-1dnyyvy .LinkCard.new{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:390px;min-height:84px;border-radius:8px;max-width:100%;overflow:hidden;margin:16px auto;padding:12px 12px 9px 12px;background-color:#F6F6F6;}.css-1dnyyvy .LinkCard.new,.css-1dnyyvy .LinkCard.new:hover{-webkit-text-decoration:none;text-decoration:none;border:none !important;color:inherit !important;}.css-1dnyyvy .LinkCard.new .LinkCard-contents{display:block;-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;position:relative;}.css-1dnyyvy .LinkCard.new .LinkCard-contents .loading{height:14px;background:#EBEBEB;border-radius:7px;}.css-1dnyyvy .LinkCard.new .LinkCard-contents.withTitle{margin-bottom:3px;}.css-1dnyyvy .LinkCard.new .LinkCard-title{display:-webkit-box;font-size:15px;font-weight:500;line-height:1.4;margin-bottom:2px;color:#121212;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-1dnyyvy .LinkCard.new .LinkCard-title.two-line{line-height:20px;display:-webkit-box;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:2;}.css-1dnyyvy .LinkCard.new .LinkCard-title.loading{margin-bottom:8px;width:80%;}.css-1dnyyvy .LinkCard.new .LinkCard-title.loading.withTitle{margin-bottom:6px;}.css-1dnyyvy .LinkCard.new .LinkCard-title.loadingTitle{margin-bottom:5px;}.css-1dnyyvy .LinkCard.new .LinkCard-excerpt{display:-webkit-box;text-overflow:ellipsis;font-size:13px;line-height:18px;color:#999999;margin-bottom:4px;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-1dnyyvy .LinkCard.new .LinkCard-excerpt .LinkCard-author{color:#444444;}.css-1dnyyvy .LinkCard.new .LinkCard-desc{display:-webkit-box;font-size:13px;height:18px;line-height:18px;color:#999999;word-break:break-all;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-1dnyyvy .LinkCard.new .LinkCard-desc .LinkCard-tag,.css-1dnyyvy .LinkCard.new .LinkCard-desc .tag{display:inline-block;font-size:11px;margin-left:8px;padding:0 4px;border-radius:3px;background:rgba(211,211,211,0.3);}.css-1dnyyvy .LinkCard.new .LinkCard-desc.loading{width:40%;}.css-1dnyyvy .LinkCard.new .LinkCard-desc svg{margin-right:2px;}.css-1dnyyvy .LinkCard.new .LinkCard-image{-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;background-color:#EBEBEB;background-size:cover;background-position:center;position:relative;display:block;width:60px;height:60px;margin-left:20px;object-fit:cover;border-radius:inherit;overflow:hidden;}.css-1dnyyvy .LinkCard.new .LinkCard-image.LinkCard-image--default{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;background-color:#EBEBEB;color:#D3D3D3;}.css-1dnyyvy .LinkCard.new .LinkCard-image.LinkCard-image--default svg{color:#999999;}.css-1dnyyvy .LinkCard.new .LinkCard-image img{width:100%;height:100%;object-fit:cover;}.css-1dnyyvy .LinkCard.new .LinkCard-image .LinkCard-image--video{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;position:absolute;top:50%;left:50%;-webkit-transform:translateX(-50%) translateY(-50%);-ms-transform:translateX(-50%) translateY(-50%);transform:translateX(-50%) translateY(-50%);width:24px;height:24px;border-radius:12px;background:rgba(255,255,255,0.9);pointer-events:none;}.css-1dnyyvy .LinkCard.new .LinkCard-image .LinkCard-image--video svg{color:#444444;}.css-1dnyyvy .LinkCard.new .LinkCard-richText .text{color:#444444;}.css-1dnyyvy .LinkCard.new .LinkCard-richText .bold{font-weight:600;}.css-1dnyyvy .LinkCard.new .LinkCard-richText .tag{margin-left:4px;}.css-1dnyyvy .FileLinkCard{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:rgba(246,246,246,0.88);border-radius:12px;box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin:1em auto;max-width:100%;overflow:hidden;padding:12px;position:relative;width:390px;}.css-1dnyyvy .FileLinkCard-icon{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;height:30px;width:30px;}.css-1dnyyvy .FileLinkCard-info{margin-left:12px;}.css-1dnyyvy .FileLinkCard-name{color:#121212;font-size:15px;font-weight:500;line-height:21px;display:-webkit-box;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:2;}.css-1dnyyvy .FileLinkCard-meta{color:#999999;font-size:12px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;line-height:14px;margin-top:5px;}.css-1dnyyvy .FileLinkCard-source{white-space:pre;}.css-1dnyyvy img[data-uncomfortable]{content:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20344.88888888888886%20194%22%3E%3CforeignObject%20width%3D%22344.88888888888886%22%20height%3D%22194%22%3E%0A%20%20%20%20%20%20%3Cdiv%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxhtml%22%20style%3D%22font-size%3A%2013px%3B%20font-family%3A%20-apple-system%2C%20BlinkMacSystemFont%2C%20Microsoft%20YaHei%2C%20sans-serif%3B%20color%3A%20%23fff%3B%20width%3A100%25%3B%20height%3A194px%3B%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20style%3D%22display%3A%20flex%3B%20flex-direction%3A%20column%3B%20align-items%3A%20center%3B%20justify-content%3A%20center%3B%20height%3A%20100%25%3B%22%3E%0A%20%20%20%20%20%20%20%20%20%20%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2218%22%20height%3D%2218%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22currentColor%22%3E%3Cpath%20d%3D%22M8%203.65a7%207%200%2000-1.353.128.65.65%200%2011-.25-1.275A8.3%208.3%200%20018%202.35c2.387%200%204.172.954%205.357%202.125C14.511%205.615%2015.15%207.022%2015.15%208c0%20.621-.257%201.391-.699%202.134a7.076%207.076%200%2001-1.403%201.68l.495.46a.65.65%200%2011-.886.951l-.998-.929a.645.645%200%2001-.104-.097L9.73%2010.501a.647.647%200%2001-.29.301%203.15%203.15%200%2001-4.313-4.094.647.647%200%2001.234-.275L3.908%205.08a5.774%205.774%200%2000-1.283%201.522C2.282%207.198%202.15%207.707%202.15%208c0%20.522.41%201.616%201.407%202.6.965.954%202.43%201.75%204.443%201.75.468%200%20.905-.043%201.311-.12a.65.65%200%2001.243%201.277A8.322%208.322%200%20018%2013.65c-2.387%200-4.172-.954-5.357-2.125C1.49%2010.385.85%208.978.85%208c0-.598.238-1.333.648-2.046A7.054%207.054%200%20012.95%204.188l-.547-.509a.65.65%200%2011.886-.951l8.8%208.194a5.793%205.793%200%20001.244-1.453c.372-.624.516-1.163.516-1.469%200-.522-.41-1.616-1.407-2.6-.965-.954-2.43-1.75-4.443-1.75zM6.29%207.296a1.85%201.85%200%20002.534%202.36l-2.535-2.36zM8%204.85a.65.65%200%20100%201.3%201.85%201.85%200%20011.843%201.694.65.65%200%20101.296-.11A3.15%203.15%200%20008%204.85z%22%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%3E%3C%2Fpath%3E%3C%2Fsvg%3E%0A%20%20%20%20%20%20%20%20%20%20%3Cdiv%20style%3D%22margin%3A%20.6em%200%201.2em%22%3E%E8%AF%A5%E5%9B%BE%E7%89%87%E6%9C%89%E5%8F%AF%E8%83%BD%E4%BC%9A%E5%BC%95%E8%B5%B7%E4%B8%8D%E9%80%82%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%20%20%3Cbutton%20style%3D%22padding%3A%204px%201em%3B%20font-size%3A%201.1em%3B%20color%3A%20inherit%3B%20background%3A%20none%3B%20border%3A%201px%20solid%20rgba%28255%2C255%2C255%2C.5%29%3B%20border-radius%3A%209999px%3B%22%3E%E7%BB%A7%E7%BB%AD%E6%9F%A5%E7%9C%8B%3C%2Fbutton%3E%0A%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%3C%2FforeignObject%3E%3C%2Fsvg%3E);width:100%;height:194px;background:url(https://pic1.zhimg.com/v2-cf70d0759d787c70091857151c1cad4a.jpeg) no-repeat rgba(191,191,191,0.7);background-size:cover;cursor:pointer!important;}</style><style data-emotion-css="1g0fqss animation-1yvu044">.css-1g0fqss{word-break:break-word;line-height:1.6;}.css-1g0fqss > [data-first-child]{margin-top:0;}.css-1g0fqss > :last-child{margin-bottom:0;}.css-1g0fqss h1,.css-1g0fqss h2{clear:left;margin-top:calc((1.4em * 2) / 1.2);margin-bottom:calc(1.4em / 1.2);font-size:1.2em;line-height:1.5;font-weight:600;}.css-1g0fqss h3,.css-1g0fqss h4,.css-1g0fqss h5,.css-1g0fqss h6{clear:left;margin-top:calc((1.4em * 1.5) / 1.1);margin-bottom:calc(1.4em / 1.1);font-size:1.1em;line-height:1.5;font-weight:600;}.css-1g0fqss u{-webkit-text-decoration:none;text-decoration:none;border-bottom:1px solid #444444;}.css-1g0fqss b{font-weight:600;}.css-1g0fqss sup{font-size:0.8em;}.css-1g0fqss sup[data-draft-type='reference']{color:#175199;}.css-1g0fqss a:focus{outline:none;-webkit-transition:box-shadow 0.3s;transition:box-shadow 0.3s;}html[data-focus-visible] .css-1g0fqss a:focus{box-shadow:0 0 0 2px #FFFFFF,0 0 0 4px rgba(5,109,232,0.3);}.css-1g0fqss a.ztext-link,.css-1g0fqss a.internal,.css-1g0fqss a.external{-webkit-text-decoration:none;text-decoration:none;cursor:pointer;border-bottom:1px solid #808080;}.css-1g0fqss a.ztext-link:hover,.css-1g0fqss a.internal:hover,.css-1g0fqss a.external:hover{color:#175199;border-bottom:1px solid #175199;}.css-1g0fqss a.ztext-link > .ellipsis::after,.css-1g0fqss a.internal > .ellipsis::after,.css-1g0fqss a.external > .ellipsis::after{content:'...';}.css-1g0fqss a.ztext-link > .invisible,.css-1g0fqss a.internal > .invisible,.css-1g0fqss a.external > .invisible{font:0/0 a;color:transparent;text-shadow:none;background-color:transparent;}.css-1g0fqss a.ztext-link u,.css-1g0fqss a.internal u,.css-1g0fqss a.external u{border:none;}.css-1g0fqss a.member_mention{color:#175199;}.css-1g0fqss a.member_mention:hover{border-bottom:1px solid #175199;}.css-1g0fqss a.UserLink-link{color:#175199;}.css-1g0fqss a.UserLink-link:hover{border-bottom:1px solid #175199;}.css-1g0fqss p{margin:1.4em 0;}.css-1g0fqss p.ztext-empty-paragraph{margin:calc((2.8em- (1.4em * 2 + 1.6em)) / 2) 0;}.css-1g0fqss p.ztext-empty-paragraph + .ztext-empty-paragraph{margin:1.4em 0;}.css-1g0fqss hr{margin:4em auto;width:240px;max-width:100%;border:none;border-top:1px solid #D3D3D3;}.css-1g0fqss img[eeimg]{max-width:100%;vertical-align:middle;}.css-1g0fqss img[eeimg="1"]{margin:0 3px;max-width:calc(100% - 6px);display:inline-block;}.css-1g0fqss img[eeimg="2"]{margin:1.4em auto;display:block;}.css-1g0fqss blockquote{margin:1.4em 0;padding-left:1em;color:#646464;border-left:3px solid #D3D3D3;}.css-1g0fqss ol,.css-1g0fqss ul{margin:1.4em 0;padding:0;width:100%;}.css-1g0fqss ol ol,.css-1g0fqss ul ol,.css-1g0fqss ol ul,.css-1g0fqss ul ul{margin:0;}.css-1g0fqss ol li::before,.css-1g0fqss ul li::before{width:1em;}.css-1g0fqss ol > ol,.css-1g0fqss ul > ol,.css-1g0fqss ol > ul,.css-1g0fqss ul > ul{display:table-row;}.css-1g0fqss ol > ol::before,.css-1g0fqss ul > ol::before,.css-1g0fqss ol > ul::before,.css-1g0fqss ul > ul::before{display:table-cell;content:'';}.css-1g0fqss ul{display:table;}.css-1g0fqss ul>li{display:table-row;list-style:none;}.css-1g0fqss ul>li::before{display:table-cell;content:'•  ';white-space:pre;}.css-1g0fqss ol{display:table;counter-reset:ol;}.css-1g0fqss ol > li{display:table-row;list-style:none;}.css-1g0fqss ol > li::before{display:table-cell;text-align:right;counter-increment:ol;content:counter(ol) '. ';white-space:pre;}.css-1g0fqss ol ol{counter-reset:ol2;}.css-1g0fqss ol ol li::before{counter-increment:ol2;content:counter(ol2) '. ';}.css-1g0fqss ol ol ol{counter-reset:ol3;}.css-1g0fqss ol ol ol li::before{counter-increment:ol3;content:counter(ol3) '. ';}.css-1g0fqss ol ol ol ol{counter-reset:ol4;}.css-1g0fqss ol ol ol ol li::before{counter-increment:ol4;content:counter(ol4) '. ';}.css-1g0fqss figure{margin:1.4em 0;}.css-1g0fqss figure .content_image,.css-1g0fqss figure .origin_image{margin:0 auto;}.css-1g0fqss figure figcaption{margin-top:calc(0.6em / 0.9);padding:0 1em;font-size:0.9em;line-height:1.5;text-align:center;color:#999999;}.css-1g0fqss figure + figure{margin-top:calc(1.4em * 1.6);}.css-1g0fqss figure[data-size='small'],.css-1g0fqss figure:not([data-size]) > [data-size='small']{clear:both;}.css-1g0fqss figure[data-size='left'],.css-1g0fqss figure:not([data-size]) > [data-size='left']{float:left;margin:0 20px 20px 0;max-width:33%;}.css-1g0fqss figure[data-size='right'],.css-1g0fqss figure:not([data-size]) > [data-size='right']{float:right;margin:0 0 20px 20px;max-width:33%;}.css-1g0fqss figure[data-size='collapse']{margin-bottom:0;}.css-1g0fqss figure[data-size='collapse'] + figure{margin-top:0;}.css-1g0fqss .content_image,.css-1g0fqss .origin_image{display:block;max-width:100%;height:auto;margin:1.4em auto;}.css-1g0fqss .content_image[data-size='small'],.css-1g0fqss .origin_image[data-size='small']{max-width:40%;}.css-1g0fqss .content_image.zh-lightbox-thumb,.css-1g0fqss .origin_image.zh-lightbox-thumb{cursor:-webkit-zoom-in;cursor:-moz-zoom-in;cursor:zoom-in;}.css-1g0fqss code{margin:0 2px;padding:3px 4px;border-radius:3px;font-family:Menlo,Monaco,Consolas,'Andale Mono','lucida console','Courier New',monospace;font-size:0.9em;background-color:#F6F6F6;}.css-1g0fqss pre{margin:1.4em 0;padding:calc(0.8em / 0.9);font-size:0.9em;word-break:initial;word-wrap:initial;white-space:pre;overflow:auto;-webkit-overflow-scrolling:touch;background:#F6F6F6;border-radius:4px;}.css-1g0fqss pre code{margin:0;padding:0;font-size:inherit;border-radius:0;background-color:inherit;}.css-1g0fqss li pre{white-space:pre-wrap;}.css-1g0fqss table[data-draft-type='table']{border-collapse:collapse;font-size:15px;margin:1.4em auto;max-width:100%;table-layout:fixed;text-align:left;width:100%;}.css-1g0fqss table[data-draft-type='table'][data-size='small']{min-width:260px;width:40%;}.css-1g0fqss table[data-draft-type='table'][data-row-style='striped'] tr:nth-of-type(2n + 1){background:#F6F6F6;}.css-1g0fqss table[data-draft-type='table'] td,.css-1g0fqss table[data-draft-type='table'] th{border:1px solid #D3D3D3;line-height:24px;height:24px;padding:3px 12px;}.css-1g0fqss table[data-draft-type='table'] th{background:#EBEBEB;color:#121212;font-weight:500;}.css-1g0fqss .video-box,.css-1g0fqss .link-box{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;margin:1.4em 0;overflow:auto;white-space:normal;cursor:pointer;border:solid 1px #EBEBEB;border-radius:4px;}.css-1g0fqss .lazy[data-lazy-status]{background-color:#F6F6F6;}.css-1g0fqss .lazy[data-lazy-status="ok"]{background-color:transparent;-webkit-animation:animation-1yvu044 0.5s ease-in;animation:animation-1yvu044 0.5s ease-in;}.css-1g0fqss .highlight{margin:1em 0;}.css-1g0fqss .highlight pre{margin:0;}.css-1g0fqss .highlight .hll{background-color:#FDFDFD;}.css-1g0fqss .highlight .c{font-style:italic;color:#999999;}.css-1g0fqss .highlight .err{color:#F1403C;}.css-1g0fqss .highlight .k{font-weight:600;}.css-1g0fqss .highlight .o{font-weight:600;}.css-1g0fqss .highlight .cm{font-style:italic;color:#999999;}.css-1g0fqss .highlight .cp{font-weight:600;color:#999999;}.css-1g0fqss .highlight .c1{font-style:italic;color:#999999;}.css-1g0fqss .highlight .cs{font-style:italic;font-weight:600;color:#999999;}.css-1g0fqss .highlight .gd{color:#FF3366;}.css-1g0fqss .highlight .ge{font-style:italic;}.css-1g0fqss .highlight .gr{color:#F1403C;}.css-1g0fqss .highlight .gh{color:#999999;}.css-1g0fqss .highlight .gi{color:#12b370;}.css-1g0fqss .highlight .go{color:#808080;}.css-1g0fqss .highlight .gp{color:#646464;}.css-1g0fqss .highlight .gs{font-weight:600;}.css-1g0fqss .highlight .gu{color:#999999;}.css-1g0fqss .highlight .gt{color:#F1403C;}.css-1g0fqss .highlight .kc{font-weight:600;}.css-1g0fqss .highlight .kd{font-weight:600;}.css-1g0fqss .highlight .kn{font-weight:600;}.css-1g0fqss .highlight .kp{font-weight:600;}.css-1g0fqss .highlight .kr{font-weight:600;}.css-1g0fqss .highlight .kt{font-weight:600;color:#175199;}.css-1g0fqss .highlight .m{color:#056DE8;}.css-1g0fqss .highlight .s{color:#F1403C;}.css-1g0fqss .highlight .na{color:#056DE8;}.css-1g0fqss .highlight .nb{color:#056DE8;}.css-1g0fqss .highlight .nc{font-weight:600;color:#175199;}.css-1g0fqss .highlight .no{color:#056DE8;}.css-1g0fqss .highlight .ni{color:#5555DD;}.css-1g0fqss .highlight .ne{font-weight:600;color:#F1403C;}.css-1g0fqss .highlight .nf{font-weight:600;color:#F1403C;}.css-1g0fqss .highlight .nn{color:#646464;}.css-1g0fqss .highlight .nt{color:#175199;}.css-1g0fqss .highlight .nv{color:#056DE8;}.css-1g0fqss .highlight .ow{font-weight:600;}.css-1g0fqss .highlight .w{color:#BFBFBF;}.css-1g0fqss .highlight .mf{color:#056DE8;}.css-1g0fqss .highlight .mh{color:#056DE8;}.css-1g0fqss .highlight .mi{color:#056DE8;}.css-1g0fqss .highlight .mo{color:#056DE8;}.css-1g0fqss .highlight .sb{color:#F1403C;}.css-1g0fqss .highlight .sc{color:#F1403C;}.css-1g0fqss .highlight .sd{color:#F1403C;}.css-1g0fqss .highlight .s2{color:#F1403C;}.css-1g0fqss .highlight .se{color:#F1403C;}.css-1g0fqss .highlight .sh{color:#F1403C;}.css-1g0fqss .highlight .si{color:#F1403C;}.css-1g0fqss .highlight .sx{color:#F1403C;}.css-1g0fqss .highlight .sr{color:#A5542F;}.css-1g0fqss .highlight .s1{color:#F1403C;}.css-1g0fqss .highlight .ss{color:#F1403C;}.css-1g0fqss .highlight .bp{color:#999999;}.css-1g0fqss .highlight .vc{color:#056DE8;}.css-1g0fqss .highlight .vg{color:#056DE8;}.css-1g0fqss .highlight .vi{color:#056DE8;}.css-1g0fqss .highlight .il{color:#056DE8;}.css-1g0fqss .highlight::-webkit-scrollbar{width:6px;height:6px;}.css-1g0fqss .highlight::-webkit-scrollbar-thumb:horizontal{background-color:rgba(18,18,18,0.5);border-radius:6px;}.css-1g0fqss .highlight::-webkit-scrollbar-thumb:horizontal:hover{background-color:rgba(18,18,18,0.6);}.css-1g0fqss .LinkCard.old{position:relative;display:block;margin:1em auto;width:390px;box-sizing:border-box;border-radius:12px;max-width:100%;overflow:hidden;}.css-1g0fqss .LinkCard.old,.css-1g0fqss .LinkCard.old:hover{-webkit-text-decoration:none;text-decoration:none;border:none !important;color:inherit !important;}.css-1g0fqss .LinkCard-ecommerceLoadingCard{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;padding:12px;border-radius:inherit;height:80px;box-sizing:border-box;background:rgba(246,246,246,0.88);color:#D3D3D3;}.css-1g0fqss .LinkCard-ecommerceLoadingCardAvatarWrapper{width:60px;height:60px;background:#EBEBEB;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;border-radius:6px;margin-right:10px;}.css-1g0fqss .LinkCard-ecommerceLoadingCardNetwork{width:20px;height:20px;}.css-1g0fqss .LinkCard-ecommerceLoadingCardLoadingbar{height:60px;-webkit-flex:1;-ms-flex:1;flex:1;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}.css-1g0fqss .LinkCard-ecommerceLoadingCardLoadingbar span{height:16px;display:inline-block;background:#EBEBEB;}.css-1g0fqss .LinkCard-ecommerceLoadingCardLoadingbar span:nth-of-type(1){width:60px;margin-bottom:4px;}.css-1g0fqss .LinkCard-ecommerceLoadingCardLoadingbar span:nth-of-type(2){width:127px;}.css-1g0fqss .LinkCard.new{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:390px;min-height:84px;border-radius:8px;max-width:100%;overflow:hidden;margin:16px auto;padding:12px 12px 9px 12px;background-color:#F6F6F6;}.css-1g0fqss .LinkCard.new,.css-1g0fqss .LinkCard.new:hover{-webkit-text-decoration:none;text-decoration:none;border:none !important;color:inherit !important;}.css-1g0fqss .LinkCard.new .LinkCard-contents{display:block;-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;position:relative;}.css-1g0fqss .LinkCard.new .LinkCard-contents .loading{height:14px;background:#EBEBEB;border-radius:7px;}.css-1g0fqss .LinkCard.new .LinkCard-contents.withTitle{margin-bottom:3px;}.css-1g0fqss .LinkCard.new .LinkCard-title{display:-webkit-box;font-size:15px;font-weight:500;line-height:1.4;margin-bottom:2px;color:#121212;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-1g0fqss .LinkCard.new .LinkCard-title.two-line{line-height:20px;display:-webkit-box;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:2;}.css-1g0fqss .LinkCard.new .LinkCard-title.loading{margin-bottom:8px;width:80%;}.css-1g0fqss .LinkCard.new .LinkCard-title.loading.withTitle{margin-bottom:6px;}.css-1g0fqss .LinkCard.new .LinkCard-title.loadingTitle{margin-bottom:5px;}.css-1g0fqss .LinkCard.new .LinkCard-excerpt{display:-webkit-box;text-overflow:ellipsis;font-size:13px;line-height:18px;color:#999999;margin-bottom:4px;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-1g0fqss .LinkCard.new .LinkCard-excerpt .LinkCard-author{color:#444444;}.css-1g0fqss .LinkCard.new .LinkCard-desc{display:-webkit-box;font-size:13px;height:18px;line-height:18px;color:#999999;word-break:break-all;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-1g0fqss .LinkCard.new .LinkCard-desc .LinkCard-tag,.css-1g0fqss .LinkCard.new .LinkCard-desc .tag{display:inline-block;font-size:11px;margin-left:8px;padding:0 4px;border-radius:3px;background:rgba(211,211,211,0.3);}.css-1g0fqss .LinkCard.new .LinkCard-desc.loading{width:40%;}.css-1g0fqss .LinkCard.new .LinkCard-desc svg{margin-right:2px;}.css-1g0fqss .LinkCard.new .LinkCard-image{-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;background-color:#EBEBEB;background-size:cover;background-position:center;position:relative;display:block;width:60px;height:60px;margin-left:20px;object-fit:cover;border-radius:inherit;overflow:hidden;}.css-1g0fqss .LinkCard.new .LinkCard-image.LinkCard-image--default{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;background-color:#EBEBEB;color:#D3D3D3;}.css-1g0fqss .LinkCard.new .LinkCard-image.LinkCard-image--default svg{color:#999999;}.css-1g0fqss .LinkCard.new .LinkCard-image img{width:100%;height:100%;object-fit:cover;}.css-1g0fqss .LinkCard.new .LinkCard-image .LinkCard-image--video{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;position:absolute;top:50%;left:50%;-webkit-transform:translateX(-50%) translateY(-50%);-ms-transform:translateX(-50%) translateY(-50%);transform:translateX(-50%) translateY(-50%);width:24px;height:24px;border-radius:12px;background:rgba(255,255,255,0.9);pointer-events:none;}.css-1g0fqss .LinkCard.new .LinkCard-image .LinkCard-image--video svg{color:#444444;}.css-1g0fqss .LinkCard.new .LinkCard-richText .text{color:#444444;}.css-1g0fqss .LinkCard.new .LinkCard-richText .bold{font-weight:600;}.css-1g0fqss .LinkCard.new .LinkCard-richText .tag{margin-left:4px;}.css-1g0fqss .FileLinkCard{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:rgba(246,246,246,0.88);border-radius:12px;box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin:1em auto;max-width:100%;overflow:hidden;padding:12px;position:relative;width:390px;}.css-1g0fqss .FileLinkCard-icon{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;height:30px;width:30px;}.css-1g0fqss .FileLinkCard-info{margin-left:12px;}.css-1g0fqss .FileLinkCard-name{color:#121212;font-size:15px;font-weight:500;line-height:21px;display:-webkit-box;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:2;}.css-1g0fqss .FileLinkCard-meta{color:#999999;font-size:12px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;line-height:14px;margin-top:5px;}.css-1g0fqss .FileLinkCard-source{white-space:pre;}.css-1g0fqss img[data-uncomfortable]{content:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20344.88888888888886%20194%22%3E%3CforeignObject%20width%3D%22344.88888888888886%22%20height%3D%22194%22%3E%0A%20%20%20%20%20%20%3Cdiv%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxhtml%22%20style%3D%22font-size%3A%2013px%3B%20font-family%3A%20-apple-system%2C%20BlinkMacSystemFont%2C%20Microsoft%20YaHei%2C%20sans-serif%3B%20color%3A%20%23fff%3B%20width%3A100%25%3B%20height%3A194px%3B%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20style%3D%22display%3A%20flex%3B%20flex-direction%3A%20column%3B%20align-items%3A%20center%3B%20justify-content%3A%20center%3B%20height%3A%20100%25%3B%22%3E%0A%20%20%20%20%20%20%20%20%20%20%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2218%22%20height%3D%2218%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22currentColor%22%3E%3Cpath%20d%3D%22M8%203.65a7%207%200%2000-1.353.128.65.65%200%2011-.25-1.275A8.3%208.3%200%20018%202.35c2.387%200%204.172.954%205.357%202.125C14.511%205.615%2015.15%207.022%2015.15%208c0%20.621-.257%201.391-.699%202.134a7.076%207.076%200%2001-1.403%201.68l.495.46a.65.65%200%2011-.886.951l-.998-.929a.645.645%200%2001-.104-.097L9.73%2010.501a.647.647%200%2001-.29.301%203.15%203.15%200%2001-4.313-4.094.647.647%200%2001.234-.275L3.908%205.08a5.774%205.774%200%2000-1.283%201.522C2.282%207.198%202.15%207.707%202.15%208c0%20.522.41%201.616%201.407%202.6.965.954%202.43%201.75%204.443%201.75.468%200%20.905-.043%201.311-.12a.65.65%200%2001.243%201.277A8.322%208.322%200%20018%2013.65c-2.387%200-4.172-.954-5.357-2.125C1.49%2010.385.85%208.978.85%208c0-.598.238-1.333.648-2.046A7.054%207.054%200%20012.95%204.188l-.547-.509a.65.65%200%2011.886-.951l8.8%208.194a5.793%205.793%200%20001.244-1.453c.372-.624.516-1.163.516-1.469%200-.522-.41-1.616-1.407-2.6-.965-.954-2.43-1.75-4.443-1.75zM6.29%207.296a1.85%201.85%200%20002.534%202.36l-2.535-2.36zM8%204.85a.65.65%200%20100%201.3%201.85%201.85%200%20011.843%201.694.65.65%200%20101.296-.11A3.15%203.15%200%20008%204.85z%22%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%3E%3C%2Fpath%3E%3C%2Fsvg%3E%0A%20%20%20%20%20%20%20%20%20%20%3Cdiv%20style%3D%22margin%3A%20.6em%200%201.2em%22%3E%E8%AF%A5%E5%9B%BE%E7%89%87%E6%9C%89%E5%8F%AF%E8%83%BD%E4%BC%9A%E5%BC%95%E8%B5%B7%E4%B8%8D%E9%80%82%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%20%20%3Cbutton%20style%3D%22padding%3A%204px%201em%3B%20font-size%3A%201.1em%3B%20color%3A%20inherit%3B%20background%3A%20none%3B%20border%3A%201px%20solid%20rgba%28255%2C255%2C255%2C.5%29%3B%20border-radius%3A%209999px%3B%22%3E%E7%BB%A7%E7%BB%AD%E6%9F%A5%E7%9C%8B%3C%2Fbutton%3E%0A%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%3C%2FforeignObject%3E%3C%2Fsvg%3E);width:100%;height:194px;background:url(https://pic1.zhimg.com/v2-cf70d0759d787c70091857151c1cad4a.jpeg) no-repeat rgba(191,191,191,0.7);background-size:cover;cursor:pointer!important;}@-webkit-keyframes animation-1yvu044{from{opacity:0;}to{opacity:1;}}@keyframes animation-1yvu044{from{opacity:0;}to{opacity:1;}}</style><style data-emotion-css="1s3a4zw">.css-1s3a4zw{position:relative;display:inline-block;height:30px;padding:0 12px;font-size:14px;line-height:30px;color:#056DE8;vertical-align:top;border-radius:100px;background:rgba(5,109,232,0.1);}.css-1s3a4zw:hover{background-color:rgba(5,109,232,0.15);}</style><style data-emotion-css="1xlfegr">.css-1xlfegr{background:transparent;box-shadow:none;}</style><style data-emotion-css="1gomreu">.css-1gomreu{position:relative;display:inline-block;}</style><style data-emotion-css="1any501">.css-1any501{box-sizing:border-box;margin:0;min-width:0;max-width:100%;height:auto;background-color:#FFFFFF;width:40px;height:40px;border-radius:50%;}</style><style data-emotion="css"></style></head><body class="WhiteBg-body PostIndex-body" aria-basefontsize="16" data-rh="class"><a id="ariaTipText" role="pagedescription" aria-label="欢迎进入 Protobuf通信协议详解：代码演示、详细原理介绍等 - 知乎,盲人用户使用操作智能引导，请按快捷键Ctrl+Alt+R；阅读详细操作说明请按快捷键Ctrl+Alt+问号键。" aria-atomic="true" href="javascript:void(0)" class="skipAutoFix" style="width: 1px; height: 1px;"><img src="https://zhuanlan.zhihu.com/p/141415216" style="width:1px !important;height:1px !important;position:absolute;top:0;"></a><div id="root"><div class="App"><div class="LoadingBar  css-uzm3ri"></div><div><span style="position:absolute;top:-10000px;left:-10000px" role="log" aria-live="assertive"></span></div><main role="main" class="App-main"><div class="Post-content" data-zop-usertoken="{&quot;userToken&quot;:&quot;hexu1985&quot;}" data-zop="{&quot;authorName&quot;:&quot;CPP加油站&quot;,&quot;itemId&quot;:141415216,&quot;title&quot;:&quot;Protobuf通信协议详解：代码演示、详细原理介绍等&quot;,&quot;type&quot;:&quot;article&quot;}" data-za-detail-view-path-module="PostItem" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;Post&quot;,&quot;token&quot;:&quot;141415216&quot;}}}"><div class="ColumnPageHeader-Wrapper"><div><div class="Sticky ColumnPageHeader is-fixed css-1l12z7y" style="width: 1905px; top: 0px; left: 0px;"><div class="ColumnPageHeader-content"><a href="https://www.zhihu.com/" aria-label="知乎"><svg viewBox="0 0 64 30" fill="#056DE8" width="64" height="30" class="css-1hlrcxk"><path d="M29.05 4.582H16.733V25.94h3.018l.403 2.572 4.081-2.572h4.815V4.582zm-5.207 18.69l-2.396 1.509-.235-1.508h-1.724V7.233h6.78v16.04h-2.425zM14.46 14.191H9.982c0-.471.033-.954.039-1.458v-5.5h5.106V5.935a1.352 1.352 0 0 0-.404-.957 1.378 1.378 0 0 0-.968-.396H5.783c.028-.088.056-.177.084-.255.274-.82 1.153-3.326 1.153-3.326a4.262 4.262 0 0 0-2.413.698c-.57.4-.912.682-1.371 1.946-.532 1.453-.997 2.856-1.31 3.693C1.444 8.674.28 11.025.28 11.025a5.85 5.85 0 0 0 2.52-.61c1.119-.593 1.679-1.502 2.054-2.883l.09-.3h2.334v5.5c0 .5-.045.982-.073 1.46h-4.12c-.71 0-1.39.278-1.893.775a2.638 2.638 0 0 0-.783 1.874h6.527a17.717 17.717 0 0 1-.778 3.649 16.796 16.796 0 0 1-3.012 5.273A33.104 33.104 0 0 1 0 28.74s3.13 1.175 5.425-.954c1.388-1.292 2.631-3.814 3.23-5.727a28.09 28.09 0 0 0 1.12-5.229h5.967v-1.37a1.254 1.254 0 0 0-.373-.899 1.279 1.279 0 0 0-.909-.37z"></path><path d="M11.27 19.675l-2.312 1.491 5.038 7.458a6.905 6.905 0 0 0 .672-2.218 3.15 3.15 0 0 0-.28-2.168l-3.118-4.563zM51.449 15.195V5.842c4.181-.205 7.988-.405 9.438-.483l.851-.05c.387-.399.885-2.395.689-3.021-.073-.25-.213-.666-.638-.555a33.279 33.279 0 0 1-4.277.727c-2.766.321-3.97.404-7.804.682-6.718.487-12.709.72-12.709.72a2.518 2.518 0 0 0 .788 1.834 2.567 2.567 0 0 0 1.883.706c2.278-.095 5.598-.25 8.996-.41v9.203h-12.78c0 .703.281 1.377.783 1.874a2.69 2.69 0 0 0 1.892.777h10.105v7.075c0 .887-.464 1.192-1.231 1.214h-3.92a4.15 4.15 0 0 0 .837 1.544 4.2 4.2 0 0 0 1.403 1.067 6.215 6.215 0 0 0 2.71.277c1.36-.066 2.967-.826 2.967-3.57v-7.607h11.28c.342 0 .67-.135.91-.374.242-.239.378-.563.378-.902v-1.375H51.449z"></path><path d="M42.614 8.873a2.304 2.304 0 0 0-1.508-.926 2.334 2.334 0 0 0-1.727.405l-.376.272 4.255 5.85 2.24-1.62-2.884-3.98zM57.35 8.68l-3.125 4.097 2.24 1.663 4.517-5.927-.375-.277a2.32 2.32 0 0 0-1.722-.452 2.327 2.327 0 0 0-1.536.896z"></path></svg></a><i class="ColumnPageHeader-Line"></i><div class="ColumnPageHeader-Title"><div class="ColumnPageHeader-TitleName"><span class="ColumnPageHeader-TitleMeta">首发于</span><a class="ColumnLink ColumnPageHeader-TitleColumn" href="https://www.zhihu.com/column/c_1226612089185660928">Linux、音视频</a></div></div><div class="ColumnPageHeader-Button"><div class="Popover"><button title="更多" id="Popover1-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover1-content" type="button" class="Button ColumnPageHeader-MenuToggler Button--plain"><svg width="24" height="24" viewBox="0 0 24 24" class="Zi Zi--Dots" fill="currentColor"><path fill-rule="evenodd" d="M5.83 12a1.665 1.665 0 1 1-3.33 0 1.665 1.665 0 0 1 3.33 0Zm7.835 0a1.665 1.665 0 1 1-3.33 0 1.665 1.665 0 0 1 3.33 0Zm6.17 1.665a1.665 1.665 0 1 0 0-3.33 1.665 1.665 0 0 0 0 3.33Z" clip-rule="evenodd"></path></svg></button></div><button type="button" class="Button ColumnPageHeader-WriteButton Button--blue"><svg width="24" height="24" viewBox="0 0 24 24" class="Zi Zi--EditSurround" fill="currentColor"><path fill-rule="evenodd" d="M3.55 5.97a2.415 2.415 0 0 1 2.415-2.416h7.56a.75.75 0 0 1 0 1.5h-7.56a.915.915 0 0 0-.915.915v12.072c0 .505.41.915.915.915h12.074c.506 0 .915-.41.915-.915v-7.557a.75.75 0 0 1 1.5 0v7.557a2.415 2.415 0 0 1-2.415 2.415H5.965A2.415 2.415 0 0 1 3.55 18.04V5.969Z" clip-rule="evenodd"></path><path fill-rule="evenodd" d="M20.239 3.77a.75.75 0 0 1 0 1.06l-8.206 8.206a.75.75 0 0 1-1.06-1.06l8.205-8.206a.75.75 0 0 1 1.06 0Z" clip-rule="evenodd"></path></svg>写文章</button></div></div><div class="ColumnPageHeader-profile"><div class="Popover AppHeader-menu"><button id="Popover4-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover4-content" type="button" class="Button AppHeader-profileEntry FEfUrdfMIKpQDJDqkjte Button--plain fEPKGkUK5jyc4fUuT0QP"><img class="Avatar AppHeader-profileAvatar css-1tzrnvf" src="./Protobuf通信协议详解：代码演示、详细原理介绍等 - 知乎_files/v2-abed1a8c04700ba7d72b45195223e0ff_l.jpg" srcset="https://pic1.zhimg.com/v2-abed1a8c04700ba7d72b45195223e0ff_l.jpg?source=32738c0c 2x" alt="点击打开hexu1985的主页"></button></div><div class="Popover ddLajxN_Q0AuobBZjX9m AppHeaderProfileMenu-creatorHintPopover"><div class="AppHeaderProfileMenu-creatorHintToggler" id="Popover5-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover5-content"></div></div></div></div><div class="Sticky--holder" style="position: relative; inset: 0px; display: block; float: none; margin: 0px; height: 52px;"></div></div></div><article class="Post-Main Post-NormalMain" tabindex="-1"><header class="Post-Header"><h1 class="Post-Title">Protobuf通信协议详解：代码演示、详细原理介绍等</h1><div class="Post-Author"><div class="AuthorInfo" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><div class="AuthorInfo"><meta itemprop="name" content="CPP加油站"><meta itemprop="image" content="https://pica.zhimg.com/v2-e4dcbd4260da75dae5317ee45732f3ae_l.jpg?source=172ae18b"><meta itemprop="url" content="https://www.zhihu.com/people/da-yu-er-2-87"><meta itemprop="zhihu:followerCount"><span class="UserLink AuthorInfo-avatarWrapper"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/da-yu-er-2-87" target="_blank" class="UserLink-link" data-za-detail-view-element_name="User"><img class="Avatar AuthorInfo-avatar css-1y9jkzv" src="./Protobuf通信协议详解：代码演示、详细原理介绍等 - 知乎_files/v2-e4dcbd4260da75dae5317ee45732f3ae_l.jpg" srcset="https://pica.zhimg.com/v2-e4dcbd4260da75dae5317ee45732f3ae_l.jpg?source=172ae18b 2x" alt="CPP加油站"></a></div></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/da-yu-er-2-87" target="_blank" class="UserLink-link" data-za-detail-view-element_name="User">CPP加油站</a></div><span rel="noopener noreferrer" class="css-2dtzk2">​<img src="./Protobuf通信协议详解：代码演示、详细原理介绍等 - 知乎_files/v2-4812630bc27d642f7cafcd6cdeca3d7a.jpg" alt="" class="css-1m3x3v9"></span></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"></div></div></div></div></div><button type="button" class="Button FollowButton Button--primary Button--blue"><span style="display:inline-flex;align-items:center">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="Zi Zi--Plus FollowButton-icon" fill="currentColor"><path fill-rule="evenodd" d="M13.25 3.25a1.25 1.25 0 1 0-2.5 0v7.5h-7.5a1.25 1.25 0 1 0 0 2.5h7.5v7.5a1.25 1.25 0 1 0 2.5 0v-7.5h7.5a1.25 1.25 0 0 0 0-2.5h-7.5v-7.5Z" clip-rule="evenodd"></path></svg></span>关注</button></div><div class="LabelContainer-wrapper"></div><div role="button" tabindex="0"><span class="Voters"><button type="button" class="Button Button--plain">254 人<!-- -->赞同了该文章</button></span></div></header><div class="Post-RichTextContainer"><div class="css-1yuhvjn"><div class="css-376mun"><div class="RichText ztext Post-RichText css-1g0fqss" options="[object Object]"><h2 data-first-child="">1、概述</h2><h3>1.1前言</h3><p data-pid="gjSDLeAs"><br>在移动互联网时代，手机流量、电量是最为有限的资源，而移动端的即时通讯应用无疑必须得直面这两点。<br><br>解决流量过大的基本方法就是使用高度压缩的通信协议，而数据压缩后流量减小带来的自然结果也就是省电：因为大数据量的传输必然需要更久的网络操作、数据序列化及反序列化操作，这些都是电量消耗过快的根源。<br><br>当前即时通讯应用中最热门的通信协议无疑就是Google的Protobuf了，基于它的优秀表现，微信和手机QQ这样的主流IM应用也早已在使用它。本文将详细介绍Protobuf的使用、原理等。<br></p><h3>1.3Protobuf简介</h3><p data-pid="H-osbd2z"><br><b>什么是 Google Protocol Buffer？ 假如您在网上搜索，应该会得到类似这样的文字介绍：</b><br><br>Google Protocol Buffer( 简称 Protobuf) 是 Google 公司内部的混合语言数据标准，目前已经正在使用的有超过 48,162 种报文格式定义和超过 12,183 个 .proto 文件。他们用于 RPC 系统和持续数据存储系统。<br><br>Protocol Buffers 是一种轻便高效的结构化数据存储格式，可以用于结构化数据串行化，或者说序列化。它很适合做数据存储或 RPC 数据交换格式。可用于通讯协议、数据存储等领域的语言无关、平台无关、可扩展的序列化结构数据格式。目前提供了 C++、Java、Python 三种语言的 API（即时通讯网注：Protobuf官方工程主页上显示的已支持的开发语言多达10种，分别有：C++、Java、Python、Objective-C、C#、JavaNano、JavaScript、Ruby、Go、PHP，基本上主流的语言都已支持，详见工程主页：<a href="https://link.zhihu.com/?target=https%3A//github.com/52im/protobuf" class=" external" target="_blank" rel="nofollow noreferrer" data-za-detail-view-id="1043"><span class="invisible">https://</span><span class="visible">github.com/52im/protobu</span><span class="invisible">f</span><span class="ellipsis"></span></a>）。<br><br></p><p class="ztext-empty-paragraph"><br></p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-9365d322fd44d415c9ba9bf26721a281_b.jpg" data-caption="" data-size="normal" data-rawwidth="447" data-rawheight="423" class="origin_image zh-lightbox-thumb" width="447" data-original="https://pic2.zhimg.com/v2-9365d322fd44d415c9ba9bf26721a281_r.jpg"/></noscript><div><img src="./Protobuf通信协议详解：代码演示、详细原理介绍等 - 知乎_files/v2-9365d322fd44d415c9ba9bf26721a281_720w.webp" data-caption="" data-size="normal" data-rawwidth="447" data-rawheight="423" class="origin_image zh-lightbox-thumb lazy" width="447" data-original="https://pic2.zhimg.com/v2-9365d322fd44d415c9ba9bf26721a281_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-9365d322fd44d415c9ba9bf26721a281_b.jpg" data-original-token="v2-e45f1acff3303fc79ea4bf25209bd1d7" height="423" data-lazy-status="ok"></div></figure><p class="ztext-empty-paragraph"><br></p><p data-pid="jsMJ_9N1"><br><br>或许您和我一样，在第一次看完这些介绍后还是不明白 Protobuf 究竟是什么，那么我想一个简单的例子应该比较有助于理解它。<br></p><h2>2、一个简单的例子</h2><p class="ztext-empty-paragraph"><br></p><h3>2.1安装 Google Protocol Buffer</h3><p data-pid="oW1C723D"><br>在网站 <a href="https://link.zhihu.com/?target=https%3A//github.com/52im/protobuf" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">https://</span><span class="visible">github.com/52im/protobu</span><span class="invisible">f</span><span class="ellipsis"></span></a> 上可以下载 Protobuf 的源代码。然后解压编译安装便可以使用它了。<br><br><b>安装步骤如下所示：</b><br></p><p class="ztext-empty-paragraph"><br></p><div class="highlight"><pre><code class="language-text">tar -xzf protobuf-2.1.0.tar.gz
cd protobuf-2.1.0
./configure --prefix=$INSTALL_DIR
make
make check
make install</code></pre></div><p class="ztext-empty-paragraph"><br></p><h3>2.2关于简单例子的描述</h3><p data-pid="WKiGC9ix"><br>我打算使用 Protobuf 和 C++ 开发一个十分简单的例子程序。该程序由两部分组成。第一部分被称为 Writer，第二部分叫做 Reader。Writer 负责将一些结构化的数据写入一个磁盘文件，Reader 则负责从该磁盘文件中读取结构化数据并打印到屏幕上。<br><br><b>准备用于演示的结构化数据是 HelloWorld，它包含两个基本数据：</b><br><br></p><ul><li data-pid="Qlc01-qk">ID，为一个整数类型的数据</li><li data-pid="8JfedKgS">Str，这是一个字符串</li></ul><p class="ztext-empty-paragraph"><br></p><h3>2.3书写 .proto 文件</h3><p data-pid="jkeGO1na"><br>首先我们需要编写一个 proto 文件，定义我们程序中需要处理的结构化数据，在 protobuf 的术语中，结构化数据被称为 Message。proto 文件非常类似 java 或者 C 语言的数据定义。代码清单 1 显示了例子应用中的 proto 文件内容。<br><br><b>清单 1. proto 文件：</b><br></p><div class="highlight"><pre><code class="language-text">package lm;
message helloworld
{
   required int32     id = 1;  // ID
   required string    str = 2;  // str
   optional int32     opt = 3;  //optional field
}</code></pre></div><p data-pid="nRL7UL-G"><br><b>一个比较好的习惯是认真对待 proto 文件的文件名。比如将命名规则定于如下：</b><br></p><div class="highlight"><pre><code class="language-text">packageName.MessageName.proto</code></pre></div><p data-pid="1tEPb2NQ"><br>在上例中，package 名字叫做 lm，定义了一个消息 helloworld，该消息有三个成员，类型为 int32 的 id，另一个为类型为 string 的成员 str。opt 是一个可选的成员，即消息中可以不包含该成员。<br><br></p><h3>2.4编译 .proto 文件</h3><p data-pid="v-gbd94k"><br>写好 proto 文件之后就可以用 Protobuf 编译器将该文件编译成目标语言了。本例中我们将使用 C++。<br><br><b>假设您的 proto 文件存放在 $SRC_DIR 下面，您也想把生成的文件放在同一个目录下，则可以使用如下命令：</b><br></p><div class="highlight"><pre><code class="language-text">protoc -I=$SRC_DIR --cpp_out=$DST_DIR $SRC_DIR/addressbook.proto</code></pre></div><p data-pid="g3lC2lqr"><br><b>命令将生成两个文件：</b><br></p><ul><li data-pid="sikl6uiU">lm.helloworld.pb.h ， 定义了 C++ 类的头文件</li><li data-pid="1uRxo63j"><a href="https://link.zhihu.com/?target=http%3A//lm.helloworld.pb.cc" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">http://</span><span class="visible">lm.helloworld.pb.cc</span><span class="invisible"></span></a> ， C++ 类的实现文件</li></ul><p data-pid="8iumMqL4"><br>在生成的头文件中，定义了一个 C++ 类 helloworld，后面的 Writer 和 Reader 将使用这个类来对消息进行操作。诸如对消息的成员进行赋值，将消息序列化等等都有相应的方法。<br><br></p><h3>2.5编写 writer 和 Reader</h3><p data-pid="DF8-BbIX"><br>如前所述，Writer 将把一个结构化数据写入磁盘，以便其他人来读取。假如我们不使用 Protobuf，其实也有许多的选择。一个可能的方法是将数据转换为字符串，然后将字符串写入磁盘。转换为字符串的方法可以使用 sprintf()，这非常简单。数字 123 可以变成字符串”123”。<br><br>这样做似乎没有什么不妥，但是仔细考虑一下就会发现，这样的做法对写 Reader 的那个人的要求比较高，Reader 的作者必须了 Writer 的细节。比如”123”可以是单个数字 123，但也可以是三个数字 1,2 和 3，等等。这么说来，我们还必须让 Writer 定义一种分隔符一样的字符，以便 Reader 可以正确读取。但分隔符也许还会引起其他的什么问题。最后我们发现一个简单的 Helloworld 也需要写许多处理消息格式的代码。<br><br>如果使用 Protobuf，那么这些细节就可以不需要应用程序来考虑了。<br><br>使用 Protobuf，Writer 的工作很简单，需要处理的结构化数据由 .proto 文件描述，经过上一节中的编译过程后，该数据化结构对应了一个 C++ 的类，并定义在 lm.helloworld.pb.h 中。对于本例，类名为 lm::helloworld。Writer 需要 include 该头文件，然后便可以使用这个类了。<br><br>现在，在 Writer 代码中，将要存入磁盘的结构化数据由一个 lm::helloworld 类的对象表示，它提供了一系列的 get/set 函数用来修改和读取结构化数据中的数据成员，或者叫 field。当我们需要将该结构化数据保存到磁盘上时，类 lm::helloworld 已经提供相应的方法来把一个复杂的数据变成一个字节序列，我们可以将这个字节序列写入磁盘。<br><br>对于想要读取这个数据的程序来说，也只需要使用类 lm::helloworld 的相应反序列化方法来将这个字节序列重新转换会结构化数据。这同我们开始时那个“123”的想法类似，不过 Protobuf 想的远远比我们那个粗糙的字符串转换要全面，因此，我们不如放心将这类事情交给 Protobuf 吧。<br><br>程序清单 2 演示了 Writer 的主要代码，您一定会觉得很简单吧？<br><br><b>清单 2. Writer 的主要代码：</b></p><div class="highlight"><pre><code class="language-text">#include "lm.helloworld.pb.h"
…
 
 int main(void)
 {
   
  lm::helloworld msg1;
  msg1.set_id(101);
  msg1.set_str(“hello”);
     
  // Write the new address book back to disk.
  fstream output("./log", ios::out | ios::trunc | ios::binary);
         
  if (!msg1.SerializeToOstream(&amp;output)) {
      cerr &lt;&lt; "Failed to write msg." &lt;&lt; endl;
      return -1;
  }        
  return 0;
 }</code></pre></div><p data-pid="S57j9-yA"><br>Msg1 是一个 helloworld 类的对象，set_id() 用来设置 id 的值。SerializeToOstream 将对象序列化后写入一个 fstream 流。<br><br>代码清单 3 列出了 reader 的主要代码。<br><br><b>清单 3. Reader：</b></p><div class="highlight"><pre><code class="language-text">#include "lm.helloworld.pb.h"
…
 void ListMsg(const lm::helloworld &amp; msg) {
  cout &lt;&lt; msg.id() &lt;&lt; endl;
  cout &lt;&lt; msg.str() &lt;&lt; endl;
 }
  
 int main(int argc, char* argv[]) {
 
  lm::helloworld msg1;
  
  {
    fstream input("./log", ios::in | ios::binary);
    if (!msg1.ParseFromIstream(&amp;input)) {
      cerr &lt;&lt; "Failed to parse address book." &lt;&lt; endl;
      return -1;
    }
  }
  
  ListMsg(msg1);
  …
 }</code></pre></div><p data-pid="L5Lq6H5y"><br>同样，Reader 声明类 helloworld 的对象 msg1，然后利用 ParseFromIstream 从一个 fstream 流中读取信息并反序列化。此后，ListMsg 中采用 get 方法读取消息的内部信息，并进行打印输出操作。<br><br></p><h3>2.6运行结果</h3><p data-pid="H0C5ivF-"><br><b>运行 Writer 和 Reader 的结果如下：</b><br></p><div class="highlight"><pre><code class="language-text">&gt;writer
&gt;reader
101
Hello</code></pre></div><p data-pid="5aPh3JN9"><br>Reader 读取文件 log 中的序列化信息并打印到屏幕上。本文中所有的例子代码都可以在附件中下载。您可以亲身体验一下。<br><br>这个例子本身并无意义，但只要您稍加修改就可以将它变成更加有用的程序。比如将磁盘替换为网络 socket，那么就可以实现基于网络的数据交换任务。而存储和交换正是 Protobuf 最有效的应用领域。<br></p><h2>3、和其他类似技术的比较</h2><p class="ztext-empty-paragraph"><br></p><h3>3.1简述</h3><p data-pid="FYeWEOxw"><br>看完这个简单的例子之后，希望您已经能理解 Protobuf 能做什么了，那么您可能会说，世上还有很多其他的类似技术啊，比如 XML，JSON，Thrift 等等。和他们相比，Protobuf 有什么不同呢？<br><br>简单说来 Protobuf 的主要优点就是：简单，快。这有测试为证，项目 thrift-protobuf-compare 比较了这些类似的技术，图 1 显示了该项目的一项测试结果，Total Time.<br><br><b>图 1. 性能测试结果：</b><br><br></p><p class="ztext-empty-paragraph"><br></p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-7ca967e21e3bd8c063d63108094c8076_b.jpg" data-caption="" data-size="normal" data-rawwidth="600" data-rawheight="374" class="origin_image zh-lightbox-thumb" width="600" data-original="https://pic3.zhimg.com/v2-7ca967e21e3bd8c063d63108094c8076_r.jpg"/></noscript><div><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;600&#39; height=&#39;374&#39;&gt;&lt;/svg&gt;" data-caption="" data-size="normal" data-rawwidth="600" data-rawheight="374" class="origin_image zh-lightbox-thumb lazy" width="600" data-original="https://pic3.zhimg.com/v2-7ca967e21e3bd8c063d63108094c8076_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-7ca967e21e3bd8c063d63108094c8076_b.jpg" data-original-token="v2-7ac91a9c2b7844e874dbf1ad6b61511a"></div></figure><p class="ztext-empty-paragraph"><br></p><p data-pid="-qI4eV6o"><br><br>Total Time 指一个对象操作的整个时间，包括创建对象，将对象序列化为内存中的字节序列，然后再反序列化的整个过程。从测试结果可以看到 Protobuf 的成绩很好，感兴趣的读者可以自行到网站 <a href="https://link.zhihu.com/?target=https%3A//github.com/eishay/jvm-serializers/wiki" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">https://</span><span class="visible">github.com/eishay/jvm-s</span><span class="invisible">erializers/wiki</span><span class="ellipsis"></span></a>上了解更详细的测试结果。<br><br></p><h3>3.2Protobuf 的优点</h3><p data-pid="4r-qxmQ5"><br>Protobuf 有如 XML，不过它更小、更快、也更简单。你可以定义自己的数据结构，然后使用代码生成器生成的代码来读写这个数据结构。你甚至可以在无需重新部署程序的情况下更新数据结构。只需使用 Protobuf 对数据结构进行一次描述，即可利用各种不同语言或从各种不同数据流中对你的结构化数据轻松读写。<br><br>它有一个非常棒的特性，即“向后”兼容性好，人们不必破坏已部署的、依靠“老”数据格式的程序就可以对数据结构进行升级。这样您的程序就可以不必担心因为消息结构的改变而造成的大规模的代码重构或者迁移的问题。因为添加新的消息中的 field 并不会引起已经发布的程序的任何改变。<br><br>Protobuf 语义更清晰，无需类似 XML 解析器的东西（因为 Protobuf 编译器会将 .proto 文件编译生成对应的数据访问类以对 Protobuf 数据进行序列化、反序列化操作）。<br><br>使用 Protobuf 无需学习复杂的文档对象模型，Protobuf 的编程模式比较友好，简单易学，同时它拥有良好的文档和示例，对于喜欢简单事物的人们而言，Protobuf 比其他的技术更加有吸引力。<br><br></p><h3>3.3Protobuf 的不足</h3><p data-pid="dlh00AH0"><br>Protbuf 与 XML 相比也有不足之处。它功能简单，无法用来表示复杂的概念。<br><br>XML 已经成为多种行业标准的编写工具，Protobuf 只是 Google 公司内部使用的工具，在通用性上还差很多。<br><br>由于文本并不适合用来描述数据结构，所以 Protobuf 也不适合用来对基于文本的标记文档（如 HTML）建模。另外，由于 XML 具有某种程度上的自解释性，它可以被人直接读取编辑，在这一点上 Protobuf 不行，它以二进制的方式存储，除非你有 .proto 定义，否则你没法直接读出 Protobuf 的任何内容【 2 】。<br></p><h2>4、Protobuf 的更多细节</h2><p class="ztext-empty-paragraph"><br></p><h3>4.1简述</h3><p data-pid="yQrlSIDo"><br>人们一直在强调，同 XML 相比， Protobuf 的主要优点在于性能高。它以高效的二进制方式存储，比 XML 小 3 到 10 倍，快 20 到 100 倍。对于这些 “小 3 到 10 倍”,“快 20 到 100 倍”的说法，严肃的程序员需要一个解释。因此在本文的最后，让我们稍微深入 Protobuf 的内部实现吧。<br><br><b>有两项技术保证了采用 Protobuf 的程序能获得相对于 XML 极大的性能提高：</b><br><br></p><ul><li data-pid="JwCw6FTx">第一点：我们可以考察 Protobuf 序列化后的信息内容。您可以看到 Protocol Buffer 信息的表示非常紧凑，这意味着消息的体积减少，自然需要更少的资源。比如网络上传输的字节数更少，需要的 IO 更少等，从而提高性能。</li><li data-pid="kmA1enAm">第二点：我们需要理解 Protobuf 封解包的大致过程，从而理解为什么会比 XML 快很多。</li></ul><p class="ztext-empty-paragraph"><br></p><h3>4.2Google Protocol Buffer 的 Encoding</h3><p data-pid="whFYBnqb"><br>Protobuf 序列化后所生成的二进制消息非常紧凑，这得益于 Protobuf 采用的非常巧妙的 Encoding 方法。<br><br>考察消息结构之前，让我首先要介绍一个叫做 Varint 的术语。Varint 是一种紧凑的表示数字的方法。它用一个或多个字节来表示一个数字，值越小的数字使用越少的字节数。这能减少用来表示数字的字节数。<br><br>比如对于 int32 类型的数字，一般需要 4 个 byte 来表示。但是采用 Varint，对于很小的 int32 类型的数字，则可以用 1 个 byte 来表示。当然凡事都有好的也有不好的一面，采用 Varint 表示法，大的数字则需要 5 个 byte 来表示。从统计的角度来说，一般不会所有的消息中的数字都是大数，因此大多数情况下，采用 Varint 后，可以用更少的字节数来表示数字信息。下面就详细介绍一下 Varint。<br><br>Varint 中的每个 byte 的最高位 bit 有特殊的含义，如果该位为 1，表示后续的 byte 也是该数字的一部分，如果该位为 0，则结束。其他的 7 个 bit 都用来表示数字。因此小于 128 的数字都可以用一个 byte 表示。大于 128 的数字，比如 300，会用两个字节来表示：1010 1100 0000 0010。下图演示了 Google Protocol Buffer 如何解析两个 bytes。注意到最终计算前将两个 byte 的位置相互交换过一次，这是因为 Google Protocol Buffer 字节序采用 little-endian 的方式。<br><br><b>图 6. Varint 编码：</b><br></p><p class="ztext-empty-paragraph"><br></p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-1d652e0b45bcbba589442cb501a58e30_b.jpg" data-caption="" data-size="normal" data-rawwidth="320" data-rawheight="190" class="content_image" width="320"/></noscript><div><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;320&#39; height=&#39;190&#39;&gt;&lt;/svg&gt;" data-caption="" data-size="normal" data-rawwidth="320" data-rawheight="190" class="content_image lazy" width="320" data-actualsrc="https://pic1.zhimg.com/v2-1d652e0b45bcbba589442cb501a58e30_b.jpg" data-original-token="v2-102cf464326c1aa4651a5f010955c5b2"></div></figure><p class="ztext-empty-paragraph"><br></p><p data-pid="6EuFj0Ru"><br><br>消息经过序列化后会成为一个二进制数据流，该流中的数据为一系列的 Key-Value 对。如下图所示。<br><br><b>图 7. Message Buffer：</b><br></p><p class="ztext-empty-paragraph"><br></p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-8088e647c0b394688f40f242207089c9_b.jpg" data-caption="" data-size="normal" data-rawwidth="450" data-rawheight="160" class="origin_image zh-lightbox-thumb" width="450" data-original="https://pic2.zhimg.com/v2-8088e647c0b394688f40f242207089c9_r.jpg"/></noscript><div><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;450&#39; height=&#39;160&#39;&gt;&lt;/svg&gt;" data-caption="" data-size="normal" data-rawwidth="450" data-rawheight="160" class="origin_image zh-lightbox-thumb lazy" width="450" data-original="https://pic2.zhimg.com/v2-8088e647c0b394688f40f242207089c9_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-8088e647c0b394688f40f242207089c9_b.jpg" data-original-token="v2-f0aff06977121a61e3902a511ecd2f6f"></div></figure><p class="ztext-empty-paragraph"><br></p><p data-pid="C9m4ws_j"><br><br>采用这种 Key-Pair 结构无需使用分隔符来分割不同的 Field。对于可选的 Field，如果消息中不存在该 field，那么在最终的 Message Buffer 中就没有该 field，这些特性都有助于节约消息本身的大小。<br><br><b>以代码清单 1 中的消息为例。假设我们生成如下的一个消息 Test1:</b></p><div class="highlight"><pre><code class="language-text">Test1.id = 10;
Test1.str = “hello”；</code></pre></div><p data-pid="X4SWVxTL"><br>则最终的 Message Buffer 中有两个 Key-Value 对，一个对应消息中的 id；另一个对应 str。<br><br>Key 用来标识具体的 field，在解包的时候，Protocol Buffer 根据 Key 就可以知道相应的 Value 应该对应于消息中的哪一个 field。<br><br><b>Key 的定义如下：</b></p><div class="highlight"><pre><code class="language-text">(field_number &lt;&lt; 3) | wire_type</code></pre></div><p data-pid="b1RIpaaS"><br>可以看到 Key 由两部分组成。第一部分是 field_number，比如消息 lm.helloworld 中 field id 的 field_number 为 1。第二部分为 wire_type。表示 Value 的传输类型。<br><br><b>Wire Type 可能的类型如下表所示：</b><br></p><p class="ztext-empty-paragraph"><br></p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-45ad6dce26d5101def5a9cbad312e0d1_b.jpg" data-caption="" data-size="normal" data-rawwidth="777" data-rawheight="214" class="origin_image zh-lightbox-thumb" width="777" data-original="https://pic2.zhimg.com/v2-45ad6dce26d5101def5a9cbad312e0d1_r.jpg"/></noscript><div><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;777&#39; height=&#39;214&#39;&gt;&lt;/svg&gt;" data-caption="" data-size="normal" data-rawwidth="777" data-rawheight="214" class="origin_image zh-lightbox-thumb lazy" width="777" data-original="https://pic2.zhimg.com/v2-45ad6dce26d5101def5a9cbad312e0d1_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-45ad6dce26d5101def5a9cbad312e0d1_b.jpg" data-original-token="v2-25834ec0f6666dfd686040615a5975f4"></div></figure><p class="ztext-empty-paragraph"><br></p><p data-pid="xab_k271"><br><br>在我们的例子当中，field id 所采用的数据类型为 int32，因此对应的 wire type 为 0。细心的读者或许会看到在 Type 0 所能表示的数据类型中有 int32 和 sint32 这两个非常类似的数据类型。Google Protocol Buffer 区别它们的主要意图也是为了减少 encoding 后的字节数。<br><br>在计算机内，一个负数一般会被表示为一个很大的整数，因为计算机定义负数的符号位为数字的最高位。如果采用 Varint 表示一个负数，那么一定需要 5 个 byte。为此 Google Protocol Buffer 定义了 sint32 这种类型，采用 zigzag 编码。<br><br>Zigzag 编码用无符号数来表示有符号数字，正数和负数交错，这就是 zigzag 这个词的含义了。<br><br><b>图 8. ZigZag 编码：</b><br></p><p class="ztext-empty-paragraph"><br></p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-c08cfe889b27a2efd8594d71053fe7b0_b.jpg" data-caption="" data-size="normal" data-rawwidth="366" data-rawheight="220" class="content_image" width="366"/></noscript><div><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;366&#39; height=&#39;220&#39;&gt;&lt;/svg&gt;" data-caption="" data-size="normal" data-rawwidth="366" data-rawheight="220" class="content_image lazy" width="366" data-actualsrc="https://pic1.zhimg.com/v2-c08cfe889b27a2efd8594d71053fe7b0_b.jpg" data-original-token="v2-839bde0dc3784f048cb84e16fe862c0e"></div></figure><p class="ztext-empty-paragraph"><br></p><p data-pid="IzFkBety"><br><br>使用 zigzag 编码，绝对值小的数字，无论正负都可以采用较少的 byte 来表示，充分利用了 Varint 这种技术。<br><br>其他的数据类型，比如字符串等则采用类似数据库中的 varchar 的表示方法，即用一个 varint 表示长度，然后将其余部分紧跟在这个长度部分之后即可。<br><br>通过以上对 protobuf Encoding 方法的介绍，想必您也已经发现 protobuf 消息的内容小，适于网络传输。假如您对那些有关技术细节的描述缺乏耐心和兴趣，那么下面这个简单而直观的比较应该能给您更加深刻的印象。<br><br><b>对于代码清单 1 中的消息，用 Protobuf 序列化后的字节序列为：</b><br></p><div class="highlight"><pre><code class="language-text">08 65 12 06 48 65 6C 6C 6F 77</code></pre></div><p data-pid="rV7gHJWd"><br><b>而如果用 XML，则类似这样：</b></p><div class="highlight"><pre><code class="language-text">31 30 31 3C 2F 69 64 3E 3C 6E 61 6D 65 3E 68 65
6C 6C 6F 3C 2F 6E 61 6D 65 3E 3C 2F 68 65 6C 6C
6F 77 6F 72 6C 64 3E</code></pre></div><p data-pid="7KkZ7ZMd"><br><b>一共 55 个字节，这些奇怪的数字需要稍微解释一下，其含义用 ASCII 表示如下：</b></p><div class="highlight"><pre><code class="language-text">&lt;helloworld&gt;
   &lt;id&gt;101&lt;/id&gt;
   &lt;name&gt;hello&lt;/name&gt;
&lt;/helloworld&gt;</code></pre></div><p class="ztext-empty-paragraph"><br></p><h3>4.3封解包的速度</h3><p data-pid="eIGBCO1K"><br>首先我们来了解一下 XML 的封解包过程。XML 需要从文件中读取出字符串，再转换为 XML 文档对象结构模型。之后，再从 XML 文档对象结构模型中读取指定节点的字符串，最后再将这个字符串转换成指定类型的变量。这个过程非常复杂，其中将 XML 文件转换为文档对象结构模型的过程通常需要完成词法文法分析等大量消耗 CPU 的复杂计算。<br><br>反观 Protobuf，它只需要简单地将一个二进制序列，按照指定的格式读取到 C++ 对应的结构类型中就可以了。从上一节的描述可以看到消息的 decoding 过程也可以通过几个位移操作组成的表达式计算即可完成。速度非常快。<br><br>为了说明这并不是我拍脑袋随意想出来的说法，下面让我们简单分析一下 Protobuf 解包的代码流程吧。<br><br>以代码清单 3 中的 Reader 为例，该程序首先调用 msg1 的 ParseFromIstream 方法，这个方法解析从文件读入的二进制数据流，并将解析出来的数据赋予 helloworld 类的相应数据成员。<br><br><b>该过程可以用下图表示，图 9. 解包流程图：</b><br><br></p><p class="ztext-empty-paragraph"><br></p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-a1982faff71f30f973fbfc5bbce1abed_b.jpg" data-caption="" data-size="normal" data-rawwidth="415" data-rawheight="286" class="content_image" width="415"/></noscript><div><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;415&#39; height=&#39;286&#39;&gt;&lt;/svg&gt;" data-caption="" data-size="normal" data-rawwidth="415" data-rawheight="286" class="content_image lazy" width="415" data-actualsrc="https://pic2.zhimg.com/v2-a1982faff71f30f973fbfc5bbce1abed_b.jpg" data-original-token="v2-e7d0e233dc08651e5d2ec95709908271"></div></figure><p class="ztext-empty-paragraph"><br></p><p data-pid="_Uga1Pdy"><br><br>整个解析过程需要 Protobuf 本身的框架代码和由 Protobuf 编译器生成的代码共同完成。Protobuf 提供了基类 Message 以及 Message_lite 作为通用的 Framework，CodedInputStream 类，WireFormatLite 类等提供了对二进制数据的 decode 功能。<br><br>从 5.1 节的分析来看，Protobuf 的解码可以通过几个简单的数学运算完成，无需复杂的词法语法分析，因此 ReadTag() 等方法都非常快。 在这个调用路径上的其他类和方法都非常简单，感兴趣的读者可以自行阅读。<br><br>相对于 XML 的解析过程，以上的流程图实在是非常简单吧？这也就是 Protobuf 效率高的第二个原因了。<br></p><h2>5、结束语</h2><p data-pid="zXVmsjdc"><br>往往了解越多，人们就会越觉得自己无知。我惶恐地发现自己竟然写了一篇关于序列化的文章，文中必然有许多想当然而自以为是的东西，还希望各位能够去伪存真，更希望真的高手能不吝赐教，给我来信。谢谢。</p><h2>顺便推荐一个关于Protobuf协议详解的视频给大家</h2><h2>点击Protobuf协议详细介绍就可以观看了！</h2><ul><li data-pid="umY6A5qw"><b>另外还有一些关于c++ Linux后台服务器开发的一些知识点分享：Linux，Nginx，MySQL，Redis，P2P，K8S，Docker，TCP/IP，协程，DPDK，webrtc，音视频等等视频。</b></li></ul><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-2b84309a753e911898ffadc79827e0b5_b.jpg" data-caption="" data-size="normal" data-rawwidth="1221" data-rawheight="223" class="origin_image zh-lightbox-thumb" width="1221" data-original="https://pic2.zhimg.com/v2-2b84309a753e911898ffadc79827e0b5_r.jpg"/></noscript><div><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;1221&#39; height=&#39;223&#39;&gt;&lt;/svg&gt;" data-caption="" data-size="normal" data-rawwidth="1221" data-rawheight="223" class="origin_image zh-lightbox-thumb lazy" width="1221" data-original="https://pic2.zhimg.com/v2-2b84309a753e911898ffadc79827e0b5_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-2b84309a753e911898ffadc79827e0b5_b.jpg" data-original-token="v2-42d6b36c0a4a233991e86dcbf70b0bd1"></div></figure><p class="ztext-empty-paragraph"><br></p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-0ea30692bfc80822a4fdf55ef06484ed_b.jpg" data-caption="" data-size="normal" data-rawwidth="640" data-rawheight="353" class="origin_image zh-lightbox-thumb" width="640" data-original="https://pic2.zhimg.com/v2-0ea30692bfc80822a4fdf55ef06484ed_r.jpg"/></noscript><div><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;640&#39; height=&#39;353&#39;&gt;&lt;/svg&gt;" data-caption="" data-size="normal" data-rawwidth="640" data-rawheight="353" class="origin_image zh-lightbox-thumb lazy" width="640" data-original="https://pic2.zhimg.com/v2-0ea30692bfc80822a4fdf55ef06484ed_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-0ea30692bfc80822a4fdf55ef06484ed_b.jpg" data-original-token="v2-b51b4b7ea0afa25d9ee6011b92b8a9b1"></div></figure><h2>喜欢的朋友可以+群832218493获取学习视频</h2><p data-pid="7GBrZEfC"><b>附上一份音视频学习课程大纲给大家</b></p><p class="ztext-empty-paragraph"><br></p><p class="ztext-empty-paragraph"><br></p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-e120b4e3a5fd6049eefe4afd62b95879_b.jpg" data-caption="" data-size="normal" data-rawwidth="480" data-rawheight="1510" class="origin_image zh-lightbox-thumb" width="480" data-original="https://pic2.zhimg.com/v2-e120b4e3a5fd6049eefe4afd62b95879_r.jpg"/></noscript><div><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;480&#39; height=&#39;1510&#39;&gt;&lt;/svg&gt;" data-caption="" data-size="normal" data-rawwidth="480" data-rawheight="1510" class="origin_image zh-lightbox-thumb lazy" width="480" data-original="https://pic2.zhimg.com/v2-e120b4e3a5fd6049eefe4afd62b95879_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-e120b4e3a5fd6049eefe4afd62b95879_b.jpg" data-original-token="v2-b738b1d4466eedb5fc5cc3c1d98c4f51"></div></figure><p></p><p></p></div></div></div></div><div role="button" tabindex="0" class="ContentItem-time">编辑于 2022-01-22 17:39</div><div class="Post-topicsAndReviewer"><div class="TopicList Post-Topics"><div class="Tag Topic css-1s3a4zw" data-za-detail-view-path-module="TopicItem" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;Topic&quot;,&quot;token&quot;:&quot;19831091&quot;}}}"><span class="Tag-content"><a class="TopicLink" href="https://www.zhihu.com/topic/19831091" target="_blank"><div class="css-1gomreu">通信协议</div></a></span></div><div class="Tag Topic css-1s3a4zw" data-za-detail-view-path-module="TopicItem" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;Topic&quot;,&quot;token&quot;:&quot;19564722&quot;}}}"><span class="Tag-content"><a class="TopicLink" href="https://www.zhihu.com/topic/19564722" target="_blank"><div class="css-1gomreu">protobuf</div></a></span></div><div class="Tag Topic css-1s3a4zw" data-za-detail-view-path-module="TopicItem" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;Topic&quot;,&quot;token&quot;:&quot;19560870&quot;}}}"><span class="Tag-content"><a class="TopicLink" href="https://www.zhihu.com/topic/19560870" target="_blank"><div class="css-1gomreu">通信</div></a></span></div></div></div><div><div class="Sticky RichContent-actions is-fixed is-bottom" style="width: 690px; bottom: 0px; left: 607.5px;"><div class="ContentItem-actions" data-za-detail-view-path-module="BottomBar" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;Post&quot;,&quot;id&quot;:&quot;141415216&quot;}}}"><span><button aria-label="赞同 254 " aria-live="polite" type="button" class="Button VoteButton VoteButton--up"><span style="display:inline-flex;align-items:center">​<svg width="10" height="10" viewBox="0 0 24 24" class="Zi Zi--TriangleUp VoteButton-TriangleUp" fill="currentColor"><path fill-rule="evenodd" d="M13.792 3.681c-.781-1.406-2.803-1.406-3.584 0l-7.79 14.023c-.76 1.367.228 3.046 1.791 3.046h15.582c1.563 0 2.55-1.68 1.791-3.046l-7.79-14.023Z" clip-rule="evenodd"></path></svg></span>赞同 254</button><button aria-label="反对" aria-live="polite" type="button" class="Button VoteButton VoteButton--down"><span style="display:inline-flex;align-items:center">​<svg width="10" height="10" viewBox="0 0 24 24" class="Zi Zi--TriangleDown" fill="currentColor"><path fill-rule="evenodd" d="M13.792 20.319c-.781 1.406-2.803 1.406-3.584 0L2.418 6.296c-.76-1.367.228-3.046 1.791-3.046h15.582c1.563 0 2.55 1.68 1.791 3.046l-7.79 14.023Z" clip-rule="evenodd"></path></svg></span></button></span><button type="button" class="Button BottomActions-CommentBtn Button--plain Button--withIcon Button--withLabel"><span style="display:inline-flex;align-items:center">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="Zi Zi--Comment Button-zi" fill="currentColor"><path fill-rule="evenodd" d="M12 2.75a9.25 9.25 0 1 0 4.737 17.197l2.643.817a1 1 0 0 0 1.25-1.25l-.8-2.588A9.25 9.25 0 0 0 12 2.75Z" clip-rule="evenodd"></path></svg></span>13 条评论</button><div class="Popover ShareMenu"><div class="ShareMenu-toggler" id="Popover2-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover2-content"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display:inline-flex;align-items:center">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="Zi Zi--Share Button-zi" fill="currentColor"><path d="M19.47 1.914a.8.8 0 0 1 1.204.778l-1.872 16.386a.9.9 0 0 1-1.204.743l-4.615-1.692a.7.7 0 0 0-.831.28l-1.927 3.02c-.43.674-1.474.369-1.474-.43v-3.865a.8.8 0 0 1 .179-.504l5.808-7.148a.595.595 0 0 0-.897-.781l-5.93 6.354a1.1 1.1 0 0 1-1.258.252L2.57 13.46a.8.8 0 0 1-.08-1.415l16.98-10.13Z"></path></svg></span>分享</button></div></div><button aria-live="polite" type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display:inline-flex;align-items:center">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="Zi Zi--Heart Button-zi" fill="currentColor"><path fill-rule="evenodd" d="M12.004 4.934c1.015-.944 2.484-1.618 3.98-1.618 3.48 0 6.53 3.265 6.15 7.614-.11 1.254-.686 2.55-1.458 3.753-.778 1.215-1.79 2.392-2.845 3.419-1.054 1.028-2.168 1.923-3.161 2.566a9.96 9.96 0 0 1-1.41.777c-.418.182-.862.32-1.268.32s-.848-.137-1.267-.317a9.918 9.918 0 0 1-1.407-.771c-.992-.64-2.103-1.53-3.156-2.555-1.052-1.024-2.062-2.2-2.84-3.417-.77-1.208-1.346-2.51-1.456-3.775-.38-4.349 2.67-7.614 6.15-7.614 1.484 0 2.983.673 3.988 1.618Z" clip-rule="evenodd"></path></svg></span>喜欢</button><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display:inline-flex;align-items:center">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="Zi Zi--Star Button-zi" fill="currentColor"><path d="M10.484 3.307c.673-1.168 2.358-1.168 3.032 0l2.377 4.122a.25.25 0 0 0 .165.12l4.655.987c1.319.28 1.84 1.882.937 2.884l-3.186 3.535a.25.25 0 0 0-.063.193l.5 4.733c.142 1.34-1.222 2.33-2.453 1.782l-4.346-1.938a.25.25 0 0 0-.204 0l-4.346 1.938c-1.231.549-2.595-.442-2.453-1.782l.5-4.733a.25.25 0 0 0-.064-.193L2.35 11.42c-.903-1.002-.382-2.604.937-2.884l4.655-.987a.25.25 0 0 0 .164-.12l2.378-4.122Z"></path></svg></span>收藏</button><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display:inline-flex;align-items:center">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="Zi Zi--Deliver Button-zi" fill="currentColor"><g fill-rule="evenodd" clip-rule="evenodd"><path d="M7.821 12a.75.75 0 0 1 .75-.75h6.857a.75.75 0 0 1 0 1.5H8.571a.75.75 0 0 1-.75-.75ZM8.965 8a.75.75 0 0 1 .75-.75h4.571a.75.75 0 0 1 0 1.5H9.715a.75.75 0 0 1-.75-.75Z"></path><path d="M7.527 3.15a2.35 2.35 0 0 0-2.309 1.91L3.165 15.84a.85.85 0 0 0-.015.16v2.5a2.35 2.35 0 0 0 2.35 2.35h13a2.35 2.35 0 0 0 2.35-2.35V16a.848.848 0 0 0-.015-.16L18.78 5.06a2.35 2.35 0 0 0-2.308-1.91H7.527Zm0 1.7a.65.65 0 0 0-.639.528l-1.88 9.872h13.984l-1.88-9.872a.65.65 0 0 0-.64-.528H7.528Z"></path></g></svg></span>申请转载</button><div class="Post-ActionMenuButton"><div class="Popover"><div id="Popover3-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover3-content"><button type="button" class="Button Button--plain Button--withIcon Button--iconOnly undefined"><span style="display:inline-flex;align-items:center">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="Zi Zi--Dots Button-zi" fill="currentColor"><path fill-rule="evenodd" d="M5.83 12a1.665 1.665 0 1 1-3.33 0 1.665 1.665 0 0 1 3.33 0Zm7.835 0a1.665 1.665 0 1 1-3.33 0 1.665 1.665 0 0 1 3.33 0Zm6.17 1.665a1.665 1.665 0 1 0 0-3.33 1.665 1.665 0 0 0 0 3.33Z" clip-rule="evenodd"></path></svg></span></button></div></div></div></div><div class="Post-SideActions" style="opacity: 1;"><button class="like"><div class="Post-SideActions-icon"><svg width="16" height="16" viewBox="0 0 24 24" class="Zi Zi--TriangleUp Post-SideActions-upIcon" fill="currentColor"><path fill-rule="evenodd" d="M13.792 3.681c-.781-1.406-2.803-1.406-3.584 0l-7.79 14.023c-.76 1.367.228 3.046 1.791 3.046h15.582c1.563 0 2.55-1.68 1.791-3.046l-7.79-14.023Z" clip-rule="evenodd"></path></svg></div><div class="likeCount"><div class="likeCount-inner" data-previous="已赞同 255">赞同 254</div></div></button><div class="Popover ShareMenu"><div class="ShareMenu-toggler" id="Popover8-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover8-content"><button><div class="Post-SideActions-icon"><span style="display: inline-flex; align-items: center;">​<svg width="20" height="20" viewBox="0 0 24 24" class="Zi Zi--Share" fill="currentColor"><path d="M19.47 1.914a.8.8 0 0 1 1.204.778l-1.872 16.386a.9.9 0 0 1-1.204.743l-4.615-1.692a.7.7 0 0 0-.831.28l-1.927 3.02c-.43.674-1.474.369-1.474-.43v-3.865a.8.8 0 0 1 .179-.504l5.808-7.148a.595.595 0 0 0-.897-.781l-5.93 6.354a1.1 1.1 0 0 1-1.258.252L2.57 13.46a.8.8 0 0 1-.08-1.415l16.98-10.13Z"></path></svg></span></div>分享</button></div></div></div></div><div class="Sticky--holder" style="position: static; inset: auto auto 0px 0px; display: block; float: none; margin: 0px 0px 10px; height: 54px;"></div></div></article><div class="Post-Sub Post-NormalSub"><div style="overflow: unset;" data-za-detail-view-path-module="CommentList" data-za-extra-module="{}"><div class="Comments-container css-plbgu"><div class="css-79elbk"><div><div class="css-1fo89v5"><img class="Avatar css-1oi6kgx" src="./Protobuf通信协议详解：代码演示、详细原理介绍等 - 知乎_files/v2-abed1a8c04700ba7d72b45195223e0ff_l.jpg" srcset="https://pic1.zhimg.com/v2-abed1a8c04700ba7d72b45195223e0ff_l.jpg?source=32738c0c 2x"><div class="css-x0pxoz"><div class="css-i6bazn"><div class="css-0"><div class="InputLike css-ip4bff Editable"><div class="Dropzone Editable-content RichText RichText--editable RichText--clearBoth ztext" style="min-height: 38px;"><div class="DraftEditor-root"><div class="public-DraftEditorPlaceholder-root"><div class="public-DraftEditorPlaceholder-inner" id="placeholder-c4nve" style="white-space: pre-wrap;">评论千万条，友善第一条</div></div><div class="DraftEditor-editorContainer"><div aria-describedby="placeholder-c4nve" class="notranslate public-DraftEditor-content" contenteditable="true" spellcheck="true" tabindex="0" style="outline: none; user-select: text; white-space: pre-wrap; overflow-wrap: break-word;" role="textbox"><div data-contents="true"><div class="Editable-unstyled" data-block="true" data-editor="c4nve" data-offset-key="5hmv7-0-0"><div data-offset-key="5hmv7-0-0" class="public-DraftStyleDefault-block public-DraftStyleDefault-ltr"><span data-offset-key="5hmv7-0-0"><br data-text="true"></span></div></div></div></div></div></div></div><div></div><input multiple="" type="file" accept="image/webp,image/jpg,image/jpeg,image/png,image/gif" style="display: none;"></div></div></div></div></div></div><div class="css-z07uxh"><div class="css-we6n55"><div class="css-vpssrj"><div class="css-1k10w8f">13 条评论</div></div><div class="css-59erns"></div><div class="css-1hnxfhy"><div class="css-gjiv4z">默认</div><div class="css-1v9si9f">最新</div></div></div><div class="css-840pn3"><div class="css-1frn93x"><div><div class="css-194v73m"><div class="css-1jll2aj"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/e31040a4cd5950e5533d437f0051aac1" target="_blank" class="css-y06ck6"><img class="Avatar css-1s1htbw" src="./Protobuf通信协议详解：代码演示、详细原理介绍等 - 知乎_files/v2-ba6f1b66ca551b0114cfa3dac003f071_l.jpg" srcset="https://pic1.zhimg.com/v2-ba6f1b66ca551b0114cfa3dac003f071_l.jpg?source=06d4cd63 2x" alt="Jarvis" loading="lazy"></a></div></div><div class="css-14nvvry"><div class="css-1besdh8"><div class="css-swj9d4"><div class="css-1tww9qq"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/e31040a4cd5950e5533d437f0051aac1" target="_blank" class="css-1rd0h6f">Jarvis</a></div><div class="css-1qe0v6x"><div class="css-1ssbn0c"></div></div></div></div><svg width="16" height="16" viewBox="0 0 24 24" class="ZDI ZDI--Dots24 css-zgte1c" fill="currentColor"><path fill-rule="evenodd" d="M5.83 12a1.665 1.665 0 1 1-3.33 0 1.665 1.665 0 0 1 3.33 0Zm7.835 0a1.665 1.665 0 1 1-3.33 0 1.665 1.665 0 0 1 3.33 0Zm6.17 1.665a1.665 1.665 0 1 0 0-3.33 1.665 1.665 0 0 0 0 3.33Z" clip-rule="evenodd"></path></svg></div><div class="CommentContent css-1ygdre8">而且.proto文件里面需要指明版本，比如syntax="proto2"，不然会报错。哎，还是去看官方文档吧</div><div class="css-140jo2"><div class="css-8hxn0r"><div class="css-x1xlu5"><span class="css-12cl38p">2022-03-18</span></div></div><div class="css-18opwoy"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel css-1o56bgb"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ChatBubbleFill24 css-15ro776" fill="currentColor"><path fill-rule="evenodd" d="M12 2.75a9.25 9.25 0 1 0 4.737 17.197l2.643.817a1 1 0 0 0 1.25-1.25l-.8-2.588A9.25 9.25 0 0 0 12 2.75Z" clip-rule="evenodd"></path></svg></span>回复</button><button type="button" class="Button Button--plain Button--grey Button--withIcon Button--withLabel css-h1yvwn" style="transform: none;"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ThumbFill24 css-15ro776" fill="currentColor"><path d="M8.5 4.078c0-1.834 1.986-2.979 3.573-2.06a4.826 4.826 0 0 1 2.379 4.71l-.114 1.022h3.581c2.53 0 4.334 2.454 3.58 4.868l-1.823 5.833a3.784 3.784 0 0 1-3.848 2.64c-2.372-.147-6.042-.341-8.828-.341H4.5A1.75 1.75 0 0 1 2.75 19V9.5c0-.967.784-1.75 1.75-1.75h.637a3.418 3.418 0 0 0 3.19-2.191c.115-.296.173-.611.173-.928v-.553Z"></path></svg></span>6</button></div></div></div></div><div><div class="css-8j5fyx"><div class="css-1jll2aj"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/10fbdf3747737ecfe05323a570f9f01c" target="_blank" class="css-y06ck6"><img class="Avatar css-1s1htbw" src="./Protobuf通信协议详解：代码演示、详细原理介绍等 - 知乎_files/v2-ccfe51613800110246751527f31f7738_l.jpg" srcset="https://pic1.zhimg.com/v2-ccfe51613800110246751527f31f7738_l.jpg?source=06d4cd63 2x" alt="亚庄" loading="lazy"></a></div></div><div class="css-14nvvry"><div class="css-1besdh8"><div class="css-swj9d4"><div class="css-1tww9qq"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/10fbdf3747737ecfe05323a570f9f01c" target="_blank" class="css-1rd0h6f">亚庄</a></div><div class="css-1qe0v6x"><div class="css-1ssbn0c"></div></div></div></div><svg width="16" height="16" viewBox="0 0 24 24" class="ZDI ZDI--Dots24 css-zgte1c" fill="currentColor"><path fill-rule="evenodd" d="M5.83 12a1.665 1.665 0 1 1-3.33 0 1.665 1.665 0 0 1 3.33 0Zm7.835 0a1.665 1.665 0 1 1-3.33 0 1.665 1.665 0 0 1 3.33 0Zm6.17 1.665a1.665 1.665 0 1 0 0-3.33 1.665 1.665 0 0 0 0 3.33Z" clip-rule="evenodd"></path></svg></div><div class="CommentContent css-1ygdre8"><p>不是报错吧，是警告，默认是采用proto2版本</p></div><div class="css-140jo2"><div class="css-8hxn0r"><div class="css-x1xlu5"><span class="css-12cl38p">2022-11-28</span></div></div><div class="css-18opwoy"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel css-1o56bgb"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ChatBubbleFill24 css-15ro776" fill="currentColor"><path fill-rule="evenodd" d="M12 2.75a9.25 9.25 0 1 0 4.737 17.197l2.643.817a1 1 0 0 0 1.25-1.25l-.8-2.588A9.25 9.25 0 0 0 12 2.75Z" clip-rule="evenodd"></path></svg></span>回复</button><button type="button" class="Button Button--plain Button--grey Button--withIcon Button--withLabel css-h1yvwn" style="transform: none;"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ThumbFill24 css-15ro776" fill="currentColor"><path d="M8.5 4.078c0-1.834 1.986-2.979 3.573-2.06a4.826 4.826 0 0 1 2.379 4.71l-.114 1.022h3.581c2.53 0 4.334 2.454 3.58 4.868l-1.823 5.833a3.784 3.784 0 0 1-3.848 2.64c-2.372-.147-6.042-.341-8.828-.341H4.5A1.75 1.75 0 0 1 2.75 19V9.5c0-.967.784-1.75 1.75-1.75h.637a3.418 3.418 0 0 0 3.19-2.191c.115-.296.173-.611.173-.928v-.553Z"></path></svg></span>赞</button></div></div></div></div></div></div><div><div class="css-194v73m"><div class="css-1jll2aj"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/7ab319ecbc13d4c701e1b0b29783d557" target="_blank" class="css-y06ck6"><img class="Avatar css-1s1htbw" src="./Protobuf通信协议详解：代码演示、详细原理介绍等 - 知乎_files/v2-abed1a8c04700ba7d72b45195223e0ff_l(1).jpg" srcset="https://picx.zhimg.com/v2-abed1a8c04700ba7d72b45195223e0ff_l.jpg?source=06d4cd63 2x" alt="李光宇" loading="lazy"></a></div></div><div class="css-14nvvry"><div class="css-1besdh8"><div class="css-swj9d4"><div class="css-1tww9qq"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/7ab319ecbc13d4c701e1b0b29783d557" target="_blank" class="css-1rd0h6f">李光宇</a></div><div class="css-1qe0v6x"><div class="css-1ssbn0c"></div><img src="./Protobuf通信协议详解：代码演示、详细原理介绍等 - 知乎_files/v2-4812630bc27d642f7cafcd6cdeca3d7a(1).jpg" class="css-1pj8qrb"></div></div></div><svg width="16" height="16" viewBox="0 0 24 24" class="ZDI ZDI--Dots24 css-zgte1c" fill="currentColor"><path fill-rule="evenodd" d="M5.83 12a1.665 1.665 0 1 1-3.33 0 1.665 1.665 0 0 1 3.33 0Zm7.835 0a1.665 1.665 0 1 1-3.33 0 1.665 1.665 0 0 1 3.33 0Zm6.17 1.665a1.665 1.665 0 1 0 0-3.33 1.665 1.665 0 0 0 0 3.33Z" clip-rule="evenodd"></path></svg></div><div class="CommentContent css-1ygdre8"><p>说的很清晰，重点突出，一下就明白了。</p><p>不过这个zigzag，其实就是把符号位放在最低位了嘛。整得好像很神秘</p></div><div class="css-140jo2"><div class="css-8hxn0r"><div class="css-x1xlu5"><span class="css-12cl38p">2022-09-10</span></div></div><div class="css-18opwoy"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel css-1o56bgb"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ChatBubbleFill24 css-15ro776" fill="currentColor"><path fill-rule="evenodd" d="M12 2.75a9.25 9.25 0 1 0 4.737 17.197l2.643.817a1 1 0 0 0 1.25-1.25l-.8-2.588A9.25 9.25 0 0 0 12 2.75Z" clip-rule="evenodd"></path></svg></span>回复</button><button type="button" class="Button Button--plain Button--grey Button--withIcon Button--withLabel css-h1yvwn" style="transform: none;"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ThumbFill24 css-15ro776" fill="currentColor"><path d="M8.5 4.078c0-1.834 1.986-2.979 3.573-2.06a4.826 4.826 0 0 1 2.379 4.71l-.114 1.022h3.581c2.53 0 4.334 2.454 3.58 4.868l-1.823 5.833a3.784 3.784 0 0 1-3.848 2.64c-2.372-.147-6.042-.341-8.828-.341H4.5A1.75 1.75 0 0 1 2.75 19V9.5c0-.967.784-1.75 1.75-1.75h.637a3.418 3.418 0 0 0 3.19-2.191c.115-.296.173-.611.173-.928v-.553Z"></path></svg></span>2</button></div></div></div></div></div><div><div class="css-194v73m"><div class="css-1jll2aj"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/e8ff5d2586ccb671a5f42a8e20a5408d" target="_blank" class="css-y06ck6"><img class="Avatar css-1s1htbw" src="./Protobuf通信协议详解：代码演示、详细原理介绍等 - 知乎_files/v2-3328cb743a3fa1b961d8a8b87041acc0_l.jpg" srcset="https://picx.zhimg.com/v2-3328cb743a3fa1b961d8a8b87041acc0_l.jpg?source=06d4cd63 2x" alt="转轴拨弦三两声L" loading="lazy"></a></div></div><div class="css-14nvvry"><div class="css-1besdh8"><div class="css-swj9d4"><div class="css-1tww9qq"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/e8ff5d2586ccb671a5f42a8e20a5408d" target="_blank" class="css-1rd0h6f">转轴拨弦三两声L</a></div><div class="css-1qe0v6x"><div class="css-1ssbn0c"></div></div></div></div><svg width="16" height="16" viewBox="0 0 24 24" class="ZDI ZDI--Dots24 css-zgte1c" fill="currentColor"><path fill-rule="evenodd" d="M5.83 12a1.665 1.665 0 1 1-3.33 0 1.665 1.665 0 0 1 3.33 0Zm7.835 0a1.665 1.665 0 1 1-3.33 0 1.665 1.665 0 0 1 3.33 0Zm6.17 1.665a1.665 1.665 0 1 0 0-3.33 1.665 1.665 0 0 0 0 3.33Z" clip-rule="evenodd"></path></svg></div><div class="CommentContent css-1ygdre8">请问下，一个proto文件里import了2个proto文件:a.proto和b.proto。同时a，b文件里面也import了其他的proto文件。当然这些文件在不同的目录下。这样的情况要用protoc 编译，怎么配置呢</div><div class="css-140jo2"><div class="css-8hxn0r"><div class="css-x1xlu5"><span class="css-12cl38p">2020-06-16</span></div></div><div class="css-18opwoy"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel css-1o56bgb"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ChatBubbleFill24 css-15ro776" fill="currentColor"><path fill-rule="evenodd" d="M12 2.75a9.25 9.25 0 1 0 4.737 17.197l2.643.817a1 1 0 0 0 1.25-1.25l-.8-2.588A9.25 9.25 0 0 0 12 2.75Z" clip-rule="evenodd"></path></svg></span>回复</button><button type="button" class="Button Button--plain Button--grey Button--withIcon Button--withLabel css-h1yvwn" style="transform: none;"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ThumbFill24 css-15ro776" fill="currentColor"><path d="M8.5 4.078c0-1.834 1.986-2.979 3.573-2.06a4.826 4.826 0 0 1 2.379 4.71l-.114 1.022h3.581c2.53 0 4.334 2.454 3.58 4.868l-1.823 5.833a3.784 3.784 0 0 1-3.848 2.64c-2.372-.147-6.042-.341-8.828-.341H4.5A1.75 1.75 0 0 1 2.75 19V9.5c0-.967.784-1.75 1.75-1.75h.637a3.418 3.418 0 0 0 3.19-2.191c.115-.296.173-.611.173-.928v-.553Z"></path></svg></span>赞</button></div></div></div></div></div><div><div class="css-194v73m"><div class="css-1jll2aj"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/6c6a663fa0d7173d0236a4165d6385a7" target="_blank" class="css-y06ck6"><img class="Avatar css-1s1htbw" src="./Protobuf通信协议详解：代码演示、详细原理介绍等 - 知乎_files/v2-8f2ce1cfabeca0b066931b31d0aebb6e_l.jpg" srcset="https://picx.zhimg.com/v2-8f2ce1cfabeca0b066931b31d0aebb6e_l.jpg?source=06d4cd63 2x" alt="点点点" loading="lazy"></a></div></div><div class="css-14nvvry"><div class="css-1besdh8"><div class="css-swj9d4"><div class="css-1tww9qq"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/6c6a663fa0d7173d0236a4165d6385a7" target="_blank" class="css-1rd0h6f">点点点</a></div><div class="css-1qe0v6x"><div class="css-1ssbn0c"></div></div></div></div><svg width="16" height="16" viewBox="0 0 24 24" class="ZDI ZDI--Dots24 css-zgte1c" fill="currentColor"><path fill-rule="evenodd" d="M5.83 12a1.665 1.665 0 1 1-3.33 0 1.665 1.665 0 0 1 3.33 0Zm7.835 0a1.665 1.665 0 1 1-3.33 0 1.665 1.665 0 0 1 3.33 0Zm6.17 1.665a1.665 1.665 0 1 0 0-3.33 1.665 1.665 0 0 0 0 3.33Z" clip-rule="evenodd"></path></svg></div><div class="CommentContent css-1ygdre8">大佬没看见视频呀  哪里获取视频呀<img src="./Protobuf通信协议详解：代码演示、详细原理介绍等 - 知乎_files/v2-76c864a7fd5ddc110965657078812811.png" class="sticker" alt="[调皮]"><img src="./Protobuf通信协议详解：代码演示、详细原理介绍等 - 知乎_files/v2-76c864a7fd5ddc110965657078812811.png" class="sticker" alt="[调皮]"><img src="./Protobuf通信协议详解：代码演示、详细原理介绍等 - 知乎_files/v2-76c864a7fd5ddc110965657078812811.png" class="sticker" alt="[调皮]">  来白嫖了我</div><div class="css-140jo2"><div class="css-8hxn0r"><div class="css-x1xlu5"><span class="css-12cl38p">2020-05-21</span></div></div><div class="css-18opwoy"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel css-1o56bgb"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ChatBubbleFill24 css-15ro776" fill="currentColor"><path fill-rule="evenodd" d="M12 2.75a9.25 9.25 0 1 0 4.737 17.197l2.643.817a1 1 0 0 0 1.25-1.25l-.8-2.588A9.25 9.25 0 0 0 12 2.75Z" clip-rule="evenodd"></path></svg></span>回复</button><button type="button" class="Button Button--plain Button--grey Button--withIcon Button--withLabel css-h1yvwn" style="transform: none;"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ThumbFill24 css-15ro776" fill="currentColor"><path d="M8.5 4.078c0-1.834 1.986-2.979 3.573-2.06a4.826 4.826 0 0 1 2.379 4.71l-.114 1.022h3.581c2.53 0 4.334 2.454 3.58 4.868l-1.823 5.833a3.784 3.784 0 0 1-3.848 2.64c-2.372-.147-6.042-.341-8.828-.341H4.5A1.75 1.75 0 0 1 2.75 19V9.5c0-.967.784-1.75 1.75-1.75h.637a3.418 3.418 0 0 0 3.19-2.191c.115-.296.173-.611.173-.928v-.553Z"></path></svg></span>赞</button></div></div></div></div></div><div><div class="css-194v73m"><div class="css-1jll2aj"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/f849dfbc87c5bb5a727448fcc42f0c82" target="_blank" class="css-y06ck6"><img class="Avatar css-1s1htbw" src="./Protobuf通信协议详解：代码演示、详细原理介绍等 - 知乎_files/v2-abed1a8c04700ba7d72b45195223e0ff_l(1).jpg" srcset="https://picx.zhimg.com/v2-abed1a8c04700ba7d72b45195223e0ff_l.jpg?source=06d4cd63 2x" alt="施文征" loading="lazy"></a></div></div><div class="css-14nvvry"><div class="css-1besdh8"><div class="css-swj9d4"><div class="css-1tww9qq"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/f849dfbc87c5bb5a727448fcc42f0c82" target="_blank" class="css-1rd0h6f">施文征</a></div><div class="css-1qe0v6x"><div class="css-1ssbn0c"></div></div></div></div><svg width="16" height="16" viewBox="0 0 24 24" class="ZDI ZDI--Dots24 css-zgte1c" fill="currentColor"><path fill-rule="evenodd" d="M5.83 12a1.665 1.665 0 1 1-3.33 0 1.665 1.665 0 0 1 3.33 0Zm7.835 0a1.665 1.665 0 1 1-3.33 0 1.665 1.665 0 0 1 3.33 0Zm6.17 1.665a1.665 1.665 0 1 0 0-3.33 1.665 1.665 0 0 0 0 3.33Z" clip-rule="evenodd"></path></svg></div><div class="CommentContent css-1ygdre8">跪求大佬分享资料视频。。</div><div class="css-140jo2"><div class="css-8hxn0r"><div class="css-x1xlu5"><span class="css-12cl38p">2021-10-28</span></div></div><div class="css-18opwoy"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel css-1o56bgb"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ChatBubbleFill24 css-15ro776" fill="currentColor"><path fill-rule="evenodd" d="M12 2.75a9.25 9.25 0 1 0 4.737 17.197l2.643.817a1 1 0 0 0 1.25-1.25l-.8-2.588A9.25 9.25 0 0 0 12 2.75Z" clip-rule="evenodd"></path></svg></span>回复</button><button type="button" class="Button Button--plain Button--grey Button--withIcon Button--withLabel css-h1yvwn" style="transform: none;"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ThumbFill24 css-15ro776" fill="currentColor"><path d="M8.5 4.078c0-1.834 1.986-2.979 3.573-2.06a4.826 4.826 0 0 1 2.379 4.71l-.114 1.022h3.581c2.53 0 4.334 2.454 3.58 4.868l-1.823 5.833a3.784 3.784 0 0 1-3.848 2.64c-2.372-.147-6.042-.341-8.828-.341H4.5A1.75 1.75 0 0 1 2.75 19V9.5c0-.967.784-1.75 1.75-1.75h.637a3.418 3.418 0 0 0 3.19-2.191c.115-.296.173-.611.173-.928v-.553Z"></path></svg></span>赞</button></div></div></div></div><div><div class="css-8j5fyx"><div class="css-1jll2aj"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/b3aa0b779f66d08c2f4be961e807a695" target="_blank" class="css-y06ck6"><img class="Avatar css-1s1htbw" src="./Protobuf通信协议详解：代码演示、详细原理介绍等 - 知乎_files/v2-e4dcbd4260da75dae5317ee45732f3ae_l(1).jpg" srcset="https://picx.zhimg.com/v2-e4dcbd4260da75dae5317ee45732f3ae_l.jpg?source=06d4cd63 2x" alt="CPP加油站" loading="lazy"></a></div></div><div class="css-14nvvry"><div class="css-1besdh8"><div class="css-swj9d4"><div class="css-1tww9qq"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/b3aa0b779f66d08c2f4be961e807a695" target="_blank" class="css-1rd0h6f">CPP加油站</a></div><div class="css-1qe0v6x"><div class="css-1ssbn0c"></div><span class="css-h9ndtl" href="">作者</span><img src="./Protobuf通信协议详解：代码演示、详细原理介绍等 - 知乎_files/v2-4812630bc27d642f7cafcd6cdeca3d7a(1).jpg" class="css-1pj8qrb"></div></div></div><svg width="16" height="16" viewBox="0 0 24 24" class="ZDI ZDI--Dots24 css-zgte1c" fill="currentColor"><path fill-rule="evenodd" d="M5.83 12a1.665 1.665 0 1 1-3.33 0 1.665 1.665 0 0 1 3.33 0Zm7.835 0a1.665 1.665 0 1 1-3.33 0 1.665 1.665 0 0 1 3.33 0Zm6.17 1.665a1.665 1.665 0 1 0 0-3.33 1.665 1.665 0 0 0 0 3.33Z" clip-rule="evenodd"></path></svg></div><div class="CommentContent css-1ygdre8">私信一下</div><div class="css-140jo2"><div class="css-8hxn0r"><div class="css-x1xlu5"><span class="css-12cl38p">2021-10-28</span></div></div><div class="css-18opwoy"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel css-1o56bgb"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ChatBubbleFill24 css-15ro776" fill="currentColor"><path fill-rule="evenodd" d="M12 2.75a9.25 9.25 0 1 0 4.737 17.197l2.643.817a1 1 0 0 0 1.25-1.25l-.8-2.588A9.25 9.25 0 0 0 12 2.75Z" clip-rule="evenodd"></path></svg></span>回复</button><button type="button" class="Button Button--plain Button--grey Button--withIcon Button--withLabel css-h1yvwn" style="transform: none;"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ThumbFill24 css-15ro776" fill="currentColor"><path d="M8.5 4.078c0-1.834 1.986-2.979 3.573-2.06a4.826 4.826 0 0 1 2.379 4.71l-.114 1.022h3.581c2.53 0 4.334 2.454 3.58 4.868l-1.823 5.833a3.784 3.784 0 0 1-3.848 2.64c-2.372-.147-6.042-.341-8.828-.341H4.5A1.75 1.75 0 0 1 2.75 19V9.5c0-.967.784-1.75 1.75-1.75h.637a3.418 3.418 0 0 0 3.19-2.191c.115-.296.173-.611.173-.928v-.553Z"></path></svg></span>赞</button></div></div></div></div></div></div><div><div class="css-194v73m"><div class="css-1jll2aj"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/87492ae6412aea3acbf8b2666b5845dc" target="_blank" class="css-y06ck6"><img class="Avatar css-1s1htbw" src="./Protobuf通信协议详解：代码演示、详细原理介绍等 - 知乎_files/v2-abed1a8c04700ba7d72b45195223e0ff_l(1).jpg" srcset="https://picx.zhimg.com/v2-abed1a8c04700ba7d72b45195223e0ff_l.jpg?source=06d4cd63 2x" alt="啊日" loading="lazy"></a></div></div><div class="css-14nvvry"><div class="css-1besdh8"><div class="css-swj9d4"><div class="css-1tww9qq"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/87492ae6412aea3acbf8b2666b5845dc" target="_blank" class="css-1rd0h6f">啊日</a></div><div class="css-1qe0v6x"><div class="css-1ssbn0c"></div></div></div></div><svg width="16" height="16" viewBox="0 0 24 24" class="ZDI ZDI--Dots24 css-zgte1c" fill="currentColor"><path fill-rule="evenodd" d="M5.83 12a1.665 1.665 0 1 1-3.33 0 1.665 1.665 0 0 1 3.33 0Zm7.835 0a1.665 1.665 0 1 1-3.33 0 1.665 1.665 0 0 1 3.33 0Zm6.17 1.665a1.665 1.665 0 1 0 0-3.33 1.665 1.665 0 0 0 0 3.33Z" clip-rule="evenodd"></path></svg></div><div class="CommentContent css-1ygdre8">大佬跪求分享视频资料，另外没有看到文章里提到的附件呢</div><div class="css-140jo2"><div class="css-8hxn0r"><div class="css-x1xlu5"><span class="css-12cl38p">2021-07-09</span></div></div><div class="css-18opwoy"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel css-1o56bgb"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ChatBubbleFill24 css-15ro776" fill="currentColor"><path fill-rule="evenodd" d="M12 2.75a9.25 9.25 0 1 0 4.737 17.197l2.643.817a1 1 0 0 0 1.25-1.25l-.8-2.588A9.25 9.25 0 0 0 12 2.75Z" clip-rule="evenodd"></path></svg></span>回复</button><button type="button" class="Button Button--plain Button--grey Button--withIcon Button--withLabel css-h1yvwn" style="transform: none;"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ThumbFill24 css-15ro776" fill="currentColor"><path d="M8.5 4.078c0-1.834 1.986-2.979 3.573-2.06a4.826 4.826 0 0 1 2.379 4.71l-.114 1.022h3.581c2.53 0 4.334 2.454 3.58 4.868l-1.823 5.833a3.784 3.784 0 0 1-3.848 2.64c-2.372-.147-6.042-.341-8.828-.341H4.5A1.75 1.75 0 0 1 2.75 19V9.5c0-.967.784-1.75 1.75-1.75h.637a3.418 3.418 0 0 0 3.19-2.191c.115-.296.173-.611.173-.928v-.553Z"></path></svg></span>赞</button></div></div></div></div></div><div><div class="css-194v73m"><div class="css-1jll2aj"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/d0c1025c74f9685240790c66047131af" target="_blank" class="css-y06ck6"><img class="Avatar css-1s1htbw" src="./Protobuf通信协议详解：代码演示、详细原理介绍等 - 知乎_files/v2-e10d72ca92beb3cf23fb655cb63dfd59_l.jpg" srcset="https://picx.zhimg.com/v2-e10d72ca92beb3cf23fb655cb63dfd59_l.jpg?source=06d4cd63 2x" alt="不死鸟" loading="lazy"></a></div></div><div class="css-14nvvry"><div class="css-1besdh8"><div class="css-swj9d4"><div class="css-1tww9qq"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/d0c1025c74f9685240790c66047131af" target="_blank" class="css-1rd0h6f">不死鸟</a></div><div class="css-1qe0v6x"><div class="css-1ssbn0c"></div></div></div></div><svg width="16" height="16" viewBox="0 0 24 24" class="ZDI ZDI--Dots24 css-zgte1c" fill="currentColor"><path fill-rule="evenodd" d="M5.83 12a1.665 1.665 0 1 1-3.33 0 1.665 1.665 0 0 1 3.33 0Zm7.835 0a1.665 1.665 0 1 1-3.33 0 1.665 1.665 0 0 1 3.33 0Zm6.17 1.665a1.665 1.665 0 1 0 0-3.33 1.665 1.665 0 0 0 0 3.33Z" clip-rule="evenodd"></path></svg></div><div class="CommentContent css-1ygdre8">能分享下音视频学习资料不</div><div class="css-140jo2"><div class="css-8hxn0r"><div class="css-x1xlu5"><span class="css-12cl38p">2021-07-07</span></div></div><div class="css-18opwoy"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel css-1o56bgb"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ChatBubbleFill24 css-15ro776" fill="currentColor"><path fill-rule="evenodd" d="M12 2.75a9.25 9.25 0 1 0 4.737 17.197l2.643.817a1 1 0 0 0 1.25-1.25l-.8-2.588A9.25 9.25 0 0 0 12 2.75Z" clip-rule="evenodd"></path></svg></span>回复</button><button type="button" class="Button Button--plain Button--grey Button--withIcon Button--withLabel css-h1yvwn" style="transform: none;"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ThumbFill24 css-15ro776" fill="currentColor"><path d="M8.5 4.078c0-1.834 1.986-2.979 3.573-2.06a4.826 4.826 0 0 1 2.379 4.71l-.114 1.022h3.581c2.53 0 4.334 2.454 3.58 4.868l-1.823 5.833a3.784 3.784 0 0 1-3.848 2.64c-2.372-.147-6.042-.341-8.828-.341H4.5A1.75 1.75 0 0 1 2.75 19V9.5c0-.967.784-1.75 1.75-1.75h.637a3.418 3.418 0 0 0 3.19-2.191c.115-.296.173-.611.173-.928v-.553Z"></path></svg></span>赞</button></div></div></div></div></div><div><div class="css-194v73m"><div class="css-1jll2aj"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/99c571c0ce20d7a26f8905907171ae2e" target="_blank" class="css-y06ck6"><img class="Avatar css-1s1htbw" src="./Protobuf通信协议详解：代码演示、详细原理介绍等 - 知乎_files/171561ec97ead748b993a3e1cb4fe5ef_l.jpg" srcset="https://pic1.zhimg.com/171561ec97ead748b993a3e1cb4fe5ef_l.jpg?source=06d4cd63 2x" alt="lixin" loading="lazy"></a></div></div><div class="css-14nvvry"><div class="css-1besdh8"><div class="css-swj9d4"><div class="css-1tww9qq"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/99c571c0ce20d7a26f8905907171ae2e" target="_blank" class="css-1rd0h6f">lixin</a></div><div class="css-1qe0v6x"><div class="css-1ssbn0c"></div></div></div></div><svg width="16" height="16" viewBox="0 0 24 24" class="ZDI ZDI--Dots24 css-zgte1c" fill="currentColor"><path fill-rule="evenodd" d="M5.83 12a1.665 1.665 0 1 1-3.33 0 1.665 1.665 0 0 1 3.33 0Zm7.835 0a1.665 1.665 0 1 1-3.33 0 1.665 1.665 0 0 1 3.33 0Zm6.17 1.665a1.665 1.665 0 1 0 0-3.33 1.665 1.665 0 0 0 0 3.33Z" clip-rule="evenodd"></path></svg></div><div class="CommentContent css-1ygdre8">大佬分享一下资料呗，小弟我感激不尽</div><div class="css-140jo2"><div class="css-8hxn0r"><div class="css-x1xlu5"><span class="css-12cl38p">2021-06-05</span></div></div><div class="css-18opwoy"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel css-1o56bgb"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ChatBubbleFill24 css-15ro776" fill="currentColor"><path fill-rule="evenodd" d="M12 2.75a9.25 9.25 0 1 0 4.737 17.197l2.643.817a1 1 0 0 0 1.25-1.25l-.8-2.588A9.25 9.25 0 0 0 12 2.75Z" clip-rule="evenodd"></path></svg></span>回复</button><button type="button" class="Button Button--plain Button--grey Button--withIcon Button--withLabel css-h1yvwn" style="transform: none;"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ThumbFill24 css-15ro776" fill="currentColor"><path d="M8.5 4.078c0-1.834 1.986-2.979 3.573-2.06a4.826 4.826 0 0 1 2.379 4.71l-.114 1.022h3.581c2.53 0 4.334 2.454 3.58 4.868l-1.823 5.833a3.784 3.784 0 0 1-3.848 2.64c-2.372-.147-6.042-.341-8.828-.341H4.5A1.75 1.75 0 0 1 2.75 19V9.5c0-.967.784-1.75 1.75-1.75h.637a3.418 3.418 0 0 0 3.19-2.191c.115-.296.173-.611.173-.928v-.553Z"></path></svg></span>赞</button></div></div></div></div><div><div class="css-8j5fyx"><div class="css-1jll2aj"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/b3aa0b779f66d08c2f4be961e807a695" target="_blank" class="css-y06ck6"><img class="Avatar css-1s1htbw" src="./Protobuf通信协议详解：代码演示、详细原理介绍等 - 知乎_files/v2-e4dcbd4260da75dae5317ee45732f3ae_l(1).jpg" srcset="https://picx.zhimg.com/v2-e4dcbd4260da75dae5317ee45732f3ae_l.jpg?source=06d4cd63 2x" alt="CPP加油站" loading="lazy"></a></div></div><div class="css-14nvvry"><div class="css-1besdh8"><div class="css-swj9d4"><div class="css-1tww9qq"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/b3aa0b779f66d08c2f4be961e807a695" target="_blank" class="css-1rd0h6f">CPP加油站</a></div><div class="css-1qe0v6x"><div class="css-1ssbn0c"></div><span class="css-h9ndtl" href="">作者</span><img src="./Protobuf通信协议详解：代码演示、详细原理介绍等 - 知乎_files/v2-4812630bc27d642f7cafcd6cdeca3d7a(1).jpg" class="css-1pj8qrb"></div></div></div><svg width="16" height="16" viewBox="0 0 24 24" class="ZDI ZDI--Dots24 css-zgte1c" fill="currentColor"><path fill-rule="evenodd" d="M5.83 12a1.665 1.665 0 1 1-3.33 0 1.665 1.665 0 0 1 3.33 0Zm7.835 0a1.665 1.665 0 1 1-3.33 0 1.665 1.665 0 0 1 3.33 0Zm6.17 1.665a1.665 1.665 0 1 0 0-3.33 1.665 1.665 0 0 0 0 3.33Z" clip-rule="evenodd"></path></svg></div><div class="CommentContent css-1ygdre8">私</div><div class="css-140jo2"><div class="css-8hxn0r"><div class="css-x1xlu5"><span class="css-12cl38p">2021-06-07</span></div></div><div class="css-18opwoy"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel css-1o56bgb"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ChatBubbleFill24 css-15ro776" fill="currentColor"><path fill-rule="evenodd" d="M12 2.75a9.25 9.25 0 1 0 4.737 17.197l2.643.817a1 1 0 0 0 1.25-1.25l-.8-2.588A9.25 9.25 0 0 0 12 2.75Z" clip-rule="evenodd"></path></svg></span>回复</button><button type="button" class="Button Button--plain Button--grey Button--withIcon Button--withLabel css-h1yvwn" style="transform: none;"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ThumbFill24 css-15ro776" fill="currentColor"><path d="M8.5 4.078c0-1.834 1.986-2.979 3.573-2.06a4.826 4.826 0 0 1 2.379 4.71l-.114 1.022h3.581c2.53 0 4.334 2.454 3.58 4.868l-1.823 5.833a3.784 3.784 0 0 1-3.848 2.64c-2.372-.147-6.042-.341-8.828-.341H4.5A1.75 1.75 0 0 1 2.75 19V9.5c0-.967.784-1.75 1.75-1.75h.637a3.418 3.418 0 0 0 3.19-2.191c.115-.296.173-.611.173-.928v-.553Z"></path></svg></span>赞</button></div></div></div></div></div></div><div><div class="css-194v73m"><div class="css-1jll2aj"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/789e46782058fc200315ea553a0b7747" target="_blank" class="css-y06ck6"><img class="Avatar css-1s1htbw" src="./Protobuf通信协议详解：代码演示、详细原理介绍等 - 知乎_files/v2-abed1a8c04700ba7d72b45195223e0ff_l(1).jpg" srcset="https://picx.zhimg.com/v2-abed1a8c04700ba7d72b45195223e0ff_l.jpg?source=06d4cd63 2x" alt="知乎用户KHckUu" loading="lazy"></a></div></div><div class="css-14nvvry"><div class="css-1besdh8"><div class="css-swj9d4"><div class="css-1tww9qq"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/789e46782058fc200315ea553a0b7747" target="_blank" class="css-1rd0h6f">知乎用户KHckUu</a></div><div class="css-1qe0v6x"><div class="css-1ssbn0c"></div></div></div></div><svg width="16" height="16" viewBox="0 0 24 24" class="ZDI ZDI--Dots24 css-zgte1c" fill="currentColor"><path fill-rule="evenodd" d="M5.83 12a1.665 1.665 0 1 1-3.33 0 1.665 1.665 0 0 1 3.33 0Zm7.835 0a1.665 1.665 0 1 1-3.33 0 1.665 1.665 0 0 1 3.33 0Zm6.17 1.665a1.665 1.665 0 1 0 0-3.33 1.665 1.665 0 0 0 0 3.33Z" clip-rule="evenodd"></path></svg></div><div class="CommentContent css-1ygdre8">爲什麽不用官方的probuf？而且就麽麽一點，有什麽意義</div><div class="css-140jo2"><div class="css-8hxn0r"><div class="css-x1xlu5"><span class="css-12cl38p">2022-03-31</span></div></div><div class="css-18opwoy"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel css-1o56bgb"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ChatBubbleFill24 css-15ro776" fill="currentColor"><path fill-rule="evenodd" d="M12 2.75a9.25 9.25 0 1 0 4.737 17.197l2.643.817a1 1 0 0 0 1.25-1.25l-.8-2.588A9.25 9.25 0 0 0 12 2.75Z" clip-rule="evenodd"></path></svg></span>回复</button><button type="button" class="Button Button--plain Button--grey Button--withIcon Button--withLabel css-h1yvwn" style="transform: none;"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ThumbFill24 css-15ro776" fill="currentColor"><path d="M8.5 4.078c0-1.834 1.986-2.979 3.573-2.06a4.826 4.826 0 0 1 2.379 4.71l-.114 1.022h3.581c2.53 0 4.334 2.454 3.58 4.868l-1.823 5.833a3.784 3.784 0 0 1-3.848 2.64c-2.372-.147-6.042-.341-8.828-.341H4.5A1.75 1.75 0 0 1 2.75 19V9.5c0-.967.784-1.75 1.75-1.75h.637a3.418 3.418 0 0 0 3.19-2.191c.115-.296.173-.611.173-.928v-.553Z"></path></svg></span>赞</button></div></div></div></div></div><div><div class="css-194v73m"><div class="css-1jll2aj"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/e31040a4cd5950e5533d437f0051aac1" target="_blank" class="css-y06ck6"><img class="Avatar css-1s1htbw" src="./Protobuf通信协议详解：代码演示、详细原理介绍等 - 知乎_files/v2-ba6f1b66ca551b0114cfa3dac003f071_l(1).jpg" srcset="https://pica.zhimg.com/v2-ba6f1b66ca551b0114cfa3dac003f071_l.jpg?source=06d4cd63 2x" alt="Jarvis" loading="lazy"></a></div></div><div class="css-14nvvry"><div class="css-1besdh8"><div class="css-swj9d4"><div class="css-1tww9qq"><div class="css-1gomreu"><a href="https://www.zhihu.com/people/e31040a4cd5950e5533d437f0051aac1" target="_blank" class="css-1rd0h6f">Jarvis</a></div><div class="css-1qe0v6x"><div class="css-1ssbn0c"></div></div></div></div><svg width="16" height="16" viewBox="0 0 24 24" class="ZDI ZDI--Dots24 css-zgte1c" fill="currentColor"><path fill-rule="evenodd" d="M5.83 12a1.665 1.665 0 1 1-3.33 0 1.665 1.665 0 0 1 3.33 0Zm7.835 0a1.665 1.665 0 1 1-3.33 0 1.665 1.665 0 0 1 3.33 0Zm6.17 1.665a1.665 1.665 0 1 0 0-3.33 1.665 1.665 0 0 0 0 3.33Z" clip-rule="evenodd"></path></svg></div><div class="CommentContent css-1ygdre8">protoc编译那个命令很奇怪啊，好像是官方文档上的，另外可以多作解释，这样确实看不大懂</div><div class="css-140jo2"><div class="css-8hxn0r"><div class="css-x1xlu5"><span class="css-12cl38p">2022-03-18</span></div></div><div class="css-18opwoy"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel css-1o56bgb"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ChatBubbleFill24 css-15ro776" fill="currentColor"><path fill-rule="evenodd" d="M12 2.75a9.25 9.25 0 1 0 4.737 17.197l2.643.817a1 1 0 0 0 1.25-1.25l-.8-2.588A9.25 9.25 0 0 0 12 2.75Z" clip-rule="evenodd"></path></svg></span>回复</button><button type="button" class="Button Button--plain Button--grey Button--withIcon Button--withLabel css-h1yvwn" style="transform: none;"><span style="display: inline-flex; align-items: center;">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="ZDI ZDI--ThumbFill24 css-15ro776" fill="currentColor"><path d="M8.5 4.078c0-1.834 1.986-2.979 3.573-2.06a4.826 4.826 0 0 1 2.379 4.71l-.114 1.022h3.581c2.53 0 4.334 2.454 3.58 4.868l-1.823 5.833a3.784 3.784 0 0 1-3.848 2.64c-2.372-.147-6.042-.341-8.828-.341H4.5A1.75 1.75 0 0 1 2.75 19V9.5c0-.967.784-1.75 1.75-1.75h.637a3.418 3.418 0 0 0 3.19-2.191c.115-.296.173-.611.173-.928v-.553Z"></path></svg></span>赞</button></div></div></div></div></div><div></div></div></div></div></div></div></div><div class="PostIndex-Contributions" data-za-detail-view-path-module="ColumnList" data-za-detail-view-path-module_name="文章被以下专栏收录" data-za-extra-module="{}"><h3 class="BlockTitle">文章被以下专栏收录</h3><ul><div class="ContentItem Column-ColumnItem"><div class="ContentItem-main"><div class="ContentItem-image"><a class="ColumnLink" href="https://www.zhihu.com/column/c_1226612089185660928"><div class="css-1gomreu"><img class="Avatar css-1any501" src="./Protobuf通信协议详解：代码演示、详细原理介绍等 - 知乎_files/4b70deef7_l.jpg" srcset="https://picx.zhimg.com/4b70deef7_l.jpg?source=172ae18b 2x" alt="Linux、音视频"></div></a></div><div class="ContentItem-head"><h2 class="ContentItem-title"><span><a class="ColumnLink ColumnItem-Title" href="https://www.zhihu.com/column/c_1226612089185660928"><div class="css-1gomreu">Linux、音视频</div></a></span></h2><div class="ContentItem-meta">专栏所有文章资料可以加群：832218493领取</div></div></div></div></ul></div><div role="complementary" aria-label="推荐阅读" class="Recommendations-Main" style="width: 1905px;"><h3 class="BlockTitle Recommendations-BlockTitle">推荐阅读</h3><ul class="Recommendations-List"><button class="PagingButton PagingButton-Previous" disabled="" data-za-detail-view-path-module="Unknown" data-za-detail-view-path-module_name="推荐阅读" data-za-extra-module="{}"><svg width="40" height="40" viewBox="0 0 24 24" fill="#d3d3d3" class="Zi Zi--ArrowLeft"><path fill-rule="evenodd" d="m10.752 12 4.025-3.78a.684.684 0 0 0 0-1.01.796.796 0 0 0-1.075 0l-4.42 4.15a.866.866 0 0 0 0 1.28l4.42 4.15a.796.796 0 0 0 1.075 0 .684.684 0 0 0 0-1.01L10.752 12Z" clip-rule="evenodd"></path></svg></button><a href="https://zhuanlan.zhihu.com/p/149433880" class="PostItem"><div><h1 class="PostItem-Title">3分钟了解VLAN基础知识，实例讲解VLAN通信原理</h1><p class="PostItem-Summary">VLAN的应用在网络项目中是非常广泛的，基本上大部分的项目都需要划分VLAN，今天我们就从基础的VLAN的知识开始，讲一下什么是VLAN，VLAN的作用，以及VLAN的通信原理。 什么是VLAN VLAN被称作…</p><div class="PostItem-Footer"><span>震雄注塑机</span><span class="PostItem-FooterTitle">发表于震雄</span></div></div></a><a href="https://zhuanlan.zhihu.com/p/96911745" class="PostItem"><div><h1 class="PostItem-Title">linux下C++ socket网络编程——即时通信系统（含源码）</h1><p class="PostItem-Summary">一：项目内容本项目使用C++实现一个具备服务器端和客户端即时通信且具有私聊功能的聊天室。 目的是学习C++网络开发的基本概念，同时也可以熟悉下Linux下的C++程序编译和简单MakeFile编写 二…</p><div class="PostItem-Footer"><span>linux</span><span class="PostItem-FooterTitle"></span></div></div></a><a href="https://zhuanlan.zhihu.com/p/95375255" class="PostItem"><div><h1 class="PostItem-Title">linux下C++ socket网络编程——即时通信系统（含源码）</h1><p class="PostItem-Summary">一：项目内容本项目使用C++实现一个具备服务器端和客户端即时通信且具有私聊功能的聊天室。 目的是学习C++网络开发的基本概念，同时也可以熟悉下Linux下的C++程序编译和简单MakeFile编写 二…</p><div class="PostItem-Footer"><span>linux</span><span class="PostItem-FooterTitle"></span></div></div></a><a href="https://zhuanlan.zhihu.com/p/40853378" class="PostItem"><div><img src="./Protobuf通信协议详解：代码演示、详细原理介绍等 - 知乎_files/v2-4463b561b319386f061dae9faa2ad92d_250x0.jpg" srcset="https://picx.zhimg.com/v2-4463b561b319386f061dae9faa2ad92d_qhd.jpg?source=172ae18b 2x" class="PostItem-TitleImage" alt="基于APNs最新HTTP/2接口实现iOS的高性能消息推送"><h1 class="PostItem-Title">基于APNs最新HTTP/2接口实现iOS的高性能消息推送</h1><div class="PostItem-Footer"><span>Jack ...</span><span class="PostItem-FooterTitle">发表于即时通讯技...</span></div></div></a><button class="PagingButton PagingButton-Next" data-za-detail-view-path-module="Unknown" data-za-detail-view-path-module_name="推荐阅读" data-za-extra-module="{}"><svg width="40" height="40" viewBox="0 0 24 24" fill="#d3d3d3" class="Zi Zi--ArrowRight"><path fill-rule="evenodd" d="m13.248 12-4.025 3.78a.684.684 0 0 0 0 1.01.796.796 0 0 0 1.075 0l4.42-4.15a.867.867 0 0 0 0-1.28l-4.42-4.15a.796.796 0 0 0-1.075 0 .684.684 0 0 0 0 1.01L13.248 12Z" clip-rule="evenodd"></path></svg></button></ul></div></div></div></main><div role="complementary"><div class="CornerButtons"><div class="CornerAnimayedFlex CornerAnimayedFlex--hidden"><button data-tooltip="回到顶部" data-tooltip-position="left" data-tooltip-will-hide-on-click="true" aria-label="回到顶部" type="button" class="Button CornerButton Button--plain css-gdd4kf"><svg width="24" height="24" viewBox="0 0 24 24" aria-hidden="true" class="Zi Zi--BackToTop" fill="currentColor"><path fill-rule="evenodd" d="M13.204 3.107a1.75 1.75 0 0 0-2.408 0L3.806 9.73c-1.148 1.088-.378 3.02 1.204 3.02h2.24V20c0 .966.784 1.75 1.75 1.75h6A1.75 1.75 0 0 0 16.75 20v-7.25h2.24c1.582 0 2.353-1.932 1.204-3.02l-6.99-6.623Z" clip-rule="evenodd"></path></svg></button></div></div></div></div></div><script id="js-clientConfig" type="text/json">{"fetchRoot":{"www":"https:\u002F\u002Fwww.zhihu.com","api":"https:\u002F\u002Fapi.zhihu.com","lens":"https:\u002F\u002Flens.zhihu.com","zhuanlan":"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fapi\u002F","walletpay":"https:\u002F\u002Fwalletpay.zhihu.com","captcha":"https:\u002F\u002Fcaptcha.zhihu.com","vzuu":"https:\u002F\u002Fv.vzuu.com","openapi":"https:\u002F\u002Fopenapi.zhihu.com","svip":"https:\u002F\u002Fsvip.zhihu.com"},"host":"zhihu.com","protocol":"https:","wwwHost":"www.zhihu.com","videoHost":"video.zhihu.com","zhuanlanHost":"zhuanlan.zhihu.com","allowSignUp":true,"refreshValidityPeriod":"30","release":"721-49f562a5","currentEntry":"column","isMobileEntry":false,"apollo":{"env":"prod","globalSilence":"","topstory_rec_adp":"1","test_canary":"member|0-100,1-0","use_new_player":"member|0-50,1-50","player_vendor":"member|0-50,1-50,2-0","use_hevc":"member|0-0,1-100","upload_use_signature":"member|0-0,1-100","use_backdrop_blur":"member|0-70,1-30","article_title_imagex":"member|0-70,1-30","play_station":"member|0-0,1-100"}}</script><script id="js-initialData" type="text/json">{"initialState":{"common":{"ask":{}},"loading":{"global":{"count":0},"local":{"env\u002FgetIpinfo\u002F":false,"article\u002Fget\u002F":false,"brand\u002FgetUrl\u002F":false,"article\u002FloadPostSearchEntity\u002F":false}},"entities":{"users":{"c29982ea4958b35f1d733b99ef5bf579":{"uid":1454038455692562400,"userType":"people","id":"c29982ea4958b35f1d733b99ef5bf579"},"da-yu-er-2-87":{"isFollowed":false,"avatarUrlTemplate":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-e4dcbd4260da75dae5317ee45732f3ae.jpg?source=172ae18b","uid":"789766915831758848","userType":"people","isFollowing":false,"urlToken":"da-yu-er-2-87","id":"b3aa0b779f66d08c2f4be961e807a695","description":"","name":"CPP加油站","isAdvertiser":false,"headline":"","gender":-1,"url":"\u002Fpeople\u002Fb3aa0b779f66d08c2f4be961e807a695","avatarUrl":"https:\u002F\u002Fpica.zhimg.com\u002Fv2-e4dcbd4260da75dae5317ee45732f3ae_l.jpg?source=172ae18b","isOrg":false,"type":"people","vipInfo":{"isVip":true,"vipIcon":{"url":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-4812630bc27d642f7cafcd6cdeca3d7a.jpg?source=88ceefae","nightModeUrl":"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-c9686ff064ea3579730756ac6c289978.jpg?source=88ceefae"}},"badge":[],"badgeV2":{"title":"","mergedBadges":[],"detailBadges":[],"icon":"","nightIcon":""},"exposedMedal":{"medalId":"972477022068568064","medalName":"备受瞩目","avatarUrl":"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-29b2e882367bb1529bc1322f2dcda7ee_r.png?source=172ae18b","miniAvatarUrl":"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-29b2e882367bb1529bc1322f2dcda7ee_l.png?source=172ae18b","description":"被 10000 个人关注","medalAvatarFrame":""}}},"questions":{},"answers":{},"articles":{"141415216":{"trackUrl":["https:\u002F\u002Fsugar.zhihu.com\u002Fplutus_adreaper\u002Fcontent_monitor_log?si=__SESSIONID__&ti=__ATOKEN__&at=view&pf=__OS__&ed=BiBUKF0xBSkqGGpfBWh6CVx3AAGOF_uGOiPJ&idfa=__IDFA__&imei=__IMEI__&androidid=__ANDROIDID__&oaid=__OAID__&ci=__CREATIVEID__&zid=__ZONEID__"],"entityWords":[{"name":"数据访问类","mention":"数据访问类","matchorder":1,"begin":9168,"end":9173,"entityid":0,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Computer","score":0,"attachedInfoBytes":"sgJbCg\u002FmlbDmja7orr\u002Fpl67nsbsSCENvbXB1dGVyGNBHINVHKAE1AAAAADoHYXJ0aWNsZUAASABSJDYzNzE0ZjU3LWY2YzItNGI1NS05NWUwLWFmN2U1MDJjOTFjZA==","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"数据交换格式","mention":"数据交换格式","matchorder":1,"begin":651,"end":657,"entityid":0,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Computer","score":0,"attachedInfoBytes":"sgJeChLmlbDmja7kuqTmjaLmoLzlvI8SCENvbXB1dGVyGIsFIJEFKAE1AAAAADoHYXJ0aWNsZUAASABSJDYzNzE0ZjU3LWY2YzItNGI1NS05NWUwLWFmN2U1MDJjOTFjZA==","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"thrift-protobuf-compare","mention":"thrift-protobuf-compare","matchorder":1,"begin":7697,"end":7720,"entityid":0,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Medical","score":0,"attachedInfoBytes":"sgJiChd0aHJpZnQtcHJvdG9idWYtY29tcGFyZRIHTWVkaWNhbBiRPCCoPCgBNQAAAAA6B2FydGljbGVAAEgAUiQ2MzcxNGY1Ny1mNmMyLTRiNTUtOTVlMC1hZjdlNTAyYzkxY2Q=","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"varchar","mention":"varchar","matchorder":1,"begin":14289,"end":14296,"entityid":0,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"OtherTerm","score":0,"attachedInfoBytes":"sgJUCgd2YXJjaGFyEglPdGhlclRlcm0Y0W8g2G8oATUAAAAAOgdhcnRpY2xlQABIAFIkNjM3MTRmNTctZjZjMi00YjU1LTk1ZTAtYWY3ZTUwMmM5MWNk","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"持续数据存储系统","mention":"持续数据存储系统","matchorder":1,"begin":562,"end":570,"entityid":0,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"OtherTerm","score":0,"attachedInfoBytes":"sgJlChjmjIHnu63mlbDmja7lrZjlgqjns7vnu58SCU90aGVyVGVybRiyBCC6BCgBNQAAAAA6B2FydGljbGVAAEgAUiQ2MzcxNGY1Ny1mNmMyLTRiNTUtOTVlMC1hZjdlNTAyYzkxY2Q=","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"socket","mention":"socket","matchorder":1,"begin":7380,"end":7386,"entityid":0,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Commodity","score":0,"attachedInfoBytes":"sgJTCgZzb2NrZXQSCUNvbW1vZGl0eRjUOSDaOSgBNQAAAAA6B2FydGljbGVAAEgAUiQ2MzcxNGY1Ny1mNmMyLTRiNTUtOTVlMC1hZjdlNTAyYzkxY2Q=","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"little-endian","mention":"little-endian","matchorder":1,"begin":11042,"end":11055,"entityid":0,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"OtherTerm","score":0,"attachedInfoBytes":"sgJaCg1saXR0bGUtZW5kaWFuEglPdGhlclRlcm0YolYgr1YoATUAAAAAOgdhcnRpY2xlQABIAFIkNjM3MTRmNTctZjZjMi00YjU1LTk1ZTAtYWY3ZTUwMmM5MWNk","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"webrtc","mention":"webrtc","matchorder":1,"begin":16815,"end":16821,"entityid":0,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Food","score":0,"attachedInfoBytes":"sgJQCgZ3ZWJydGMSBEZvb2QYr4MBILWDASgBNQAAAAA6B2FydGljbGVAAEgAUiQ2MzcxNGY1Ny1mNmMyLTRiNTUtOTVlMC1hZjdlNTAyYzkxY2Q=","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"sint32","mention":"sint32","matchorder":1,"begin":13474,"end":13480,"entityid":0,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"OtherTerm","score":0,"attachedInfoBytes":"sgJTCgZzaW50MzISCU90aGVyVGVybRiiaSCoaSgBNQAAAAA6B2FydGljbGVAAEgAUiQ2MzcxNGY1Ny1mNmMyLTRiNTUtOTVlMC1hZjdlNTAyYzkxY2Q=","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""}],"id":141415216,"title":"Protobuf通信协议详解：代码演示、详细原理介绍等","type":"article","articleType":"normal","excerptTitle":"","url":"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F141415216","imageUrl":"","titleImage":"","excerpt":"\u003Cimg src=\"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-e45f1acff3303fc79ea4bf25209bd1d7_200x112.jpeg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"447\" data-rawheight=\"423\" data-watermark=\"watermark\" data-original-src=\"v2-e45f1acff3303fc79ea4bf25209bd1d7\" data-watermark-src=\"v2-9365d322fd44d415c9ba9bf26721a281\" data-private-watermark-src=\"\" class=\"origin_image inline-img zh-lightbox-thumb\" data-original=\"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-e45f1acff3303fc79ea4bf25209bd1d7_r.jpeg\"\u002F\u003E1、概述1.1前言 在移动互联网时代，手机流量、电量是最为有限的资源，而移动端的即时通讯应用无疑必须得直面这两点。 解决流量过大的基本方法就是使用高度压缩的通信协议，而数据压缩后流量减小带来的自然结果也就是省电：因为大数据量的传输必然需要更久的…","created":1589619220,"updated":1642844372,"author":{"isFollowed":false,"avatarUrlTemplate":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-e4dcbd4260da75dae5317ee45732f3ae.jpg?source=172ae18b","uid":"789766915831758848","userType":"people","isFollowing":false,"urlToken":"da-yu-er-2-87","id":"b3aa0b779f66d08c2f4be961e807a695","description":"","name":"CPP加油站","isAdvertiser":false,"headline":"","gender":-1,"url":"\u002Fpeople\u002Fb3aa0b779f66d08c2f4be961e807a695","avatarUrl":"https:\u002F\u002Fpica.zhimg.com\u002Fv2-e4dcbd4260da75dae5317ee45732f3ae_l.jpg?source=172ae18b","isOrg":false,"type":"people","vipInfo":{"isVip":true,"vipIcon":{"url":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-4812630bc27d642f7cafcd6cdeca3d7a.jpg?source=88ceefae","nightModeUrl":"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-c9686ff064ea3579730756ac6c289978.jpg?source=88ceefae"}},"badge":[],"badgeV2":{"title":"","mergedBadges":[],"detailBadges":[],"icon":"","nightIcon":""},"exposedMedal":{"medalId":"972477022068568064","medalName":"备受瞩目","avatarUrl":"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-29b2e882367bb1529bc1322f2dcda7ee_r.png?source=172ae18b","miniAvatarUrl":"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-29b2e882367bb1529bc1322f2dcda7ee_l.png?source=172ae18b","description":"被 10000 个人关注","medalAvatarFrame":""}},"commentPermission":"all","copyrightPermission":"need_review","state":"published","ipInfo":"","imageWidth":0,"imageHeight":0,"content":"\u003Ch2\u003E1、概述\u003C\u002Fh2\u003E\u003Ch3\u003E1.1前言\u003C\u002Fh3\u003E\u003Cp data-pid=\"gjSDLeAs\"\u003E\u003Cbr\u002F\u003E在移动互联网时代，手机流量、电量是最为有限的资源，而移动端的即时通讯应用无疑必须得直面这两点。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E解决流量过大的基本方法就是使用高度压缩的通信协议，而数据压缩后流量减小带来的自然结果也就是省电：因为大数据量的传输必然需要更久的网络操作、数据序列化及反序列化操作，这些都是电量消耗过快的根源。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E当前即时通讯应用中最热门的通信协议无疑就是Google的Protobuf了，基于它的优秀表现，微信和手机QQ这样的主流IM应用也早已在使用它。本文将详细介绍Protobuf的使用、原理等。\u003Cbr\u002F\u003E\u003C\u002Fp\u003E\u003Ch3\u003E1.3Protobuf简介\u003C\u002Fh3\u003E\u003Cp data-pid=\"H-osbd2z\"\u003E\u003Cbr\u002F\u003E\u003Cb\u003E什么是 Google Protocol Buffer？ 假如您在网上搜索，应该会得到类似这样的文字介绍：\u003C\u002Fb\u003E\u003Cbr\u002F\u003E\u003Cbr\u002F\u003EGoogle Protocol Buffer( 简称 Protobuf) 是 Google 公司内部的混合语言数据标准，目前已经正在使用的有超过 48,162 种报文格式定义和超过 12,183 个 .proto 文件。他们用于 RPC 系统和持续数据存储系统。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003EProtocol Buffers 是一种轻便高效的结构化数据存储格式，可以用于结构化数据串行化，或者说序列化。它很适合做数据存储或 RPC 数据交换格式。可用于通讯协议、数据存储等领域的语言无关、平台无关、可扩展的序列化结构数据格式。目前提供了 C++、Java、Python 三种语言的 API（即时通讯网注：Protobuf官方工程主页上显示的已支持的开发语言多达10种，分别有：C++、Java、Python、Objective-C、C#、JavaNano、JavaScript、Ruby、Go、PHP，基本上主流的语言都已支持，详见工程主页：\u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=https%3A\u002F\u002Fgithub.com\u002F52im\u002Fprotobuf\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003E\u003Cspan class=\"invisible\"\u003Ehttps:\u002F\u002F\u003C\u002Fspan\u003E\u003Cspan class=\"visible\"\u003Egithub.com\u002F52im\u002Fprotobu\u003C\u002Fspan\u003E\u003Cspan class=\"invisible\"\u003Ef\u003C\u002Fspan\u003E\u003Cspan class=\"ellipsis\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003E）。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E\u003C\u002Fp\u003E\u003Cp class=\"ztext-empty-paragraph\"\u003E\u003Cbr\u002F\u003E\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-9365d322fd44d415c9ba9bf26721a281_b.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"447\" data-rawheight=\"423\" class=\"origin_image zh-lightbox-thumb\" width=\"447\" data-original=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-9365d322fd44d415c9ba9bf26721a281_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;447&#39; height=&#39;423&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"447\" data-rawheight=\"423\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"447\" data-original=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-9365d322fd44d415c9ba9bf26721a281_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-9365d322fd44d415c9ba9bf26721a281_b.jpg\" data-original-token=\"v2-e45f1acff3303fc79ea4bf25209bd1d7\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp class=\"ztext-empty-paragraph\"\u003E\u003Cbr\u002F\u003E\u003C\u002Fp\u003E\u003Cp data-pid=\"jsMJ_9N1\"\u003E\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E或许您和我一样，在第一次看完这些介绍后还是不明白 Protobuf 究竟是什么，那么我想一个简单的例子应该比较有助于理解它。\u003Cbr\u002F\u003E\u003C\u002Fp\u003E\u003Ch2\u003E2、一个简单的例子\u003C\u002Fh2\u003E\u003Cp class=\"ztext-empty-paragraph\"\u003E\u003Cbr\u002F\u003E\u003C\u002Fp\u003E\u003Ch3\u003E2.1安装 Google Protocol Buffer\u003C\u002Fh3\u003E\u003Cp data-pid=\"oW1C723D\"\u003E\u003Cbr\u002F\u003E在网站 \u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=https%3A\u002F\u002Fgithub.com\u002F52im\u002Fprotobuf\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003E\u003Cspan class=\"invisible\"\u003Ehttps:\u002F\u002F\u003C\u002Fspan\u003E\u003Cspan class=\"visible\"\u003Egithub.com\u002F52im\u002Fprotobu\u003C\u002Fspan\u003E\u003Cspan class=\"invisible\"\u003Ef\u003C\u002Fspan\u003E\u003Cspan class=\"ellipsis\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003E 上可以下载 Protobuf 的源代码。然后解压编译安装便可以使用它了。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E\u003Cb\u003E安装步骤如下所示：\u003C\u002Fb\u003E\u003Cbr\u002F\u003E\u003C\u002Fp\u003E\u003Cp class=\"ztext-empty-paragraph\"\u003E\u003Cbr\u002F\u003E\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-text\"\u003Etar -xzf protobuf-2.1.0.tar.gz\ncd protobuf-2.1.0\n.\u002Fconfigure --prefix=$INSTALL_DIR\nmake\nmake check\nmake install\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp class=\"ztext-empty-paragraph\"\u003E\u003Cbr\u002F\u003E\u003C\u002Fp\u003E\u003Ch3\u003E2.2关于简单例子的描述\u003C\u002Fh3\u003E\u003Cp data-pid=\"WKiGC9ix\"\u003E\u003Cbr\u002F\u003E我打算使用 Protobuf 和 C++ 开发一个十分简单的例子程序。该程序由两部分组成。第一部分被称为 Writer，第二部分叫做 Reader。Writer 负责将一些结构化的数据写入一个磁盘文件，Reader 则负责从该磁盘文件中读取结构化数据并打印到屏幕上。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E\u003Cb\u003E准备用于演示的结构化数据是 HelloWorld，它包含两个基本数据：\u003C\u002Fb\u003E\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli data-pid=\"Qlc01-qk\"\u003EID，为一个整数类型的数据\u003C\u002Fli\u003E\u003Cli data-pid=\"8JfedKgS\"\u003EStr，这是一个字符串\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp class=\"ztext-empty-paragraph\"\u003E\u003Cbr\u002F\u003E\u003C\u002Fp\u003E\u003Ch3\u003E2.3书写 .proto 文件\u003C\u002Fh3\u003E\u003Cp data-pid=\"jkeGO1na\"\u003E\u003Cbr\u002F\u003E首先我们需要编写一个 proto 文件，定义我们程序中需要处理的结构化数据，在 protobuf 的术语中，结构化数据被称为 Message。proto 文件非常类似 java 或者 C 语言的数据定义。代码清单 1 显示了例子应用中的 proto 文件内容。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E\u003Cb\u003E清单 1. proto 文件：\u003C\u002Fb\u003E\u003Cbr\u002F\u003E\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-text\"\u003Epackage lm;\nmessage helloworld\n{\n   required int32     id = 1;  \u002F\u002F ID\n   required string    str = 2;  \u002F\u002F str\n   optional int32     opt = 3;  \u002F\u002Foptional field\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp data-pid=\"nRL7UL-G\"\u003E\u003Cbr\u002F\u003E\u003Cb\u003E一个比较好的习惯是认真对待 proto 文件的文件名。比如将命名规则定于如下：\u003C\u002Fb\u003E\u003Cbr\u002F\u003E\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-text\"\u003EpackageName.MessageName.proto\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp data-pid=\"1tEPb2NQ\"\u003E\u003Cbr\u002F\u003E在上例中，package 名字叫做 lm，定义了一个消息 helloworld，该消息有三个成员，类型为 int32 的 id，另一个为类型为 string 的成员 str。opt 是一个可选的成员，即消息中可以不包含该成员。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E\u003C\u002Fp\u003E\u003Ch3\u003E2.4编译 .proto 文件\u003C\u002Fh3\u003E\u003Cp data-pid=\"v-gbd94k\"\u003E\u003Cbr\u002F\u003E写好 proto 文件之后就可以用 Protobuf 编译器将该文件编译成目标语言了。本例中我们将使用 C++。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E\u003Cb\u003E假设您的 proto 文件存放在 $SRC_DIR 下面，您也想把生成的文件放在同一个目录下，则可以使用如下命令：\u003C\u002Fb\u003E\u003Cbr\u002F\u003E\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-text\"\u003Eprotoc -I=$SRC_DIR --cpp_out=$DST_DIR $SRC_DIR\u002Faddressbook.proto\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp data-pid=\"g3lC2lqr\"\u003E\u003Cbr\u002F\u003E\u003Cb\u003E命令将生成两个文件：\u003C\u002Fb\u003E\u003Cbr\u002F\u003E\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli data-pid=\"sikl6uiU\"\u003Elm.helloworld.pb.h ， 定义了 C++ 类的头文件\u003C\u002Fli\u003E\u003Cli data-pid=\"1uRxo63j\"\u003E\u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=http%3A\u002F\u002Flm.helloworld.pb.cc\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003E\u003Cspan class=\"invisible\"\u003Ehttp:\u002F\u002F\u003C\u002Fspan\u003E\u003Cspan class=\"visible\"\u003Elm.helloworld.pb.cc\u003C\u002Fspan\u003E\u003Cspan class=\"invisible\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003E ， C++ 类的实现文件\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp data-pid=\"8iumMqL4\"\u003E\u003Cbr\u002F\u003E在生成的头文件中，定义了一个 C++ 类 helloworld，后面的 Writer 和 Reader 将使用这个类来对消息进行操作。诸如对消息的成员进行赋值，将消息序列化等等都有相应的方法。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E\u003C\u002Fp\u003E\u003Ch3\u003E2.5编写 writer 和 Reader\u003C\u002Fh3\u003E\u003Cp data-pid=\"DF8-BbIX\"\u003E\u003Cbr\u002F\u003E如前所述，Writer 将把一个结构化数据写入磁盘，以便其他人来读取。假如我们不使用 Protobuf，其实也有许多的选择。一个可能的方法是将数据转换为字符串，然后将字符串写入磁盘。转换为字符串的方法可以使用 sprintf()，这非常简单。数字 123 可以变成字符串”123”。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E这样做似乎没有什么不妥，但是仔细考虑一下就会发现，这样的做法对写 Reader 的那个人的要求比较高，Reader 的作者必须了 Writer 的细节。比如”123”可以是单个数字 123，但也可以是三个数字 1,2 和 3，等等。这么说来，我们还必须让 Writer 定义一种分隔符一样的字符，以便 Reader 可以正确读取。但分隔符也许还会引起其他的什么问题。最后我们发现一个简单的 Helloworld 也需要写许多处理消息格式的代码。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E如果使用 Protobuf，那么这些细节就可以不需要应用程序来考虑了。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E使用 Protobuf，Writer 的工作很简单，需要处理的结构化数据由 .proto 文件描述，经过上一节中的编译过程后，该数据化结构对应了一个 C++ 的类，并定义在 lm.helloworld.pb.h 中。对于本例，类名为 lm::helloworld。Writer 需要 include 该头文件，然后便可以使用这个类了。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E现在，在 Writer 代码中，将要存入磁盘的结构化数据由一个 lm::helloworld 类的对象表示，它提供了一系列的 get\u002Fset 函数用来修改和读取结构化数据中的数据成员，或者叫 field。当我们需要将该结构化数据保存到磁盘上时，类 lm::helloworld 已经提供相应的方法来把一个复杂的数据变成一个字节序列，我们可以将这个字节序列写入磁盘。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E对于想要读取这个数据的程序来说，也只需要使用类 lm::helloworld 的相应反序列化方法来将这个字节序列重新转换会结构化数据。这同我们开始时那个“123”的想法类似，不过 Protobuf 想的远远比我们那个粗糙的字符串转换要全面，因此，我们不如放心将这类事情交给 Protobuf 吧。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E程序清单 2 演示了 Writer 的主要代码，您一定会觉得很简单吧？\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E\u003Cb\u003E清单 2. Writer 的主要代码：\u003C\u002Fb\u003E\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-text\"\u003E#include &#34;lm.helloworld.pb.h&#34;\n…\n \n int main(void)\n {\n   \n  lm::helloworld msg1;\n  msg1.set_id(101);\n  msg1.set_str(“hello”);\n     \n  \u002F\u002F Write the new address book back to disk.\n  fstream output(&#34;.\u002Flog&#34;, ios::out | ios::trunc | ios::binary);\n         \n  if (!msg1.SerializeToOstream(&amp;output)) {\n      cerr &lt;&lt; &#34;Failed to write msg.&#34; &lt;&lt; endl;\n      return -1;\n  }        \n  return 0;\n }\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp data-pid=\"S57j9-yA\"\u003E\u003Cbr\u002F\u003EMsg1 是一个 helloworld 类的对象，set_id() 用来设置 id 的值。SerializeToOstream 将对象序列化后写入一个 fstream 流。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E代码清单 3 列出了 reader 的主要代码。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E\u003Cb\u003E清单 3. Reader：\u003C\u002Fb\u003E\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-text\"\u003E#include &#34;lm.helloworld.pb.h&#34;\n…\n void ListMsg(const lm::helloworld &amp; msg) {\n  cout &lt;&lt; msg.id() &lt;&lt; endl;\n  cout &lt;&lt; msg.str() &lt;&lt; endl;\n }\n  \n int main(int argc, char* argv[]) {\n \n  lm::helloworld msg1;\n  \n  {\n    fstream input(&#34;.\u002Flog&#34;, ios::in | ios::binary);\n    if (!msg1.ParseFromIstream(&amp;input)) {\n      cerr &lt;&lt; &#34;Failed to parse address book.&#34; &lt;&lt; endl;\n      return -1;\n    }\n  }\n  \n  ListMsg(msg1);\n  …\n }\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp data-pid=\"L5Lq6H5y\"\u003E\u003Cbr\u002F\u003E同样，Reader 声明类 helloworld 的对象 msg1，然后利用 ParseFromIstream 从一个 fstream 流中读取信息并反序列化。此后，ListMsg 中采用 get 方法读取消息的内部信息，并进行打印输出操作。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E\u003C\u002Fp\u003E\u003Ch3\u003E2.6运行结果\u003C\u002Fh3\u003E\u003Cp data-pid=\"H0C5ivF-\"\u003E\u003Cbr\u002F\u003E\u003Cb\u003E运行 Writer 和 Reader 的结果如下：\u003C\u002Fb\u003E\u003Cbr\u002F\u003E\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-text\"\u003E&gt;writer\n&gt;reader\n101\nHello\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp data-pid=\"5aPh3JN9\"\u003E\u003Cbr\u002F\u003EReader 读取文件 log 中的序列化信息并打印到屏幕上。本文中所有的例子代码都可以在附件中下载。您可以亲身体验一下。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E这个例子本身并无意义，但只要您稍加修改就可以将它变成更加有用的程序。比如将磁盘替换为网络 socket，那么就可以实现基于网络的数据交换任务。而存储和交换正是 Protobuf 最有效的应用领域。\u003Cbr\u002F\u003E\u003C\u002Fp\u003E\u003Ch2\u003E3、和其他类似技术的比较\u003C\u002Fh2\u003E\u003Cp class=\"ztext-empty-paragraph\"\u003E\u003Cbr\u002F\u003E\u003C\u002Fp\u003E\u003Ch3\u003E3.1简述\u003C\u002Fh3\u003E\u003Cp data-pid=\"FYeWEOxw\"\u003E\u003Cbr\u002F\u003E看完这个简单的例子之后，希望您已经能理解 Protobuf 能做什么了，那么您可能会说，世上还有很多其他的类似技术啊，比如 XML，JSON，Thrift 等等。和他们相比，Protobuf 有什么不同呢？\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E简单说来 Protobuf 的主要优点就是：简单，快。这有测试为证，项目 thrift-protobuf-compare 比较了这些类似的技术，图 1 显示了该项目的一项测试结果，Total Time.\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E\u003Cb\u003E图 1. 性能测试结果：\u003C\u002Fb\u003E\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E\u003C\u002Fp\u003E\u003Cp class=\"ztext-empty-paragraph\"\u003E\u003Cbr\u002F\u003E\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-7ca967e21e3bd8c063d63108094c8076_b.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"600\" data-rawheight=\"374\" class=\"origin_image zh-lightbox-thumb\" width=\"600\" data-original=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-7ca967e21e3bd8c063d63108094c8076_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;600&#39; height=&#39;374&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"600\" data-rawheight=\"374\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"600\" data-original=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-7ca967e21e3bd8c063d63108094c8076_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-7ca967e21e3bd8c063d63108094c8076_b.jpg\" data-original-token=\"v2-7ac91a9c2b7844e874dbf1ad6b61511a\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp class=\"ztext-empty-paragraph\"\u003E\u003Cbr\u002F\u003E\u003C\u002Fp\u003E\u003Cp data-pid=\"-qI4eV6o\"\u003E\u003Cbr\u002F\u003E\u003Cbr\u002F\u003ETotal Time 指一个对象操作的整个时间，包括创建对象，将对象序列化为内存中的字节序列，然后再反序列化的整个过程。从测试结果可以看到 Protobuf 的成绩很好，感兴趣的读者可以自行到网站 \u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=https%3A\u002F\u002Fgithub.com\u002Feishay\u002Fjvm-serializers\u002Fwiki\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003E\u003Cspan class=\"invisible\"\u003Ehttps:\u002F\u002F\u003C\u002Fspan\u003E\u003Cspan class=\"visible\"\u003Egithub.com\u002Feishay\u002Fjvm-s\u003C\u002Fspan\u003E\u003Cspan class=\"invisible\"\u003Eerializers\u002Fwiki\u003C\u002Fspan\u003E\u003Cspan class=\"ellipsis\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003E上了解更详细的测试结果。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E\u003C\u002Fp\u003E\u003Ch3\u003E3.2Protobuf 的优点\u003C\u002Fh3\u003E\u003Cp data-pid=\"4r-qxmQ5\"\u003E\u003Cbr\u002F\u003EProtobuf 有如 XML，不过它更小、更快、也更简单。你可以定义自己的数据结构，然后使用代码生成器生成的代码来读写这个数据结构。你甚至可以在无需重新部署程序的情况下更新数据结构。只需使用 Protobuf 对数据结构进行一次描述，即可利用各种不同语言或从各种不同数据流中对你的结构化数据轻松读写。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E它有一个非常棒的特性，即“向后”兼容性好，人们不必破坏已部署的、依靠“老”数据格式的程序就可以对数据结构进行升级。这样您的程序就可以不必担心因为消息结构的改变而造成的大规模的代码重构或者迁移的问题。因为添加新的消息中的 field 并不会引起已经发布的程序的任何改变。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003EProtobuf 语义更清晰，无需类似 XML 解析器的东西（因为 Protobuf 编译器会将 .proto 文件编译生成对应的数据访问类以对 Protobuf 数据进行序列化、反序列化操作）。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E使用 Protobuf 无需学习复杂的文档对象模型，Protobuf 的编程模式比较友好，简单易学，同时它拥有良好的文档和示例，对于喜欢简单事物的人们而言，Protobuf 比其他的技术更加有吸引力。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E\u003C\u002Fp\u003E\u003Ch3\u003E3.3Protobuf 的不足\u003C\u002Fh3\u003E\u003Cp data-pid=\"dlh00AH0\"\u003E\u003Cbr\u002F\u003EProtbuf 与 XML 相比也有不足之处。它功能简单，无法用来表示复杂的概念。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003EXML 已经成为多种行业标准的编写工具，Protobuf 只是 Google 公司内部使用的工具，在通用性上还差很多。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E由于文本并不适合用来描述数据结构，所以 Protobuf 也不适合用来对基于文本的标记文档（如 HTML）建模。另外，由于 XML 具有某种程度上的自解释性，它可以被人直接读取编辑，在这一点上 Protobuf 不行，它以二进制的方式存储，除非你有 .proto 定义，否则你没法直接读出 Protobuf 的任何内容【 2 】。\u003Cbr\u002F\u003E\u003C\u002Fp\u003E\u003Ch2\u003E4、Protobuf 的更多细节\u003C\u002Fh2\u003E\u003Cp class=\"ztext-empty-paragraph\"\u003E\u003Cbr\u002F\u003E\u003C\u002Fp\u003E\u003Ch3\u003E4.1简述\u003C\u002Fh3\u003E\u003Cp data-pid=\"yQrlSIDo\"\u003E\u003Cbr\u002F\u003E人们一直在强调，同 XML 相比， Protobuf 的主要优点在于性能高。它以高效的二进制方式存储，比 XML 小 3 到 10 倍，快 20 到 100 倍。对于这些 “小 3 到 10 倍”,“快 20 到 100 倍”的说法，严肃的程序员需要一个解释。因此在本文的最后，让我们稍微深入 Protobuf 的内部实现吧。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E\u003Cb\u003E有两项技术保证了采用 Protobuf 的程序能获得相对于 XML 极大的性能提高：\u003C\u002Fb\u003E\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli data-pid=\"JwCw6FTx\"\u003E第一点：我们可以考察 Protobuf 序列化后的信息内容。您可以看到 Protocol Buffer 信息的表示非常紧凑，这意味着消息的体积减少，自然需要更少的资源。比如网络上传输的字节数更少，需要的 IO 更少等，从而提高性能。\u003C\u002Fli\u003E\u003Cli data-pid=\"kmA1enAm\"\u003E第二点：我们需要理解 Protobuf 封解包的大致过程，从而理解为什么会比 XML 快很多。\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp class=\"ztext-empty-paragraph\"\u003E\u003Cbr\u002F\u003E\u003C\u002Fp\u003E\u003Ch3\u003E4.2Google Protocol Buffer 的 Encoding\u003C\u002Fh3\u003E\u003Cp data-pid=\"whFYBnqb\"\u003E\u003Cbr\u002F\u003EProtobuf 序列化后所生成的二进制消息非常紧凑，这得益于 Protobuf 采用的非常巧妙的 Encoding 方法。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E考察消息结构之前，让我首先要介绍一个叫做 Varint 的术语。Varint 是一种紧凑的表示数字的方法。它用一个或多个字节来表示一个数字，值越小的数字使用越少的字节数。这能减少用来表示数字的字节数。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E比如对于 int32 类型的数字，一般需要 4 个 byte 来表示。但是采用 Varint，对于很小的 int32 类型的数字，则可以用 1 个 byte 来表示。当然凡事都有好的也有不好的一面，采用 Varint 表示法，大的数字则需要 5 个 byte 来表示。从统计的角度来说，一般不会所有的消息中的数字都是大数，因此大多数情况下，采用 Varint 后，可以用更少的字节数来表示数字信息。下面就详细介绍一下 Varint。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003EVarint 中的每个 byte 的最高位 bit 有特殊的含义，如果该位为 1，表示后续的 byte 也是该数字的一部分，如果该位为 0，则结束。其他的 7 个 bit 都用来表示数字。因此小于 128 的数字都可以用一个 byte 表示。大于 128 的数字，比如 300，会用两个字节来表示：1010 1100 0000 0010。下图演示了 Google Protocol Buffer 如何解析两个 bytes。注意到最终计算前将两个 byte 的位置相互交换过一次，这是因为 Google Protocol Buffer 字节序采用 little-endian 的方式。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E\u003Cb\u003E图 6. Varint 编码：\u003C\u002Fb\u003E\u003Cbr\u002F\u003E\u003C\u002Fp\u003E\u003Cp class=\"ztext-empty-paragraph\"\u003E\u003Cbr\u002F\u003E\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-1d652e0b45bcbba589442cb501a58e30_b.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"320\" data-rawheight=\"190\" class=\"content_image\" width=\"320\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;320&#39; height=&#39;190&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"320\" data-rawheight=\"190\" class=\"content_image lazy\" width=\"320\" data-actualsrc=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-1d652e0b45bcbba589442cb501a58e30_b.jpg\" data-original-token=\"v2-102cf464326c1aa4651a5f010955c5b2\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp class=\"ztext-empty-paragraph\"\u003E\u003Cbr\u002F\u003E\u003C\u002Fp\u003E\u003Cp data-pid=\"6EuFj0Ru\"\u003E\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E消息经过序列化后会成为一个二进制数据流，该流中的数据为一系列的 Key-Value 对。如下图所示。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E\u003Cb\u003E图 7. Message Buffer：\u003C\u002Fb\u003E\u003Cbr\u002F\u003E\u003C\u002Fp\u003E\u003Cp class=\"ztext-empty-paragraph\"\u003E\u003Cbr\u002F\u003E\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-8088e647c0b394688f40f242207089c9_b.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"450\" data-rawheight=\"160\" class=\"origin_image zh-lightbox-thumb\" width=\"450\" data-original=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-8088e647c0b394688f40f242207089c9_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;450&#39; height=&#39;160&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"450\" data-rawheight=\"160\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"450\" data-original=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-8088e647c0b394688f40f242207089c9_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-8088e647c0b394688f40f242207089c9_b.jpg\" data-original-token=\"v2-f0aff06977121a61e3902a511ecd2f6f\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp class=\"ztext-empty-paragraph\"\u003E\u003Cbr\u002F\u003E\u003C\u002Fp\u003E\u003Cp data-pid=\"C9m4ws_j\"\u003E\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E采用这种 Key-Pair 结构无需使用分隔符来分割不同的 Field。对于可选的 Field，如果消息中不存在该 field，那么在最终的 Message Buffer 中就没有该 field，这些特性都有助于节约消息本身的大小。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E\u003Cb\u003E以代码清单 1 中的消息为例。假设我们生成如下的一个消息 Test1:\u003C\u002Fb\u003E\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-text\"\u003ETest1.id = 10;\nTest1.str = “hello”；\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp data-pid=\"X4SWVxTL\"\u003E\u003Cbr\u002F\u003E则最终的 Message Buffer 中有两个 Key-Value 对，一个对应消息中的 id；另一个对应 str。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003EKey 用来标识具体的 field，在解包的时候，Protocol Buffer 根据 Key 就可以知道相应的 Value 应该对应于消息中的哪一个 field。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E\u003Cb\u003EKey 的定义如下：\u003C\u002Fb\u003E\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-text\"\u003E(field_number &lt;&lt; 3) | wire_type\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp data-pid=\"b1RIpaaS\"\u003E\u003Cbr\u002F\u003E可以看到 Key 由两部分组成。第一部分是 field_number，比如消息 lm.helloworld 中 field id 的 field_number 为 1。第二部分为 wire_type。表示 Value 的传输类型。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E\u003Cb\u003EWire Type 可能的类型如下表所示：\u003C\u002Fb\u003E\u003Cbr\u002F\u003E\u003C\u002Fp\u003E\u003Cp class=\"ztext-empty-paragraph\"\u003E\u003Cbr\u002F\u003E\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-45ad6dce26d5101def5a9cbad312e0d1_b.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"777\" data-rawheight=\"214\" class=\"origin_image zh-lightbox-thumb\" width=\"777\" data-original=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-45ad6dce26d5101def5a9cbad312e0d1_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;777&#39; height=&#39;214&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"777\" data-rawheight=\"214\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"777\" data-original=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-45ad6dce26d5101def5a9cbad312e0d1_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-45ad6dce26d5101def5a9cbad312e0d1_b.jpg\" data-original-token=\"v2-25834ec0f6666dfd686040615a5975f4\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp class=\"ztext-empty-paragraph\"\u003E\u003Cbr\u002F\u003E\u003C\u002Fp\u003E\u003Cp data-pid=\"xab_k271\"\u003E\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E在我们的例子当中，field id 所采用的数据类型为 int32，因此对应的 wire type 为 0。细心的读者或许会看到在 Type 0 所能表示的数据类型中有 int32 和 sint32 这两个非常类似的数据类型。Google Protocol Buffer 区别它们的主要意图也是为了减少 encoding 后的字节数。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E在计算机内，一个负数一般会被表示为一个很大的整数，因为计算机定义负数的符号位为数字的最高位。如果采用 Varint 表示一个负数，那么一定需要 5 个 byte。为此 Google Protocol Buffer 定义了 sint32 这种类型，采用 zigzag 编码。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003EZigzag 编码用无符号数来表示有符号数字，正数和负数交错，这就是 zigzag 这个词的含义了。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E\u003Cb\u003E图 8. ZigZag 编码：\u003C\u002Fb\u003E\u003Cbr\u002F\u003E\u003C\u002Fp\u003E\u003Cp class=\"ztext-empty-paragraph\"\u003E\u003Cbr\u002F\u003E\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-c08cfe889b27a2efd8594d71053fe7b0_b.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"366\" data-rawheight=\"220\" class=\"content_image\" width=\"366\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;366&#39; height=&#39;220&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"366\" data-rawheight=\"220\" class=\"content_image lazy\" width=\"366\" data-actualsrc=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-c08cfe889b27a2efd8594d71053fe7b0_b.jpg\" data-original-token=\"v2-839bde0dc3784f048cb84e16fe862c0e\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp class=\"ztext-empty-paragraph\"\u003E\u003Cbr\u002F\u003E\u003C\u002Fp\u003E\u003Cp data-pid=\"IzFkBety\"\u003E\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E使用 zigzag 编码，绝对值小的数字，无论正负都可以采用较少的 byte 来表示，充分利用了 Varint 这种技术。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E其他的数据类型，比如字符串等则采用类似数据库中的 varchar 的表示方法，即用一个 varint 表示长度，然后将其余部分紧跟在这个长度部分之后即可。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E通过以上对 protobuf Encoding 方法的介绍，想必您也已经发现 protobuf 消息的内容小，适于网络传输。假如您对那些有关技术细节的描述缺乏耐心和兴趣，那么下面这个简单而直观的比较应该能给您更加深刻的印象。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E\u003Cb\u003E对于代码清单 1 中的消息，用 Protobuf 序列化后的字节序列为：\u003C\u002Fb\u003E\u003Cbr\u002F\u003E\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-text\"\u003E08 65 12 06 48 65 6C 6C 6F 77\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp data-pid=\"rV7gHJWd\"\u003E\u003Cbr\u002F\u003E\u003Cb\u003E而如果用 XML，则类似这样：\u003C\u002Fb\u003E\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-text\"\u003E31 30 31 3C 2F 69 64 3E 3C 6E 61 6D 65 3E 68 65\n6C 6C 6F 3C 2F 6E 61 6D 65 3E 3C 2F 68 65 6C 6C\n6F 77 6F 72 6C 64 3E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp data-pid=\"7KkZ7ZMd\"\u003E\u003Cbr\u002F\u003E\u003Cb\u003E一共 55 个字节，这些奇怪的数字需要稍微解释一下，其含义用 ASCII 表示如下：\u003C\u002Fb\u003E\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-text\"\u003E&lt;helloworld&gt;\n   &lt;id&gt;101&lt;\u002Fid&gt;\n   &lt;name&gt;hello&lt;\u002Fname&gt;\n&lt;\u002Fhelloworld&gt;\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp class=\"ztext-empty-paragraph\"\u003E\u003Cbr\u002F\u003E\u003C\u002Fp\u003E\u003Ch3\u003E4.3封解包的速度\u003C\u002Fh3\u003E\u003Cp data-pid=\"eIGBCO1K\"\u003E\u003Cbr\u002F\u003E首先我们来了解一下 XML 的封解包过程。XML 需要从文件中读取出字符串，再转换为 XML 文档对象结构模型。之后，再从 XML 文档对象结构模型中读取指定节点的字符串，最后再将这个字符串转换成指定类型的变量。这个过程非常复杂，其中将 XML 文件转换为文档对象结构模型的过程通常需要完成词法文法分析等大量消耗 CPU 的复杂计算。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E反观 Protobuf，它只需要简单地将一个二进制序列，按照指定的格式读取到 C++ 对应的结构类型中就可以了。从上一节的描述可以看到消息的 decoding 过程也可以通过几个位移操作组成的表达式计算即可完成。速度非常快。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E为了说明这并不是我拍脑袋随意想出来的说法，下面让我们简单分析一下 Protobuf 解包的代码流程吧。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E以代码清单 3 中的 Reader 为例，该程序首先调用 msg1 的 ParseFromIstream 方法，这个方法解析从文件读入的二进制数据流，并将解析出来的数据赋予 helloworld 类的相应数据成员。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E\u003Cb\u003E该过程可以用下图表示，图 9. 解包流程图：\u003C\u002Fb\u003E\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E\u003C\u002Fp\u003E\u003Cp class=\"ztext-empty-paragraph\"\u003E\u003Cbr\u002F\u003E\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-a1982faff71f30f973fbfc5bbce1abed_b.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"415\" data-rawheight=\"286\" class=\"content_image\" width=\"415\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;415&#39; height=&#39;286&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"415\" data-rawheight=\"286\" class=\"content_image lazy\" width=\"415\" data-actualsrc=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-a1982faff71f30f973fbfc5bbce1abed_b.jpg\" data-original-token=\"v2-e7d0e233dc08651e5d2ec95709908271\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp class=\"ztext-empty-paragraph\"\u003E\u003Cbr\u002F\u003E\u003C\u002Fp\u003E\u003Cp data-pid=\"_Uga1Pdy\"\u003E\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E整个解析过程需要 Protobuf 本身的框架代码和由 Protobuf 编译器生成的代码共同完成。Protobuf 提供了基类 Message 以及 Message_lite 作为通用的 Framework，CodedInputStream 类，WireFormatLite 类等提供了对二进制数据的 decode 功能。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E从 5.1 节的分析来看，Protobuf 的解码可以通过几个简单的数学运算完成，无需复杂的词法语法分析，因此 ReadTag() 等方法都非常快。 在这个调用路径上的其他类和方法都非常简单，感兴趣的读者可以自行阅读。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E相对于 XML 的解析过程，以上的流程图实在是非常简单吧？这也就是 Protobuf 效率高的第二个原因了。\u003Cbr\u002F\u003E\u003C\u002Fp\u003E\u003Ch2\u003E5、结束语\u003C\u002Fh2\u003E\u003Cp data-pid=\"zXVmsjdc\"\u003E\u003Cbr\u002F\u003E往往了解越多，人们就会越觉得自己无知。我惶恐地发现自己竟然写了一篇关于序列化的文章，文中必然有许多想当然而自以为是的东西，还希望各位能够去伪存真，更希望真的高手能不吝赐教，给我来信。谢谢。\u003C\u002Fp\u003E\u003Ch2\u003E顺便推荐一个关于Protobuf协议详解的视频给大家\u003C\u002Fh2\u003E\u003Ch2\u003E点击Protobuf协议详细介绍就可以观看了！\u003C\u002Fh2\u003E\u003Cul\u003E\u003Cli data-pid=\"umY6A5qw\"\u003E\u003Cb\u003E另外还有一些关于c++ Linux后台服务器开发的一些知识点分享：Linux，Nginx，MySQL，Redis，P2P，K8S，Docker，TCP\u002FIP，协程，DPDK，webrtc，音视频等等视频。\u003C\u002Fb\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-2b84309a753e911898ffadc79827e0b5_b.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1221\" data-rawheight=\"223\" class=\"origin_image zh-lightbox-thumb\" width=\"1221\" data-original=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-2b84309a753e911898ffadc79827e0b5_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;1221&#39; height=&#39;223&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1221\" data-rawheight=\"223\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1221\" data-original=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-2b84309a753e911898ffadc79827e0b5_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-2b84309a753e911898ffadc79827e0b5_b.jpg\" data-original-token=\"v2-42d6b36c0a4a233991e86dcbf70b0bd1\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp class=\"ztext-empty-paragraph\"\u003E\u003Cbr\u002F\u003E\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-0ea30692bfc80822a4fdf55ef06484ed_b.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"640\" data-rawheight=\"353\" class=\"origin_image zh-lightbox-thumb\" width=\"640\" data-original=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-0ea30692bfc80822a4fdf55ef06484ed_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;640&#39; height=&#39;353&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"640\" data-rawheight=\"353\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"640\" data-original=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-0ea30692bfc80822a4fdf55ef06484ed_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-0ea30692bfc80822a4fdf55ef06484ed_b.jpg\" data-original-token=\"v2-b51b4b7ea0afa25d9ee6011b92b8a9b1\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Ch2\u003E喜欢的朋友可以+群832218493获取学习视频\u003C\u002Fh2\u003E\u003Cp data-pid=\"7GBrZEfC\"\u003E\u003Cb\u003E附上一份音视频学习课程大纲给大家\u003C\u002Fb\u003E\u003C\u002Fp\u003E\u003Cp class=\"ztext-empty-paragraph\"\u003E\u003Cbr\u002F\u003E\u003C\u002Fp\u003E\u003Cp class=\"ztext-empty-paragraph\"\u003E\u003Cbr\u002F\u003E\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-e120b4e3a5fd6049eefe4afd62b95879_b.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"480\" data-rawheight=\"1510\" class=\"origin_image zh-lightbox-thumb\" width=\"480\" data-original=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-e120b4e3a5fd6049eefe4afd62b95879_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;480&#39; height=&#39;1510&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"480\" data-rawheight=\"1510\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"480\" data-original=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-e120b4e3a5fd6049eefe4afd62b95879_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic2.zhimg.com\u002Fv2-e120b4e3a5fd6049eefe4afd62b95879_b.jpg\" data-original-token=\"v2-b738b1d4466eedb5fc5cc3c1d98c4f51\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003C\u002Fp\u003E","adminClosedComment":false,"topics":[{"url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Ftopics\u002F19831091","type":"topic","id":"19831091","name":"通信协议"},{"url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Ftopics\u002F19564722","type":"topic","id":"19564722","name":"protobuf"},{"url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Ftopics\u002F19560870","type":"topic","id":"19560870","name":"通信"}],"voteupCount":254,"voting":0,"heavyUpStatus":"allow_heavy_up","column":{"description":"","canManage":false,"intro":"专栏所有文章资料可以加群：832218493领取","isFollowing":false,"urlToken":"c_1226612089185660928","id":"c_1226612089185660928","articlesCount":638,"acceptSubmission":true,"title":"Linux、音视频","url":"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fc_1226612089185660928","commentPermission":"all","created":1585227111,"updated":1626681567,"imageUrl":"https:\u002F\u002Fpicx.zhimg.com\u002F4b70deef7_720w.jpg?source=172ae18b","author":{"isFollowed":false,"avatarUrlTemplate":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-e4dcbd4260da75dae5317ee45732f3ae.jpg?source=172ae18b","uid":"789766915831758848","userType":"people","isFollowing":false,"urlToken":"da-yu-er-2-87","id":"b3aa0b779f66d08c2f4be961e807a695","description":"","name":"CPP加油站","isAdvertiser":false,"headline":"","gender":-1,"url":"\u002Fpeople\u002Fb3aa0b779f66d08c2f4be961e807a695","avatarUrl":"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-e4dcbd4260da75dae5317ee45732f3ae_l.jpg?source=172ae18b","isOrg":false,"type":"people"},"followers":78,"type":"column"},"commentCount":13,"contributions":[{"id":23994629,"state":"accepted","type":"first_publish","column":{"description":"","canManage":false,"intro":"专栏所有文章资料可以加群：832218493领取","isFollowing":false,"urlToken":"c_1226612089185660928","id":"c_1226612089185660928","articlesCount":638,"acceptSubmission":true,"title":"Linux、音视频","url":"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fc_1226612089185660928","commentPermission":"all","created":1585227111,"updated":1626681567,"imageUrl":"https:\u002F\u002Fpicx.zhimg.com\u002F4b70deef7_720w.jpg?source=172ae18b","author":{"isFollowed":false,"avatarUrlTemplate":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-e4dcbd4260da75dae5317ee45732f3ae.jpg?source=172ae18b","uid":"789766915831758848","userType":"people","isFollowing":false,"urlToken":"da-yu-er-2-87","id":"b3aa0b779f66d08c2f4be961e807a695","description":"","name":"CPP加油站","isAdvertiser":false,"headline":"","gender":-1,"url":"\u002Fpeople\u002Fb3aa0b779f66d08c2f4be961e807a695","avatarUrl":"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-e4dcbd4260da75dae5317ee45732f3ae_l.jpg?source=172ae18b","isOrg":false,"type":"people"},"followers":78,"type":"column"}}],"isTitleImageFullScreen":false,"upvotedFollowees":[],"commercialInfo":{"isCommercial":false,"plugin":{}},"suggestEdit":{"status":false,"reason":"","tip":"","url":"","title":""},"reason":"","annotationAction":[],"canTip":false,"tipjarorsCount":0,"isLabeled":false,"hasPublishingDraft":false,"isFavorited":false,"favlistsCount":504,"isNormal":true,"status":0,"shareText":" Protobuf通信协议详解：代码演示、详细原理介绍等 - 来自知乎专栏「Linux、音视频」，作者: CPP加油站 https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F141415216 （想看更多？下载 @知乎 App：http:\u002F\u002Fweibo.com\u002Fp\u002F100404711598 ）","canComment":{"status":true,"reason":""},"mcnFpShow":-1,"isVisible":true,"isLiked":false,"likedCount":53,"hasColumn":true,"republishers":[],"isNewLinkCard":true,"emojiReaction":{"cryFaceCount":0,"cryFaceHasSet":false,"hugCount":0,"hugHasSet":false,"likeCount":53,"likeHasSet":false,"onlookerCount":0,"onlookerHasSet":false},"abParam":{"qaHiddenVoteup":"1"},"attachedInfo":"kgIkCgkxMTk1NTcxODESCTE0MTQxNTIxNhgHIgpJTUFHRV9URVhU","shareGuide":{"hasPositiveBubble":false,"hasTimeBubble":false,"hitShareGuideCluster":false},"settings":{"tableOfContents":{"enabled":false}},"canReference":false,"reactionInstruction":{}}},"columns":{"c_1226612089185660928":{"description":"","canManage":false,"intro":"专栏所有文章资料可以加群：832218493领取","isFollowing":false,"urlToken":"c_1226612089185660928","id":"c_1226612089185660928","articlesCount":638,"acceptSubmission":true,"title":"Linux、音视频","url":"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fc_1226612089185660928","commentPermission":"all","created":1585227111,"updated":1626681567,"imageUrl":"https:\u002F\u002Fpicx.zhimg.com\u002F4b70deef7_720w.jpg?source=172ae18b","author":{"isFollowed":false,"avatarUrlTemplate":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-e4dcbd4260da75dae5317ee45732f3ae.jpg?source=172ae18b","uid":"789766915831758848","userType":"people","isFollowing":false,"urlToken":"da-yu-er-2-87","id":"b3aa0b779f66d08c2f4be961e807a695","description":"","name":"CPP加油站","isAdvertiser":false,"headline":"","gender":-1,"url":"\u002Fpeople\u002Fb3aa0b779f66d08c2f4be961e807a695","avatarUrl":"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-e4dcbd4260da75dae5317ee45732f3ae_l.jpg?source=172ae18b","isOrg":false,"type":"people"},"followers":78,"type":"column"}},"topics":{},"roundtables":{},"favlists":{},"comments":{},"notifications":{},"ebooks":{},"activities":{},"feeds":{},"pins":{},"promotions":{},"drafts":{},"chats":{},"posts":{},"zvideos":{},"zvideoContributions":{},"briefs":{},"eduCourses":{}},"currentUser":"c29982ea4958b35f1d733b99ef5bf579","account":{"lockLevel":{},"unlockTicketStatus":false,"unlockTicket":null,"challenge":[],"errorStatus":false,"message":"","isFetching":false,"accountInfo":{},"urlToken":{"loading":false},"cardUserInfo":{"vipInfo":{}},"handleWidget":{},"widgetList":[],"userWidgetId":""},"settings":{"socialBind":null,"inboxMsg":null,"notification":{},"email":{},"privacyFlag":null,"blockedUsers":{"isFetching":false,"paging":{"pageNo":1,"pageSize":6},"data":[]},"blockedFollowees":{"isFetching":false,"paging":{"pageNo":1,"pageSize":6},"data":[]},"ignoredTopics":{"isFetching":false,"paging":{"pageNo":1,"pageSize":6},"data":[]},"restrictedTopics":null,"laboratory":{}},"notification":{},"people":{"profileStatus":{},"activitiesByUser":{},"answersByUser":{},"answersSortByVotesByUser":{},"answersIncludedByUser":{},"votedAnswersByUser":{},"thankedAnswersByUser":{},"voteAnswersByUser":{},"thankAnswersByUser":{},"topicAnswersByUser":{},"zvideosByUser":{},"articlesByUser":{},"articlesSortByVotesByUser":{},"articlesIncludedByUser":{},"pinsByUser":{},"questionsByUser":{},"commercialQuestionsByUser":{},"favlistsByUser":{},"followingByUser":{},"followersByUser":{},"mutualsByUser":{},"followingColumnsByUser":{},"followingQuestionsByUser":{},"followingFavlistsByUser":{},"followingTopicsByUser":{},"publicationsByUser":{},"columnsByUser":{},"allFavlistsByUser":{},"brands":null,"creationsByUser":{},"creationsSortByVotesByUser":{},"creationsFeed":{},"infinity":{},"batchUsers":{},"profileInfinity":null},"env":{"ab":{"config":{"params":[],"experiments":[],"chains":[],"encodedParams":"CjwbAD8ARwC0AGkBagF0ATsCzALXAtgCtwPWBFEFiwWMBZ4FMQbrBicHdAh5CPQJawq+CnELhwvlC+YL+AwSHgAAAAABAQAAAAAAAAQBAAABAQAAAAYDAAAAAAAAAA=="},"triggers":{}},"abV2":{"config":{"paramMap":{"ws_rec":{"value":"0"},"pm_new_task":{"value":"0"},"in_editor_title":{"value":"1","abId":"rl-pineditor_title-1"},"ws_invite":{"value":"0"},"ws_pc_route":{"value":"0"}},"abMap":{"rl-pineditor_title-1":{"abId":"rl-pineditor_title-1","layerId":"rl-pineditor_title","diversionType":2}}},"triggers":{}},"userAgent":{"Edge":false,"IE":false,"Wechat":false,"Weibo":false,"QQ":false,"MQQBrowser":false,"Qzone":false,"Mobile":false,"Android":false,"iOS":false,"isAppleDevice":false,"Zhihu":false,"ZhihuHybrid":false,"isBot":false,"Tablet":false,"UC":false,"Quark":false,"Sogou":false,"Qihoo":false,"Baidu":false,"BaiduApp":false,"Safari":false,"GoogleBot":false,"AndroidDaily":false,"iOSDaily":false,"WxMiniProgram":false,"BaiduMiniProgram":false,"QQMiniProgram":false,"JDMiniProgram":false,"isWebView":false,"isMiniProgram":false,"origin":"Mozilla\u002F5.0 (X11; Linux x86_64) AppleWebKit\u002F537.36 (KHTML, like Gecko) Chrome\u002F103.0.0.0 Safari\u002F537.36"},"appViewConfig":{},"ctx":{"path":"\u002Fp\u002F141415216","query":{},"href":"http:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F141415216","host":"zhuanlan.zhihu.com"},"trafficSource":"production","edition":{"beijing":true,"baidu":false,"sogou":false,"baiduBeijing":false,"sogouBeijing":false,"sogouInput":false,"oppoSearch":false,"baiduSearch":false,"googleSearch":false,"shenma":false,"miniProgram":false,"xiaomi":false},"theme":"light","appHeaderTheme":{"current":"normal","disable":true,"normal":{"bgColor":"GBK99A"},"custom":{"bgColor":"GBK99A"}},"enableShortcut":true,"referer":"https:\u002F\u002Fwww2.bing.com\u002F","xUDId":"AIAe75fvzhSPTpeNw8WYbUTCwgHWLCTfJt8=","mode":"ssr","conf":{},"xTrafficFreeOrigin":"","ipInfo":{"cityName":"北京","countryName":"中国","regionName":"北京","countryCode":"CN"},"logged":true,"vars":{"passThroughHeaders":{}}},"me":{"columnContributions":[]},"label":{"recognizerLists":{}},"ecommerce":{},"comments":{"pagination":{},"collapsed":{},"reverse":{},"reviewing":{},"conversation":{},"parent":{}},"commentsV2":{"stickers":[],"commentWithPicPermission":{},"notificationsComments":{},"pagination":{},"collapsed":{},"reverse":{},"reviewing":{},"conversation":{},"conversationMore":{},"parent":{}},"pushNotifications":{"default":{"isFetching":false,"isDrained":false,"ids":[]},"follow":{"isFetching":false,"isDrained":false,"ids":[]},"vote_thank":{"isFetching":false,"isDrained":false,"ids":[]},"currentTab":"default","notificationsCount":{"default":0,"follow":0,"vote_thank":0}},"messages":{"data":{},"currentTab":"common","messageCount":0},"register":{"registerValidateSucceeded":null,"registerValidateErrors":{},"registerConfirmError":null,"sendDigitsError":null,"registerConfirmSucceeded":null},"login":{"loginUnregisteredError":false,"loginBindWechatError":false,"loginConfirmError":null,"sendDigitsError":null,"needSMSIdentify":false,"validateDigitsError":false,"loginConfirmSucceeded":null,"qrcodeLoginToken":"","qrcodeLoginScanStatus":0,"qrcodeLoginError":null,"qrcodeLoginReturnNewToken":false},"switches":{},"captcha":{"captchaNeeded":false,"captchaValidated":false},"sms":{"supportedCountries":[]},"chat":{"chats":{},"inbox":{"recents":{"isFetching":false,"isDrained":false,"isPrevDrained":false,"result":[],"next":null,"key":null},"strangers":{"isFetching":false,"isDrained":false,"isPrevDrained":false,"result":[],"next":null,"key":null},"friends":{"isFetching":false,"isDrained":false,"isPrevDrained":false,"result":[],"next":null,"key":null},"search":{"isFetching":false,"isDrained":false,"isPrevDrained":false,"result":[],"next":null,"key":null},"config":{"newCount":0,"strangerMessageSwitch":false,"strangerMessageUnread":false,"friendCount":0}},"global":{"isChatMqttExisted":false}},"emoticons":{"emoticonGroupList":[],"emoticonGroupDetail":{}},"creator":{"tools":{"question":{"invitationCount":{"questionFolloweeCount":0,"questionTotalCount":0}},"customPromotion":{"itemLists":{}},"recommend":{"recommendTimes":{}}},"explore":{},"rightsStatus":{},"levelUpperLimit":10,"mcn":{},"videoSupport":{},"textBenefit":{},"mcnManage":{},"tasks":{},"recentlyCreated":[],"announcement":{},"bannerList":[],"creatorsRecommendInfo":{}},"creators":{"bayesDomains":{"status":{},"options":{"topDomains":null,"allDomains":null,"editable":0},"contents":null},"school":{"tabs":[],"contents":[],"banner":null,"entities":{}},"faq":{"tabs":[],"article":{}},"knowledgeIncome":{},"safeguardRights":{},"analytics":{"all":{},"answer":{},"zvideo":{},"article":{},"pin":{},"singleContent":{}},"account":{"growthLevel":{}},"KMResource":{},"training":{},"ToolsQuestion":{"goodatTopics":[]},"ToolsHotspot":{"domains":[]},"ToolsSearchQuestion":{},"editorSetting":{},"MCNManage":{},"knowledgeTasks":{},"incomeAnalysis":{"income":{"aggregation":{}}},"creationManage":{"editModal":{"status":false}},"activity":{},"announcement":{},"home":{"currentCreatorUrlToken":null,"rights":[],"newRights":[],"applyStatus":{},"scoreInfo":{},"menusShowControlByServer":{"bVipRecomend":false,"creationRelationship":false},"newTasks":{"creatorTask":{"tasks":[],"des":[]}}}},"answers":{"voters":{},"copyrightApplicants":{},"favlists":{},"newAnswer":{},"entityWords":{},"concernedUpvoters":{},"simpleConcernedUpvoters":{},"paidContent":{},"settings":{}},"recommendation":{"homeRecommendations":[]},"shareTexts":{},"articles":{"voters":{},"concernedUpvoters":{}},"previewPost":{},"favlists":{"relations":{}},"columns":{"voters":{}},"reward":{"answer":{},"article":{},"question":{}},"video":{"data":{},"shareVideoDetail":{},"last":{}},"topstory":{"recommend":{"isFetching":false,"isDrained":false,"afterId":0,"items":[],"next":null},"follow":{"isFetching":false,"isDrained":false,"afterId":0,"items":[],"next":null},"followWonderful":{"isFetching":false,"isDrained":false,"afterId":0,"items":[],"next":null},"sidebar":null,"announcement":{},"hotList":[],"guestFeeds":{"isFetching":false,"isDrained":false,"afterId":0,"items":[],"next":null},"followExtra":{"isNewUser":null,"isFetched":false,"followCount":0,"followers":[]},"hotDaily":{"data":[],"paging":{}},"hotHighlight":{"isFetching":false,"isDrained":false,"data":[],"paging":{}},"banner":{},"commercialBanner":{"show":false,"banner":{},"trackData":{}},"video":{"items":[],"next":null,"isLoading":false,"isDrained":false}},"readStatus":{},"column":{},"requestColumn":{"categories":[],"error":null},"articleContribution":{"contributeRequests":[],"deleteContributeIdList":[],"handledContributeIdList":[],"recommendedColumns":[],"pinnedColumns":[],"sentContributeRequestsIdList":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"c_1226612089185660928"]},"columnContribution":{"contributeRequests":[],"autoInviteEnabled":false,"recommendedContributors":[],"contributionInvitation":null},"draftHistory":{"history":{},"drafts":{}},"upload":{},"articleDraft":{"titleImage":"","titleImageSize":{},"isTitleImageFullScreen":false,"canTitleImageFullScreen":false,"title":"","titleImageUploading":false,"error":"","content":"","draftLoading":false,"updating":false,"globalLoading":false,"pendingVideo":{"resource":null,"error":null},"deleteFail":{"fail":false},"recommendTopics":[],"selectedColumn":0,"articleDisclaimers":[]},"articleDrafts":{"isDrained":false,"isLoading":false,"items":[]},"columnAutocomplete":{"users":[],"friends":[]},"columnCollection":{},"userProfit":{"permission":{"permissionStatus":{"zhiZixuan":0,"recommend":-1,"task":0,"plugin":0,"infinity":0},"visible":false}},"mcn":{"bindInfo":{},"memberCategoryList":[],"producerList":[],"categoryList":[],"lists":{},"banners":{},"protocolStatus":{"isAgreedNew":true,"isAgreedOld":true},"probationCountdownDays":0},"zvideos":{"campaignVideoList":{},"campaigns":{},"tagoreCategory":[],"recommendations":{},"insertable":{},"recruit":{"form":{"platform":"","nickname":"","followerCount":"","domain":"","contact":""},"submited":false,"ranking":[]},"qyActivityData":{},"talkActivityData":{},"party2022ActivityData":{},"batchVideos":{},"contribution":{"selectedContribution":null,"campaign":null,"configs":{},"contributionLists":{},"recommendQuestions":{"isLoading":true,"paging":{"isEnd":false,"isStart":true,"totals":0},"data":[]},"questionSearchResults":{"isLoading":true,"paging":{"isEnd":false,"isStart":true,"totals":0},"data":[]}},"creationReferences":{},"zvideoCollection":{},"zvideoGrant":{},"collectData":{"isFetching":false,"list":[]},"videoSource":{"isLoaded":false}},"republish":{},"commentPermission":{},"creatorRightStatus":{"list":[]},"adPromotion":{"answer":{},"article":{}}},"fetchHost":"www.zhihu.com","subAppName":"column","spanName":"Post","canaryConfig":{"test_canary":"0","use_new_player":"1","player_vendor":"1","use_hevc":"1","upload_use_signature":"1","use_backdrop_blur":"0","article_title_imagex":"0"}}</script><script crossorigin="" src="./Protobuf通信协议详解：代码演示、详细原理介绍等 - 知乎_files/vendor.8551e0b87fc43b2e5529.js"></script><script crossorigin="" src="./Protobuf通信协议详解：代码演示、详细原理介绍等 - 知乎_files/react.production.min.js"></script><script crossorigin="" src="./Protobuf通信协议详解：代码演示、详细原理介绍等 - 知乎_files/react-dom.production.min.js"></script><script crossorigin="" src="./Protobuf通信协议详解：代码演示、详细原理介绍等 - 知乎_files/react-dom-server.browser.production.min.js"></script><script crossorigin="" src="./Protobuf通信协议详解：代码演示、详细原理介绍等 - 知乎_files/runtime.app.7c5038017dcf17d5f66e.js"></script><script crossorigin="" src="./Protobuf通信协议详解：代码演示、详细原理介绍等 - 知乎_files/lib-2ec050f6.app.d775035239add1474147.js"></script><script crossorigin="" src="./Protobuf通信协议详解：代码演示、详细原理介绍等 - 知乎_files/lib-29107295.app.a5891096834538104d7e.js"></script><script crossorigin="" src="./Protobuf通信协议详解：代码演示、详细原理介绍等 - 知乎_files/lib-79b5cf47.app.7ec9842ac1b68669fb3a.js"></script><script crossorigin="" src="./Protobuf通信协议详解：代码演示、详细原理介绍等 - 知乎_files/lib-330004dc.app.0392aba96165d5f92d6c.js"></script><script crossorigin="" src="./Protobuf通信协议详解：代码演示、详细原理介绍等 - 知乎_files/lib-0e5ce61e.app.6d8a39a9f40142a4724c.js"></script><script crossorigin="" src="./Protobuf通信协议详解：代码演示、详细原理介绍等 - 知乎_files/5459.app.9d5586c01c265c2677c2.js"></script><script crossorigin="" src="./Protobuf通信协议详解：代码演示、详细原理介绍等 - 知乎_files/column.app.53d9a84092165f45bf26.js"></script><script defer="" src="./Protobuf通信协议详解：代码演示、详细原理介绍等 - 知乎_files/aria.js" id="ariascripts" wapforceoldfixed="false" loaddata="false"></script><script src="./Protobuf通信协议详解：代码演示、详细原理介绍等 - 知乎_files/hm.js" async=""></script><script crossorigin="" src="./Protobuf通信协议详解：代码演示、详细原理介绍等 - 知乎_files/zap.js"></script><div><div style="display: none;"><i>想来知乎工作？请发送邮件到 jobs@zhihu.com</i></div></div><script src="./Protobuf通信协议详解：代码演示、详细原理介绍等 - 知乎_files/push.js"></script><div><div><div class="css-8pdeid"></div></div></div><script crossorigin="" src="./Protobuf通信协议详解：代码演示、详细原理介绍等 - 知乎_files/emoticon.js"></script><div><div><div class="Editable-languageSuggestions" style="left: -1179px; top: -999px;"><div><div class="Popover"><label class="Editable-languageSuggestionsInput Input-wrapper"><input autocomplete="off" role="combobox" aria-expanded="false" aria-autocomplete="list" aria-activedescendant="AutoComplete7-0" id="Popover6-toggle" aria-haspopup="true" aria-owns="Popover6-content" class="Input" placeholder="选择语言" value=""><svg width="24" height="24" viewBox="0 0 24 24" fill="#afbdcf" class="Zi Zi--Select"><path fill-rule="evenodd" d="M12.53 3.47a.75.75 0 0 0-1.06 0l-5 5a.75.75 0 0 0 1.06 1.06L12 5.06l4.47 4.47a.75.75 0 1 0 1.06-1.06l-5-5Zm-5 11a.75.75 0 0 0-1.06 1.06l5 5a.75.75 0 0 0 1.06 0l5-5a.75.75 0 1 0-1.06-1.06L12 18.94l-4.47-4.47Z" clip-rule="evenodd"></path></svg></label></div></div></div></div></div></body></html>